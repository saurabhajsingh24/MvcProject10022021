@model KeystoneProject.Models.Laboratory.PatientLabBills

@{
    ViewBag.Title = "Patient";
    Layout = "~/Views/Shared/_Layout.cshtml";

}


@*<!DOCTYPE html>
    <html>
    <head>*@
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<script>
    $(document).ready(function () {
        $('#maintable').DataTable({
            type: 'post',
            dom: 'Bfrtip',
            buttons: [
                'copyHtml5',
                'excelHtml5',
                'csvHtml5',
                'pdfHtml5'
            ]
        });
    });
</script>

<style>
    @@media only screen and (max-width: 425px) {
        .cpb-10 {
            padding-bottom: 10px;
        }
    }

    .input-group-addon {
        padding: 0px 5px;
    }
</style>

<script>
    $(document).ready(function () {
        $('#example').DataTable({
            type: 'post',
            dom: 'Bfrtip',
            buttons: [
                'copyHtml5',
                'excelHtml5',
                'csvHtml5',
                'pdfHtml5'
            ]
        });
    });
</script>
<script>

    $(document).ready(function () {

        //$("#DateOfBirth").datepicker();
        var d = "";

        var date = new Date();

        $("#age_day").keyup(function () {
            debugger

           // var date = new Date(fromDate).toDateString('yyyy-MM-dd');
           //// $("#DateOfBirth").val(date.);
           // document.getElementById("DateOfBirth").value = fromDate.toString("yyyy-MM-dd");
            d = "";
            debugger;
            var days = parseInt($("#age_day").val(), 10);

            var month = parseInt($("#Month").val(), 10);

            var year = parseInt($("#Year").val(), 10);

            var date = new Date();
            if (days == "NaN")
            {
                days = 0;
            }
              if (days > 0) {
              var dat=    date.setDate(date.getDate() - parseInt(days));
              }
                if (year > 0) {
                    var b = date.setFullYear(date.getFullYear() - year);
                }
                if (month > 0) {
                  var m=  date.setMonth(date.getMonth() - month);
                }

                 d = date.getFullYear() + '-' + (date.getMonth()+1) + '-' + date.getDate();


                $.ajax({
                    url: '@Url.Action("BindCaculteAge", "OPDBill")',
                    type: "GET",
                    data: { date: d },
                    dataType: "json",
                    success: function (data) {
                        $("#DateOFBirth").val(data);
                    }
                })


              //  $("#DateOfBirth").val(date.toLocaleDateString("indian"));
                debugger

                year = "";


            if ($("#Year").val() == "" && $("#Month").val() == "" && $("#age_day").val() == "") {

                $("#DateOFBirth").val(date.toString("yyyy-MM-dd"));

            }
        })

        $("#Month").keyup(function () {
            debugger;

            // $.get("/Add_Patient_Registration/Day", { name: month, Birth: "Month" }, function (data) {

            debugger;
            d = "";

            var days = parseInt($("#age_day").val(), 10);

            var month = parseInt($("#Month").val(), 10);

            var year = parseInt($("#Year").val(), 10);

            var date = new Date();
            if (month > 0) {
                date.setMonth(date.getMonth() - month);
            }
                if (year > 0) {
                    var b = date.setFullYear(date.getFullYear() - year);
                }
                if (days > 0) {
                    date.setDate(date.getDate() - days);
                }

                 d = date.getFullYear() + '-' + (date.getMonth()+1) + '-' + date.getDate();

                $.ajax({
                    url: '@Url.Action("BindCaculteAge", "OPDBill")',
                    type: "GET",
                    data: { date: d},
                    dataType: "json",
                    success: function (data) {
                        $("#DateOFBirth").val(data);
                    }
                })


                year = "";


            if ($("#Year").val() == "" && $("#Month").val() == "" && $("#age_day").val() == "") {

                $("#DateOFBirth").val(date.toString('dd M yy'));
            }

        })



        $("#Year").keyup(function () {
            debugger;
            d = "";
            date = new Date();
            var days = parseInt($("#age_day").val(), 10);

            var month = parseInt($("#Month").val(), 10);

            var year = parseInt($("#Year").val(), 10);

              var date = new Date();
              if (year > 0) {
                  var b = date.setFullYear(date.getFullYear() - year);
              }
                if (month > 0) {
                    date.setMonth(date.getMonth() - month);
                }
                if (days > 0) {
                    date.setDate(date.getDate() - days);
                }
                 d = date.getFullYear() + '-' + (date.getMonth()+1) + '-' + date.getDate();

                $.ajax({
                    url: '@Url.Action("BindCaculteAge", "OPDBill")',
                    type: "GET",
                    data: { date: d },
                    dataType: "json",
                    success: function (data) {

                        $("#DateOFBirth").val(data);
                    }
                })


                year = "";



            if ($("#Year").val() == "" && $("#Month").val() == "" && $("#age_day").val() == "") {

                $("#DateOFBirth").val(date.toString('dd M yy'));

            }
        })


        $("#DateOFBirth").change(function () {
    debugger
    var birth = $("#DateOFBirth").val();
         var date = new Date(birth);
         var d = date.getFullYear() + '-' + (date.getMonth() + 1) + '-' + date.getDate();

        })

    });



</script>
<script>

    $(document).ready(function () {
        debugger

        $.ajax({
            //url: "/PatientOPDBill/GetAllFinancialYear",
            url: '@Url.Action("GetAllFinancialYear", "PatientLabBills")',
            type: "GET",
            data: {},
            dataType: "json",
            success: function (data) {
                debugger;
                $(data).each(function (index, d) {
                    $("#FinancialYear").append($("<option value=" + d.FinancialYear + ">" + d.FinancialYear + "</option>"));
                    $("#FinancialYearID").val(data[0].FinancialYearID);
                });
            },
            error: function (data) {
            }
        });
    });
    </script>
<script>
    $(document).ready(function(){

   
    $.ajax({
        url: '@Url.Action("NXtRegNO", "PatientLabBills")',
        contentType: "application/json; charset=utf-8",
        type: "POST",
        datatype: "Json",
       
        success: function (searchList) {
            debugger;
            
            $("#PatientRegNo").val(searchList);

       

        },
    })
    })
    </script>
<script>
   
     
        $(document).ready(function () {
            //var outside_patient = "";
            debugger
            $("#btndelete").click(function () {
                debugger
                var conform = confirm("Do you Want To Delete");
                //     var BillNo = $("#patient_reg_no_txt_id").val();
                if (conform) {
                    $.ajax({
                        url: '@Url.Action("DeletePatientBills", "PatientLabBills")',
                        type: 'POST',
                        datatype: "Json",
                        data: { PatientRegNO: $("#PatientRegNo").val(), BillNo: $("#OldBillNo").val() },
                        success: function (data) {
                            if (data.length > 1) {
                                alert("Delete Successfully");
                                debugger
                                // changePatientbind();
                                // Restore();
                                $("#example td").remove();
                            }
                        }
                    })


                }
            });


            $("#PatientName,#OPDIPDNo").keyup(function (e) {
                debugger
                if($(this).val()=="")
                {
                    $(".suggestions").addClass("hidden");
                   
                    //row_num--;
                    //document.getElementById("tblpatient").rows[row_num].style.backgroundColor = "#35a4f1";
                }
            })
            $("#OPDIPDNoprint").autocomplete({
               
                source: function (request, response) {

                    $.ajax({
                        url: '@Url.Action("GetPatientLabOPDIPDNo", "PatientLabBills")',
                        type: "POST",
                        datatype: "Json",
                        data: { OPDIPDID: request.term },
                        success: function (data) {
                            debugger
                            $(".suggestions").removeClass("hidden");
                            $(".tblpatientbody  tr").remove();
                            // $("thead", grid).empty();
                            $.each(data,
                                   function (key, value) {
                                       var row =
                                           "<td>" + value.PatientName + "</td>" +
                                           "<td>" + value.PrintRegNO + "</td>" +
                                             "<td>" + value.PatientType + "<input type='hidden' name='PrintRegNO'  value='" + value.PrintRegNO + "'> <input type='hidden' name='OPDIPDID'  value='" + value.OPDIPDID + "'> <input type='hidden'  value='" + value.PatientType + "'> </td>";
                                       $("#tblpatient").append($("<tr></tr>").html(row));

                                   })



                        },

                    });
                },
            })
            

        
         //   $(".suggestions").addClass("scroll");  
            $(".suggestions").addClass("hidden"); 
            //overflow-x: scroll;
            //overflow-y: scroll;
            //height: 300px;
            $("#PatientName").autocomplete({

                source: function (request, response) {
                
                    $.ajax({
                        url: '@Url.Action("GetPatientName", "PatientLabBills")',
                        type: "POST",
                        datatype: "Json",
                        data: { prefix: request.term },
                        success: function (data) {
                        
                            //response($.map(data, function (item) { yashoda
                            //    return { label: item.PatientName, value: item.PatientName, id: item.PatientRegNo };
                            //}));
                        //$("#tblpatient tr").remove();
                            div = document.getElementById("tblbind");
                            div.appendChild(x);
                            clicktbl = 0;
                            $("#tblbind").css({"overflow-x": "scroll" ,"overflow-y" :"scroll","height":"300px"});

                            $("#col th").remove();
                            $("#col").append('<th>Patient Name</th><th>Reg No</th>');
                            var grid = $(".suggest-grid");
                            $(".suggestions").removeClass("hidden");
                            $("tbody", grid).empty();
                           // $("thead", grid).empty();
                            $.each(data,
                                   function (key, value) {
                                       var row =
                                           "<td>" + value.PatientName + "</td>" +
                                           "<td>" + value.PatientRegNo + "</td>";

                                       $("#tblpatient").append($("<tr></tr>").html(row));
                                   
                                   })
                        },

                    });
                },
            })
          
            var row_num = 1;
            $("#tblpatient").delegate('td', 'click', function () {
                debugger
                row_num = parseInt($(this).parent().index());
              var opdipdprint=  $("#OPDIPDNoprint").val();
                var PatientName = document.getElementById("tblpatient").tBodies[0].rows[row_num].cells[0].innerHTML;
                var PatientRegNo = document.getElementById("tblpatient").tBodies[0].rows[row_num].cells[1].innerHTML;
                var PatientType = document.getElementById("tblpatient").tBodies[0].rows[row_num].cells[2].children[2].value;
                var PatientOPDIPD = document.getElementById("tblpatient").tBodies[0].rows[row_num].cells[2].children[1].value;
              //  var PatientOPDIPDprint = document.getElementById("tblpatient").tBodies[0].rows[row_num].cells[2].children[1].value;
                $("#PatientRegNoprint").val(PatientRegNo)
                $("#OPDIPDNo").val(PatientOPDIPD);
                $("#OPDIPDNoprint").val(opdipdprint);
               //$("#PatientRegNoprint").change();
                $("#PatientName").val(PatientName);
                $("#PatientRegNo").val(PatientRegNo);
               
             
                $(".suggestions").addClass("hidden");
              //  GetPatientForLabBillsOPDIPD
                debugger
                $.ajax({
                    url: '@Url.Action("GetPatientForLabBillsOPDIPD", "PatientLabBills")',
                    type: "POST",
                    datatype: "Json",
                    data: {PatientType: PatientType, OPDIPDNo: $("#OPDIPDNo").val() },
                    success: function (data) {
                        debugger
                        var s = data[0].ReferredByDoctorID;

                        $("#PatientRegNoprint").val(data[0].PrintRegNO)
                        $("#PFPatientName").val(data[0].PrefixName);
                        $("#OPDIPDNoprint").val(data[0].PrintOPDIPDNo);
                        $("#PatientName").val(data[0].PatientName);
                        $("#RefferedDoctor").val(data[0].ReffDoctorName);
                        $("#PFPatientName").val(data[0].PrefixName);
                        $("#ConsultantDoctor").val(data[0].DoctorPrintName);

                        $("#ConsultantDoctorID1").val(data[0].ConsultantDrID);
                        $("#RefferedDoctorID").val(data[0].ReferredByDoctorID);
                        $("#Year").val(data[0].Age);
                        $("#DateOFBirth").val(data[0].DateOfBirth);
                        $("#PatientRegNo").val(data[0].PatientRegNo);
                        $("#GuardianName").val(data[0].GuardianName);
                        // alert($("#PrivilegeCard").val());
                        if ($("#PrivilegeCard").val() == "on" && data[0].PrivilegeCard != null) {

                            $("#PrivilegeCard").hide();
                            $("#spanPrivilege").hide();
                            $("#PrivilegeCardName").show();
                            $("#PrivilegeCardName").val(data[0].PrivilegeCard);

                        }
                        else {
                            $("#PrivilegeCard").show();
                            $("#spanPrivilege").show();
                            $("#PrivilegeCardName").hide();

                        }
                        //if ($("#PrivilegeCard").val(data[0].PrivilegeCard))
                        //{
                        //    $("#PrivilegeCard").val(checked);
                        //}

                        // $("").val(data[0].DateOfBirth);
                        $("#PatientType").text(data[0].PatientType);
                        $("#PatientType1").val(data[0].PatientType);
                        $("#MobileNo").val(data[0].MobileNo);
                        $("#Address").val(data[0].Address);
                        $("#Gender").val(data[0].Gender);
                        //  alert(data[0].Gender);
                        $("#WardName").val(data[0].WardID);
                        $("#RoomNo").val(data[0].RoomID);
                        $("#BedNo").val(data[0].BedID);
                        $("#FinancialYearID").val(data[0].FinancialYearID);

                        // $("#FinancialYear").val(data[0].FinancialYear);
                        //alert(data[0].FinancialYear);
                        if ($("#PatientType1").val() == "IPD") {
                            $("#OPDIPDNo").val(data[0].PatientIPDNO);
                        }
                        else {
                            $("#OPDIPDNo").val(data[0].PatientOPDNO);
                        }

                        debugger

                        PreBalanceAmount = $("#PreBalance").val(data[0].PreBalanceAmount);
                        if (parseFloat(data[0].PreBalanceAmount) < 0) {
                            //alert("Deposit");

                            $("#priBalanceDeposit").text("Deposit")

                            $("#priBalanceDeposit").css("color", "blue");

                            var repalce1 = data[0].PreBalance;

                            var pre_balance = $("#PreBalance").val().replace("-", "");
                            $("#PreBalance").val(pre_balance)

                            $("#Deposit").val(repalce1);
                            // $("#pre_balance").attr('value', Deposit);
                        }
                        else {
                            $("#priBalanceDeposit").text("Pre.Balance");
                            $("#priBalanceDeposit").css("color", "black");
                            $("#Deposit").val("0.00")
                        }
                        $("#PatientNameID").val(data[0].PatientName);
                        //$("#OldBillNo").text('');
                    }
                });
                $.ajax({
                    url: '@Url.Action("OLDBILLBind", "PatientLabBills")',
                    type: "POST",
                    datatype: "Json",
                    data: { RegNo: $("#PatientRegNo").val() },
                    success: function (data) {
                        $("#OldBillNo option").remove();
                        $("#OldBillNo").append('<option value="--New--">--New--</option>');

                        for (var a = 0; a < data.length; a++) {
                            //  alert(data[0].OLDBill);
                            $("#OldBillNo").append('<option value=' + data[a].BillNo + '>' + data[a].OLDBill + '</option>');
                            $("#btndelete").prop('disabled', false);
                        }
                    }
                });
            })
        })
   
             </script>
      
        @*$("#OldBillNo").change(function () {
            debugger
            $.ajax({
                url: '@Url.Action("FillOldBillDetails", "PatientLabBills")',
                type: "POST",
                datatype: "Json",
                data: { BillNo: $("#OldBillNo").val() },
                success: function (data) {

                    $("#billno").val($("#OldBillNo").val());
                    $("#GrossTotal").val(data[0].GrossAmount);
                    // $("#service_tax").val(data[0]);
                    $("#TaxAmt").val(data[0].TaxAmount);
                    $("#PreBalance").val(data[0].PreBalanceAmount);

                    if ($("#PreBalance").val() == "") {
                        $("#PreBalance").val();
                    }
                    $("#DiscountAmount").val(data[0].Discount);

                    if ($("#DiscountAmount").val() == "") {
                        $("#DiscountAmount").val().toFixed(2);
                    }
                    debugger;
                    $("#BillDate").val(data[0].BillDate).toString("dd-MM-yyyy");
                    $("#Time").val(data[0].BillDatetime).toString("hh:mm:ss");
                    $("#Discount").val(data[0].DiscountPer);
                    $("#TotalAmt").val(data[0].TotalAmount);
                    $("#AmtPaid").val(data[0].PaidAmount);
                    $("#NetPay").val(data[0].NetAmountPayable);
                    $("#DiscReason").val(data[0].DiscountReason);
                    $("#BalAmt").val(data[0].BalanceAmount);

                    if (data[0].PaymentType != "Cash") {
                        $("#Number").val(data[0].Number);
                        $("#Name").val(data[0].Name);
                        $("#paymentDate").val(data[0].PaymentDate);
                       // alert(data[0].PaymentDate);
                        $("#Remarks").val(data[0].Remark);
                    }
                    debugger;
                    document.getElementById("PaymentType").value = data[0].PaymentType;
                    debugger;
                    switch (data[0].PaymentType) {

                        case 'Cheque':
                            $("#DoctorSaveDivs").show(300);
                            $("#PaymentNo1").text("Cheque No");


                            $("#paymentName1").text("Bank Name");

                            $("#paymentDate1").text("Cheque Date");

                            $("#paymentRemark1").text("Remark");


                            break;


                        case 'Debit Card':
                            $("#DoctorSaveDivs").show(300);
                            $("#PaymentNo1").text("Debit Card No");


                            $("#paymentName1").text("Holder Name");

                            $("#paymentDate1").text("Valid UPTO");

                            $("#paymentRemark1").text("Remark");
                            // document.getElementById("payment_type").selectedIndex = 3;
                            break;



                        case 'Credit Card':
                            $("#DoctorSaveDivs").show(300);
                            $("#PaymentNo1").text("Credit Card No");
                            $("#paymentName1").text("Holder Name");
                            $("#paymentDate1").text("Valid UPTO");
                            $("#paymentRemark1").text("Remark");
                            //  document.getElementById("payment_type").selectedIndex = 2;
                            break;

                        case 'E-Money':
                            $("#DoctorSaveDivs").show(300);
                            $("#PaymentNo1").text("Code");
                            $("#paymentName1").text("Bank Name");
                            $("#paymentDate1").text("Date");
                            $("#paymentRemark1").text("Remark");
                            // document.getElementById("payment_type").selectedIndex = 4;
                            break;

                        case 'EFT':
                            $("#DoctorSaveDivs").show(300);
                            $("#PaymentNo1").text("Code");
                            $("#paymentName1").text("Bank Name");
                            $("#paymentDate1").text("Date");
                            $("#paymentRemark1").text("Remark");
                            // document.getElementById("payment_type").selectedIndex = 5;
                            break;

                        case 'CASH':
                            document.getElementById("payment_type").selectedIndex = 0;
                            $("#DoctorSaveDivs").hide(300);
                            break;
                    }



                    debugger
                    //----------------------------hemaa
                    $("#example tbody tr").remove();
                    for (var a = 0; a < data.length; a++) {
                        debugger
                       // var TotalAmt = parseFloat(data[a].Qty) * parseFloat(data[a].Rate)
                        // alert(data[0].OLDBill);
                        if (data[a].samplecollection == "1") {
                            $("#example").append('<tr><td><input type="hidden" name="mode" value="Edit"><input type="hidden" id="samplecollection1" name="samplecollection1" value="' + data[a].samplecollection + '"><input type ="checkbox" id="samplecollection" name="samplecollection" checked="checked"></td><td><input type="hidden" value=' + data[a].TestID + ' name="TesttableID"><input type="hidden" value=' + data[a].TestName + ' name="TestNamerow">' + data[a].TestName + '</td><td><input type="text" class="form-control" name="rate1" value=' + data[a].Rate + ' ></td><td><input type="text" value=' + data[a].Qty + ' class="form-control" id="qty1" name="qty"></td><td><select name="DiscountServiceType" id="DiscountServiceType" class="nr form-control"><option value=' + data[a].DiscountServiceType + '>' + data[a].DiscountServiceType + '</option> <option value="Rs">Rs</option><option value="Rs">Rs</option><option value="%">%</option></select></td><td><input value="' + data[a].Discount_Service + '" class="nr form-control" type="number" id="Discount_Service" name="Discount_Service"><input value="0" type="hidden" id="sevicedisAmt" name="sevicedisAmt"></td><td class="total">' + data[a].ServiceTotal + '</td><td><a href="#" style="color:red" class="glyphicon glyphicon-remove" aria-hidden="true" id="delrow" class="delrow"></a></td></tr>');
                        }
                        else {
                            $("#example").append('<tr><td><input type="hidden" name="mode" value="Edit"><input type="hidden" id="samplecollection1" name="samplecollection1" value="' + data[a].samplecollection + '"><input type ="checkbox" id="samplecollection" name="samplecollection"></td><td><input type="hidden" value=' + data[a].TestID + ' name="TesttableID"><input type="hidden" value=' + data[a].TestName + ' name="TestNamerow">' + data[a].TestName + '</td><td><input type="text" class="form-control" name="rate1" value=' + data[a].Rate + ' ></td><td><input type="text" value=' + data[a].Qty + ' class="form-control" id="qty1" name="qty"></td><td><select name="DiscountServiceType" id="DiscountServiceType" class="nr form-control"><option value=' + data[a].DiscountServiceType + '>' + data[a].DiscountServiceType + '</option> <option value="Rs">Rs</option><option value="Rs">Rs</option><option value="%">%</option></select></td><td><input value="' + data[a].Discount_Service + '" class="nr form-control" type="number" id="Discount_Service" name="Discount_Service"><input value="0" type="hidden" id="sevicedisAmt" name="sevicedisAmt"></td><td class="total">' + data[a].ServiceTotal + '</td><td style="display:none">' + data[a].ServiceTotal + '</td><td><a href="#" style="color:red" class="glyphicon glyphicon-remove" aria-hidden="true" id="delrow" class="delrow"></a></td></tr>');

                        }
                    }
                    $("#example").on('click', '#delrow', function () {
                        debugger;
                        $(this).closest('tr').remove();
                        GrossAmt = 0;
                        var row = $("#example td").closest("tr").length;
                        for (var a = 0; a < row; a++) {
                            // if (document.getElementById('datatable-responsive').tBodies[0].rows[0].cells[4].innerHTML != "Total Amount"  && document.getElementById('datatable-responsive').tBodies[0].rows[0].cells[4].innerHTML !="" ) {
                            var newrow = a + 1;
                            GrossAmt = parseFloat(GrossAmt) + parseFloat(document.getElementById('example').tBodies[0].rows[newrow].cells[4].innerHTML);

                            // }
                        }
                        $("#GrossTotal").val(GrossAmt);
                        Calculate();
                    })
                }
            });

        })*@





  

  
<script>
    $(document).ready(function () {
        debugger
      //  RoleRight("KeystoneProject.Laboratory.PatientLabBills");
        $("#ExtraInformation").hide();

      


        $("#ExtraInfo").click(function () {
          //  alert("gfgfg");
            debugger
            $("#ExtraInformation").show();
            var select = document.getElementById("PaymentType").value;

        });

        $("#close1").click(function () {
            $("#ExtraInformation").hide();
        });
    });
    </script>
<script>
    $(document).ready(function () {
        debugger
        //  RoleRight("KeystoneProject.Laboratory.PatientLabBills");
        $("#DoctorSaveDivs").hide();




        $("#PaymentType").change(function () {
            //  alert("gfgfg");
            debugger
            var select = document.getElementById("PaymentType").value;

            switch (select) {
                case 'Cheque':
                    $("#DoctorSaveDivs").show(300);
                    $("#ChqNo").text("Cheque No");


                    $("#BankNo").text("Bank Name");

                    $("#paymentDate1").text("Cheque Date");

                    $("#paymentRemark1").text("Remark");
                    break;


                case 'Debit Card':
                    $("#DoctorSaveDivs").show(300);
                    $("#PaymentNo1").text("Debit Card No");


                    $("#paymentName1").text("Holder Name");

                    $("#paymentDate1").text("Valid UPTO");

                    $("#paymentRemark1").text("Remark");
                    break;



                case 'Credit Card':
                    $("#DoctorSaveDivs").show(300);
                    $("#PaymentNo1").text("Credit Card No");
                    $("#paymentName1").text("Holder Name");
                    $("#paymentDate1").text("Valid UPTO");
                    $("#paymentRemark1").text("Remark");
                    break;

                case 'E-Money':
                    $("#DoctorSaveDivs").show(300);
                    $("#PaymentNo1").text("Code");
                    $("#paymentName1").text("Bank Name");
                    $("#paymentDate1").text("Date");
                    $("#paymentRemark1").text("Remark");
                    break;

                case 'EFT':
                    $("#DoctorSaveDivs").show(300);
                    $("#PaymentNo1").text("Code");
                    $("#paymentName1").text("Bank Name");
                    $("#paymentDate1").text("Date");
                    $("#paymentRemark1").text("Remark");
                    break;

                case 'CASH':

                    $("#DoctorSaveDivs").hide(300);
                    break;
            }
        });

        $("#close").click(function () {
            $("#DoctorSaveDivs").hide();
        });
    });
</script>
<script>
    $(document).ready(function () {

        debugger
        $("#PatientRegNoprint").change(function () {
            var printReg = $(this).val();
            debugger
            $.ajax({
                url: '@Url.Action("GetPatientPrintNo_ToRegNo", "PatientOPD")',
                dataType: "json",
                type: 'GET',
                data: { PrintRegNo: $("#PatientRegNoprint").val(), PatientType: "%" },
                success: function (data) {
                    debugger
                    //$("input[type=text],input[type=number] ,hidden").val("");
                    $("#PatientRegNoprint").val(printReg);
                    $("#PatientRegNo").val(data);
                    Bind();
               
                    $("#OPDIPDNo").val(0)


            debugger
            $.ajax({
                url: '@Url.Action("FillRegDetails", "PatientLabBills")',
                type: "POST",
                datatype: "Json",
                data: { RegNo: $("#PatientRegNo").val(), OPDIPDNo: $("#OPDIPDNo").val() },
                success: function (data) {
                    debugger
                    var s = data[0].ReferredByDoctorID;
                    
                    
                    $("#PFPatientName").val(data[0].PrefixName);
                    $("#OPDIPDNoprint").val(data[0].PrintOPDIPDNo);
                    $("#PatientName").val(data[0].PatientName);
                    $("#RefferedDoctor").val(data[0].ReffDoctorName);
                    $("#PFPatientName").val(data[0].PrefixName);
                    $("#ConsultantDoctor").val(data[0].DoctorPrintName);

                    $("#ConsultantDoctorID1").val(data[0].ConsultantDrID);
                    $("#RefferedDoctorID").val(data[0].ReferredByDoctorID);
                    $("#Year").val(data[0].Age);
                    $("#DateOFBirth").val(data[0].DateOfBirth);
                    $("#PatientRegNo").val(data[0].PatientRegNo);
                    $("#GuardianName").val(data[0].GuardianName);
                    // alert($("#PrivilegeCard").val());
                    if ($("#PrivilegeCard").val() == "on" && data[0].PrivilegeCard != null) {

                        $("#PrivilegeCard").hide();
                        $("#spanPrivilege").hide();
                        $("#PrivilegeCardName").show();
                        $("#PrivilegeCardName").val(data[0].PrivilegeCard);

                    }
                    else {
                        $("#PrivilegeCard").show();
                        $("#spanPrivilege").show();
                        $("#PrivilegeCardName").hide();

                    }
                    //if ($("#PrivilegeCard").val(data[0].PrivilegeCard))
                    //{
                    //    $("#PrivilegeCard").val(checked);
                    //}

                    // $("").val(data[0].DateOfBirth);
                    $("#PatientType").text(data[0].PatientType);
                    $("#CompanyName").val(data[0].OrganizationName);

                    $("#PatientType1").val(data[0].PatientType);
                    $("#MobileNo").val(data[0].MobileNo);
                    $("#Address").val(data[0].Address);
                    $("#Gender").val(data[0].Gender);
                    //  alert(data[0].Gender);
                    $("#WardName").val(data[0].WardID);
                    $("#RoomNo").val(data[0].RoomID);
                    $("#BedNo").val(data[0].BedID);
                    $("#FinancialYearID").val(data[0].FinancialYearID);

                    // $("#FinancialYear").val(data[0].FinancialYear);
                    //alert(data[0].FinancialYear);
                    if ($("#PatientType1").val() == "IPD") {
                        $("#OPDIPDNo").val(data[0].PatientIPDNO);
                    }
                    else {
                        $("#OPDIPDNo").val(data[0].PatientOPDNO);
                    }

                    debugger

                    PreBalanceAmount = $("#PreBalance").val(data[0].PreBalanceAmount);
                    if (parseFloat(data[0].PreBalanceAmount) < 0) {
                        //alert("Deposit");

                        $("#priBalanceDeposit").text("Deposit")

                        $("#priBalanceDeposit").css("color", "blue");

                        var repalce1 = data[0].PreBalance;

                        var pre_balance = $("#PreBalance").val().replace("-", "");
                        $("#PreBalance").val(pre_balance)

                        $("#Deposit").val(repalce1);
                        // $("#pre_balance").attr('value', Deposit);
                    }
                    else {
                        $("#priBalanceDeposit").text("Pre.Balance");
                        $("#priBalanceDeposit").css("color", "black");
                        $("#Deposit").val("0.00")
                    }
                    $("#PatientNameID").val(data[0].PatientName);
                    //$("#OldBillNo").text('');
                }
            });
            $.ajax({
                url: '@Url.Action("OLDBILLBind", "PatientLabBills")',
                type: "POST",
                datatype: "Json",
                data: { RegNo: $("#PatientRegNo").val() },
                success: function (data) {
                    $("#OldBillNo option").remove();
                    $("#OldBillNo").append('<option value="--New--">--New--</option>');
                   
                    for (var a = 0; a < data.length; a++) {
                        //  alert(data[0].OLDBill);
                        $("#OldBillNo").append('<option value=' + data[a].BillNo + '>' + data[a].OLDBill + '</option>');
                        $("#btndelete").prop('disabled', false);
                    }
                }
            });
                }
            })
            $("#OldBillNo").change(function () {
                debugger
                if ($(this).val() == "--New--")
                {
                    $("#example tbody tr").remove();
                    $("#PatientRegNoprint").change();

                }
                $.ajax({
                    url: '@Url.Action("FillOldBillDetails", "PatientLabBills")',
                    type: "POST",
                    datatype: "Json",
                    data: { BillNo: $("#OldBillNo").val() },
                    success: function (data) {
                        debugger
                        $("#billno").val($("#OldBillNo").val());
                        $("#GrossTotal").val(data[0].GrossAmount);
                        $("#ServiceTax").val(data[0].TaxPercent);
                        $("#TaxAmt").val(data[0].TaxAmount);
                        $("#PreBalance").val(data[0].PreBalanceAmount);

                        if ($("#PreBalance").val() == "") {
                            $("#PreBalance").val(0.00);
                        }
                        $("#DiscountAmount").val(data[0].Discount);

                        if ($("#DiscountAmount").val() == "") {
                            $("#DiscountAmount").val(0.00);
                        }
                        debugger;

                        $("#SampleCollectionID").val(data[0].SampleCollectionBoyID).toString();
                       
                        $.ajax({
                            url: '@Url.Action("sample", "PatientLabBills")',
                            type: "POST",
                            datatype: "Json",
                            data: { id: $("#SampleCollectionID").val() },
                            success: function (data) {
                                    $("#SampleCollection").val(data[0].FullName);
                            }
                        });
                        $("#CompanyName").val(data[0].OrganizationName).toString();
                        $("#CollectionCentre").val(data[0].CollectionCentreName).toString();
                        $("#BillDate").val(data[0].BillDate).toString("dd-MM-yyyy");
                        $("#Time").val(data[0].BillDatetime).toString("hh:mm:ss");
                        $("#Discount").val(data[0].DiscountPer);
                        $("#TotalAmt").val(data[0].TotalAmount);
                        $("#AmtPaid").val(data[0].PaidAmount);
                        $("#NetPay").val(data[0].NetAmountPayable);
                        $("#DiscReason").val(data[0].DiscountReason);
                        $("#BalAmt").val(data[0].BalanceAmount);

                        if (data[0].PaymentType != "Cash") {
                            $("#Number").val(data[0].Number);
                            $("#Name").val(data[0].Name);
                            $("#paymentDate").val(data[0].PaymentDate);
                            //   alert(data[0].PaymentDate);
                            $("#Remarks").val(data[0].Remark);
                        }
                        debugger;
                        document.getElementById("PaymentType").value = data[0].PaymentType;
                        debugger;
                        switch (data[0].PaymentType) {

                            case 'Cheque':
                                $("#DoctorSaveDivs").show(300);
                                $("#PaymentNo1").text("Cheque No");


                                $("#paymentName1").text("Bank Name");

                                $("#paymentDate1").text("Cheque Date");

                                $("#paymentRemark1").text("Remark");


                                break;


                            case 'Debit Card':
                                $("#DoctorSaveDivs").show(300);
                                $("#PaymentNo1").text("Debit Card No");


                                $("#paymentName1").text("Holder Name");

                                $("#paymentDate1").text("Valid UPTO");

                                $("#paymentRemark1").text("Remark");
                                // document.getElementById("payment_type").selectedIndex = 3;
                                break;



                            case 'Credit Card':
                                $("#DoctorSaveDivs").show(300);
                                $("#PaymentNo1").text("Credit Card No");
                                $("#paymentName1").text("Holder Name");
                                $("#paymentDate1").text("Valid UPTO");
                                $("#paymentRemark1").text("Remark");
                                //  document.getElementById("payment_type").selectedIndex = 2;
                                break;

                            case 'E-Money':
                                $("#DoctorSaveDivs").show(300);
                                $("#PaymentNo1").text("Code");
                                $("#paymentName1").text("Bank Name");
                                $("#paymentDate1").text("Date");
                                $("#paymentRemark1").text("Remark");
                                // document.getElementById("payment_type").selectedIndex = 4;
                                break;

                            case 'EFT':
                                $("#DoctorSaveDivs").show(300);
                                $("#PaymentNo1").text("Code");
                                $("#paymentName1").text("Bank Name");
                                $("#paymentDate1").text("Date");
                                $("#paymentRemark1").text("Remark");
                                // document.getElementById("payment_type").selectedIndex = 5;
                                break;

                            case 'CASH':
                                document.getElementById("payment_type").selectedIndex = 0;
                                $("#DoctorSaveDivs").hide(300);
                                break;
                        }



                        debugger
                   
                        $("#example td").remove();
                        for (var a = 0; a < data.length; a++) {
                            debugger
                            var TotalAmt = parseFloat(data[a].Qty) * parseFloat(data[a].Rate)
                          
                            if (data[a].samplecollection == "1") {
                                $("#example").append('<tr><td style="display:none"><input type="hidden" name="mode" value="Edit"><input type="hidden" id="samplecollection1" name="samplecollection1" value="' + data[a].samplecollection + '"><input type ="checkbox" id="samplecollection" name="samplecollection" checked="checked"></td><td><input type="hidden" value=' + data[a].TestID + ' name="TesttableID"><input type="hidden" value=' + data[a].TestName + ' name="TestNamerow">' + data[a].TestName + '</td><td><input type="text" class="form-control" name="rate1" value=' + data[a].Rate + ' ></td><td><input type="text" value=' + data[a].Qty + ' class="form-control" id="qty1" name="qty"></td><td><select name="DiscountServiceType" id="DiscountServiceType" class="nr form-control"> <option value="Rs">Rs</option><option value="Rs">Rs</option><option value="%">%</option></select></td><td><input value=' + data[a].Discount_Service + ' class="nr form-control" type="number" id="Discount_Service" name="Discount_Service"><input value="0" type="hidden" id="sevicedisAmt" name="sevicedisAmt"></td><td class="total">' + data[a].ServiceTotal + '</td><td><input type="hidden" name="ReportDate" value=' + data[a].ReportingDate + '>' + data[a].BillDate + '</td><td style="display:none" ><input type="hidden" id="outid1" name="outid1" value=' + data[a].OutSourceID + '></td><td><input type="text" class="out1" id="out1" name="out1" value=' + data[a].LabName + ' ></td><td style="display:none" ><input type="hidden" name="ServiceType" value=' + data[a].ServiceType + '></td><td><a href="#" style="color:red" class="glyphicon glyphicon-remove" aria-hidden="true" id="delrow" class="delrow"></a></td></tr>');
                            }
                            else {
                                $("#example").append('<tr><td style="display:none"><input type="hidden" name="mode" value="Edit"><input type="hidden" id="samplecollection1" name="samplecollection1" value="' + data[a].samplecollection + '"><input type ="checkbox" id="samplecollection" name="samplecollection"></td><td><input type="hidden" value=' + data[a].TestID + ' name="TesttableID"><input type="hidden" value=' + data[a].TestName + ' name="TestNamerow">' + data[a].TestName + '</td><td><input type="text" class="form-control" name="rate1" value=' + data[a].Rate + ' ></td><td><input type="text" value=' + data[a].Qty + ' class="form-control" id="qty1" name="qty"></td><td><select name="DiscountServiceType" id="DiscountServiceType" class="nr form-control"> <option value="Rs">Rs</option><option value="Rs">Rs</option><option value="%">%</option></select></td><td><input value=' + data[a].Discount_Service + ' class="nr form-control" type="number" id="Discount_Service" name="Discount_Service"><input value="0" type="hidden" id="sevicedisAmt" name="sevicedisAmt"></td><td class="total">' + data[a].ServiceTotal + '</td><td><input type="hidden" name="ReportDate" value=' + data[a].ReportingDate + '>' + data[a].BillDate + '</td><td style="display:none" ><input type="hidden" id="outid1"   name="outid1" value=' + data[a].OutSourceID + '></td><td><input type="text" class="out1" id="out1"  name="out1" value=' + data[a].LabName + ' ></td><td style="display:none"><input type="hidden" name="ServiceType" value=' + data[a].ServiceType + '></td><td><a href="#" style="color:red" class="glyphicon glyphicon-remove" aria-hidden="true" id="delrow" class="delrow"></a></td></tr>');

                            }
                        }
                        CaculateDescount();
                    }
                });

            })


        });
        $("#ServiceTax").keyup(function () {
            if ($(this).val() == "") {
                $(this).val(0)
            }
           
            debugger
            var Surcharge = parseFloat($("#GrossTotal").val()) * parseFloat($("#ServiceTax").val()) / 100;
            $("#TaxAmt").val(Surcharge.toFixed(2));
            Calculate();
            

        })
        $("#example").on('click', '#delrow', function () {
            debugger;
            // $("#example").closest('tr').remove();
            $(this).closest('tr').remove();
            GrossAmt = 0;
            //var row = $(this).closest('tr').length;
            //for (var a = 0; a < row; a++) {
            //    //govind if (document.getElementById('datatable-responsive').tBodies[0].rows[0].cells[4].innerHTML != "Total Amount"  && document.getElementById('datatable-responsive').tBodies[0].rows[0].cells[4].innerHTML !="" ) {
            //     var newrow =document.getElementById('example').tBodies[0].rows[0].cells[6].innerHTML;
            //    GrossAmt = parseFloat(GrossAmt) + parseFloat(document.getElementById('example').tBodies[0].rows[row].cells[6].innerHTML);

            //    // }
            //}
            // $("#GrossTotal").val(GrossAmt);
            $(".total").each(function () {
                debugger
                GrossAmt += parseFloat($(this).text());
            })
            $("#GrossTotal").val(GrossAmt);
            Calculate();
        })
    });
    </script>

<script>
    $(document).ready(function () {
        Bind();
        $('input[name=Charge]').click(function () {

            Bind();
        })
    })
   
            function Bind ()
            {
                 debugger
                var select = $('input[name=Charge]:checked').val();
               //alert(select);
                if (select == "Test") {

                $("#Test").autocomplete({

                    source: function (request, response) {

                        $.ajax({
                            url: '@Url.Action("TestName", "PatientLabBills")',
                            type: "POST",
                            dataType: "Json",
                            data: { prefix: request.term },
                            success: function (data) {
                                response($.map(data, function (item) {
                                    return { label: item.TestName, value: item.TestName, id: item.TestID, EmergencyCharges: item.EmergencyCharges, GeneralCharges: item.GeneralCharges };
                                }));
                            },
                            //error: function (xhr, status, error) {
                            //    alert("Error: " + error);
                            //}
                        });
                    },
                    minLength: 1,
                    change: function (event, ui) {
                        if (!ui.item) {
                            this.value = '';

                        }
                        $("#TestID").val(ui.item.id);
                        tpa = $("#CompanyID").val();
                        if (tpa > 0) {


                            $.ajax({
                                url: '@Url.Action("BindCharges1", "PatientLabBills")',
                                type: "POST",
                                dataType: "Json",
                                data: { tpaID: tpa, testID: $('#TestID').val(), select: chck, DrID: $("#ConsultantDoctorID1").val() },
                                success: function (data) {
                                    debugger
                                    for (var i = 0; i < data.searchlist.length; i++) {
                                        debugger
                                        rate2 = data.searchlist[i].GeneralCharges;
                                       // alert(rate2);
                                        $("#rate").val(rate2);
                                    }

                                },

                            });
                        }
                        debugger

                        var selectTest = $('input[name=RadioCharge]:checked').val();
                      // alert(selectTest);
                        if (selectTest == "General") {
                            debugger
                            $("#rate").val(ui.item.GeneralCharges);
                            // alert(ui.item.id);
                        }
                        else {


                            $("#rate").val(ui.item.EmergencyCharges);
                        }
                        // $("#TestID1").val(ui.item.GeneralCharges);
                    }
                });
               
            }
        else {
                    //var tpa = $("#CompanyID").val();

                    //if (tpa != "") {
                    //    tpa = $("#CompanyID").val();
                    //    alert(tpa);
                    //}
                    //else {
                    //    tpa = 0;
                    //    alert(tpa);
                    //}
            $("#Test").autocomplete({

                source: function (request, response) {

                    $.ajax({
                        url: '@Url.Action("Package", "PatientLabBills")',
                        type: "POST",
                        dataType: "Json",
                        data: { prefix: request.term},
                        success: function (data) {
                            response($.map(data, function (item) {
                                return { label: item.ProfileName, value: item.ProfileName, id: item.ProfileID, rate:item.Rate };
                            }));
                        },
                        //error: function (xhr, status, error) {
                        //    alert("Error: " + error);
                        //}
                    });
                },
                minLength: 1,
                change: function (event, ui) {
                    if (!ui.item) {
                        this.value = '';

                    }
                    debugger
                    $("#TestID").val(ui.item.id);
                    tpa = $("#CompanyID").val();
                    if (tpa > 0) {

                        $.ajax({
                            url: '@Url.Action("BindCharges1", "PatientLabBills")',
                            type: "POST",
                            dataType: "Json",
                            data: { tpaID: tpa, testID: $('#TestID').val(), select: chck, DrID: $("#ConsultantDoctorID1").val() },
                            success: function (data) {
                                debugger
                                for (var i = 0; i < data.searchlist.length; i++) {
                                    rate2 = data.searchlist[i].GeneralCharges;
                                  //  alert(rate2);
                                    $("#rate").val(rate2);
                                }

                            },

                        });
                    }
                    else {


                        $("#rate").val(ui.item.rate);
                    }
                    debugger
                   
                }
            });


                
        }
    
    
    }

    $(document).ready(function () {
        $("#CompanyID").keyup(function () {
            if($(this).val()=="")
            {
                $("#CompanyID").val("");
            }
        })
    $("#ConsultantDoctor").autocomplete({
      

            source: function (request, response) {
                debugger
                $.ajax({
                    url: '@Url.Action("GetConsDoctor", "PatientLabBills")',
                    type: "POST",
                    dataType: "Json",
                    data: { prefix: request.term },
                    success: function (data) {
                        debugger
                        response($.map(data, function (item) {
                            return { label: item.DoctorPrintName, value: item.DoctorPrintName, id: item.DoctorID };
                        }));
                    },
                    //error: function (xhr, status, error) {
                    //    alert("Error: " + error);
                    //}
                });
            },
            minLength: 1,
            change: function (event, ui) {
                if (!ui.item) {
                    this.value = '';

                }
                $("#ConsultantDoctorID1").val(ui.item.id);
              
            }
        });
   });


    $(document).ready(function () {
       
        $("#DiscReason").append($("<option value=0>--Select---</option>"));
       
           
            // source: function (request, response) {
            debugger
            $.ajax({
                   
                url: '@Url.Action("GetDiscountReason", "PatientLabBills")',
                type: "GET",
                dataType: "Json",
               
                data: { DiscountReason: $("#DiscReason").val() },
                success: function (data) {
                   
                 //   $('#DiscReason option:not(:first)').remove();
         
                    for (var a = 0; a < data.length; a++) {
                       
                        $("#DiscReason").append('<option value=' + data[a].DiscountReason + '>' + data[a].DiscountReason + '</option>');
                  
                    }
                }

               
            
        });
    })

    $(document).ready(function () {
        $("#OutSource").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: '@Url.Action("GetOutsource", "PatientLabBills")',
                    type: "POST",
                    dataType: "Json",
                    data: { prefix: request.term },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item.LabName, value: item.LabName, id: item.OutSourceLabID };
                        }));
                    },
                    error: function (xhr, status, error) {
                        alert("Error: " + error);
                    }
                });

            },
            minLength: 1,
            select: function (event, ui) {
                if (!ui.item) {
                    this.value = '';

                }
                $("#OutSourceID").val(ui.item.id);
              //  alert($("#OutSourceID").val())


                $.ajax({

                    url: '@Url.Action("GetOutSourceLabTestRate", "PatientLabBills")',
                    type: "POST",
                    dataType: "json",
                    data: { OutSourceLabID: $("#OutSourceID").val() ,TestID: $("#TestID").val() },
                   
                    success: function (data) {
                        debugger
                       
                            $("#OutSource").val(data[0].LabName);
                          //  $("#Test").val(data[0].TestName);
                            $("#rate").val(data[0].Rate);
                            alert(data[0].Rate);
                            //$("#WardID").val(data[0].WardID);
                      

                    },
                });


               
            }


        })
     
       
       

           
        })
   
    </script>
<script>
    var Rate = 0;
    function GetOutsource() {
        debugger
        
        $(".out1").autocomplete({

            source: function (request, response) {
                $.ajax({
                    url: '@Url.Action("GetOutsource", "PatientLabBills")',
                    type: "POST",
                    dataType: "Json",
                    data: { prefix: request.term },
                    success: function (data) {

                        response($.map(data, function (item) {
                            return { label: item.LabName, value: item.LabName, id: item.OutSourceLabID };
                        }));
                    },
                    error: function (xhr, status, error) {
                        alert("Error: " + error);
                    }
                });

            },
            minLength: 1,
            select: function (event, ui) {
                if (!ui.item) {
                    this.value = '';

                }
                $("#outid1").val(ui.item.id);
                //alert($("#outid1").val() + "ddd" + $("#testidhidden").val())


                $.ajax({

                    url: '@Url.Action("GetOutSourceLabTestRate", "PatientLabBills")',
                    type: "POST",
                    dataType: "json",
                    data: { OutSourceLabID: $("#outid1").val(), TestID: $("#testidhidden").val() },

                    success: function (data) {
                        debugger

                        //$("#outid1").val(data[0].LabName);
                        //  $("#Test").val(data[0].TestName);
                        $("#rate1").val(data[0].Rate);
                        Rate5 = data[0].Rate;
                        alert(data[0].Rate + "hm" );
                        //$("#WardID").val(data[0].WardID);


                    },
                });



            }


        })
        return 
    }

    $(document).ready(function () {
        $("#SampleCollection").autocomplete({

            source: function (request, response) {
                debugger
                $.ajax({
                    url: '@Url.Action("GetUser", "PatientLabBills")',
                    type: "POST",
                    dataType: "Json",
                    data: { prefix: request.term },
                    success: function (data) {
                        debugger
                        response($.map(data, function (item) {
                            return { label: item.FullName, value: item.FullName, id: item.UserID };
                        }));
                    },
                 
                });
            },
            minLength: 1,
            change: function (event, ui) {
                if (!ui.item) {
                    this.value = '';

                }
                $("#SampleCollectionID").val(ui.item.id);
            }
        });
    });


    $(document).ready(function () {
        $("#RefferedDoctor").autocomplete({

            source: function (request, response) {
                debugger
                $.ajax({
                    url: '@Url.Action("GetRefferedDoctor", "PatientLabBills")',
                    type: "POST",
                    dataType: "Json",
                    data: { prefix: request.term },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item.DoctorPrintName, value: item.DoctorPrintName, id: item.DoctorID };
                        }));
                    },
                   
                });
            },
            minLength: 1,
            change: function (event, ui) {
                if (!ui.item) {
                    this.value = '';

                }
                $("#RefferedDoctorID").val(ui.item.id);
            }
        });
    });



    var chck = $('input[name=Charge]:checked').val();
    $(document).ready(function () {
        $("#example tbody tr").remove();
        chck = $('input[name=Charge]:checked').val();
   
        $('input[name=Charge]').click(function () {
            debugger
            chck = $(this).val();
        })
        $("#Add").click(function () {

            if ($('#Test').val() == "") {
                alert('Please Choose Test');
            }
            else {
                debugger
               
                var rate = "";
                var OutSoreceID = $("#OutSourceID").val();
              //  alert(OutSoreceID);
                if (chck == "Package") {

                    if ($("#ConsultantDoctorID1").val() != "") {

                        test2 = $("#TestID").val();
                        testname1 = $('#Test').val();

                      
                        debugger
                        if ( OutSoreceID!="")
                        {
                         
                            OutSoreceID = $("#OutSourceID").val();
                        }
                        else
                        {
                            OutSoreceID = 0;
                          
                            
                        }
                        var tpa=  $("#CompanyID").val();
                        debugger
                        if (tpa != "")
                        {
                            tpa = $("#CompanyID").val();
                          
                           
                          //  alert(tpa);
                        }
                        else
                        {
                            tpa = 0;
                          //  alert(tpa);
                       
                        }
                        rate3 = $("#rate").val();
                        Qty = 1;
                        var TotalAmt = parseFloat(rate3) * Qty;
                        if ($("#OutSource").val() == 0) {
                            var out = "Self";
                        }
                        else {
                            out = $("#OutSource").val();
                        }
                        $(".1testidhidden").each(function () {
                            var testid1 = $(this).parent().find("#testidhidden").val();
                            if (testid1 == test2) {
                                alert("Already Exists");
                                test2 = 0;
                                return false;
                            }

                        })
                        if (test2 > 0) {


                            $("#example").append('<tr><td style="display:none"><input type="hidden" name="mode" value="Add"><input type="hidden" id="samplecollection1" name="samplecollection1" value="0"><input type ="checkbox" id="samplecollection" value=' + Test + ' name="samplecollection"></td><td class="1testidhidden"><input type="hidden" id="testidhidden"  value=' + test2 + ' name="TesttableID"><input type="hidden" value=' + testname1 + ' name="TestNamerow">' + testname1 + '</td><td><input type="text" class="form-control" name="rate1" value=' + rate3 + ' ></td><td><input type="text" value="1" class="form-control" id="qty1" name="qty"></td><td><select name="DiscountServiceType" id="DiscountServiceType" class="nr form-control"> <option value="Rs">Rs</option><option value="Rs">Rs</option><option value="%">%</option></select></td><td><input value="0.00" class="nr form-control" type="number" id="Discount_Service" name="Discount_Service"><input value="0" type="hidden" id="sevicedisAmt" name="sevicedisAmt"></td><td class="total">' + TotalAmt + '</td><td><input type="hidden" name="ReportDate" value="@DateTime.Now.ToString("dd-MM-yyyy")"> @DateTime.Now.ToString("dd-MM-yyyy")</td><td style="display:none" ><input type="hidden" id="outid1"  name="outid1" value="0"></td><td><input type="text" class="out1" id="out1"  name="out1" value=' + out + ' ></td><td style="display:none" ><input type="hidden" name="ServiceType" value="ProfileBill"></td><td><a href="#" style="color:red" aria-hidden="true" id="delrow" class="delrow"><span>Remove</span></a></td></tr>');
                        }
                        $.ajax({
                            url: '@Url.Action("BindCharges", "PatientLabBills")',
                            type: "POST",
                            dataType: "Json",
                            data: { DrID: $("#ConsultantDoctorID1").val(), testID: $('#TestID').val(), select: chck, OutSoreceID: OutSoreceID, tpaID: tpa },
                            success: function (data) {
                             
                                    debugger
                                    for (var i = 0; i < data.searchlist.length; i++) {
                                       
                                        var test = data.searchlist[i].TestID;
                                        var testname = data.searchlist[i].TestName;
                                        var Qty = 1;
                                        var OutSorece = $("#OutSource").val();
                                        var OutSoreceID = $("#OutSourceID").val();
                                        debugger
                                       
                                         
                                                rate = 0.00;
                                        
                                        var TotalAmt = parseFloat(rate) * Qty;

                                        $(".1testidhidden").each(function () {
                                            var testid = $(this).parent().find("#testidhidden").val();
                                            if (testid == test) {

                                                alert("Already Exists");
                                                test = 0;
                                                return false;
                                            }

                                        })
                                        debugger
                                        if ($("#OutSource").val() == 0) {
                                            var out = "Self";

                                            if (test > 0) {
                                              
                                                $("#example").append('<tr><td style="display:none"><input type="hidden" name="mode" value="Add"><input type="hidden" id="samplecollection1" name="samplecollection1" value="0"><input type ="checkbox" id="samplecollection" value=' + Test + ' name="samplecollection"></td><td class="1testidhidden"><input type="hidden" id="testidhidden"  value=' + test + ' name="TesttableID"><input type="hidden" value=' + data.searchlist[i].TestName + ' name="TestNamerow">' + data.searchlist[i].TestName + '</td><td><input type="text" class="form-control" name="rate1" value=' + rate + ' ></td><td><input type="text" value="1" class="form-control" id="qty1" name="qty"></td><td><select name="DiscountServiceType" id="DiscountServiceType" class="nr form-control"> <option value="Rs">Rs</option><option value="Rs">Rs</option><option value="%">%</option></select></td><td><input value="0.00" class="nr form-control" type="number" id="Discount_Service" name="Discount_Service"><input value="0" type="hidden" id="sevicedisAmt" name="sevicedisAmt"></td><td class="total">' + TotalAmt + '</td><td><input type="hidden" name="ReportDate" value="@DateTime.Now.ToString("dd-MM-yyyy")"> @DateTime.Now.ToString("dd-MM-yyyy")</td><td style="display:none" ><input type="hidden" id="outid1"  name="outid1" value="0"></td><td><input type="text" class="out1" id="out1" name="out1" value=' + out + ' ></td><td style="display:none" ><input type="hidden" name="ServiceType" value="ProfileBillTest"><td><a href="#" style="color:red"  aria-hidden="true" id="delrow" class="delrow"><span>Remove</span></a></td></tr>');
                                            }

                                        }
                                        else {
                                            if (test > 0) {

                                                $("#example").append('<tr><td style="display:none"><input type="hidden" name="mode" value="Add"><input type="hidden" id="samplecollection1" name="samplecollection1" value="0"><input type ="checkbox" id="samplecollection" value=' + Test + ' name="samplecollection"></td><td class="1testidhidden"><input type="hidden" id="testidhidden"  value=' + test + ' name="TesttableID"><input type="hidden" value=' + data.searchlist[i].TestName + ' name="TestNamerow">' + data.searchlist[i].TestName + '</td><td><input type="text" id="rate1" class="rate1 form-control" name="rate1" value=' + rate + ' ></td><td><input type="text" value="1" class="form-control" id="qty1" name="qty"></td><td><select name="DiscountServiceType" id="DiscountServiceType" class="nr form-control"> <option value="Rs">Rs</option><option value="Rs">Rs</option><option value="%">%</option></select></td><td><input value="0.00" class="nr form-control" type="number" id="Discount_Service" name="Discount_Service"><input value="0" type="hidden" id="sevicedisAmt" name="sevicedisAmt"></td><td class="total">' + TotalAmt + '</td><td><input type="hidden" name="ReportDate" value="@DateTime.Now.ToString("dd-MM-yyyy")"> @DateTime.Now.ToString("dd-MM-yyyy")</td><td style="display:none" ><input type="hidden" id=outid1  name="outid1" value=' + OutSoreceID + '></td><td><input type="text" id="out1" class="out1"  name="out1" value=' + OutSorece + ' ></td><td style="display:none"><input type="hidden" name="ServiceType" value="ProfileBillTest"><td><a href="#" style="color:red"  aria-hidden="true" id="delrow" class="delrow"><span>Remove</span></a></td></tr>');
                                            }
                                        }

                                    };
                              //  });
                                },

                               
                                });
                        
                    }
                    else {
                        alert("Please select ConsultantDoctor")
                    }
                }
                else
                {
                   
                    if ($("#ConsultantDoctorID1").val() != "") {
                        var Rate;
                        var TestName = $("#Test").val();
                       
                        Rate = $("#rate").val();
                     
                      
                        var Qty = 1;
                        var TestID = $("#TestID").val();//9506634346
                        var OutSorece = $("#OutSource").val();
                        var OutSoreceID = $("#OutSourceID").val();
                     //   var Remark = $("#Remark").val();
                        var TotalAmt = parseFloat(Rate) * Qty;

                        debugger
                       

                      
                       $(".1testidhidden").each(function () {
                           var testid = $(this).parent().find("#testidhidden").val();
                           if (testid == TestID) {
                             
                               alert("Already Exists");
                               TestID = 0;
                               return false;
                           }

                       })
                       if ($("#OutSource").val() == "") {
                           var out = "Self";
                           if (TestID > 0) {
                               var id = $("#example").append('<tr><td style="display:none"><input type="hidden" name="mode" value="Add"><input type="hidden" id="samplecollection1" name="samplecollection1" value="0"><input type ="checkbox" id="samplecollection" value=' + Test + ' name="samplecollection"></td><td class="1testidhidden"><input type="hidden" id="testidhidden"  value=' + TestID + ' name="TesttableID"><input type="hidden" value=' + TestName + ' name="TestNamerow">' + TestName + '</td><td><input type="text" class="form-control" name="rate1" value=' + Rate + ' ></td><td><input type="text" value="1" class="form-control" id="qty1" name="qty"></td><td><select name="DiscountServiceType" id="DiscountServiceType" class="nr form-control"> <option value="Rs">Rs</option><option value="Rs">Rs</option><option value="%">%</option></select></td><td><input value="0.00" class="nr form-control" type="number" id="Discount_Service" name="Discount_Service"><input value="0" type="hidden" id="sevicedisAmt" name="sevicedisAmt"></td><td class="total">' + TotalAmt + '</td><td><input type="hidden" name="ReportDate" value="@DateTime.Now.ToString("dd-MM-yyyy")"> @DateTime.Now.ToString("dd-MM-yyyy")</td><td style="display:none" ><input type="hidden" id="outid1"  name="outid1" value="0"></td><td><input type="text" class="out1" id="out1" name="out1" value=' + out + ' ></td><td style="display:none" ><input type="hidden" name="ServiceType" value="LabBill"><td><a href="#" style="color:red"  aria-hidden="true" id="delrow" class="delrow"><span>Remove</span></a></td></tr>');
                           }
                       }
                       else {
                           if (TestID > 0) {
                               var id = $("#example").append('<tr><td style="display:none"><input type="hidden" name="mode" value="Add"><input type="hidden" id="samplecollection1" name="samplecollection1" value="0"><input type ="checkbox" id="samplecollection" value=' + Test + ' name="samplecollection"></td><td class="1testidhidden"><input type="hidden" id="testidhidden"  value=' + TestID + ' name="TesttableID"><input type="hidden" value=' + TestName + ' name="TestNamerow">' + TestName + '</td><td><input type="text" class="form-control" name="rate1" value=' + Rate + ' ></td><td><input type="text" value="1" class="form-control" id="qty1" name="qty"></td><td><select name="DiscountServiceType" id="DiscountServiceType" class="nr form-control"> <option value="Rs">Rs</option><option value="Rs">Rs</option><option value="%">%</option></select></td><td><input value="0.00" class="nr form-control" type="number" id="Discount_Service" name="Discount_Service"><input value="0" type="hidden" id="sevicedisAmt" name="sevicedisAmt"></td><td class="total">' + TotalAmt + '</td><td><input type="hidden" name="ReportDate" value="@DateTime.Now.ToString("dd-MM-yyyy")"> @DateTime.Now.ToString("dd-MM-yyyy")</td><td style="display:none" ><input type="hidden" id="outid1" name="outid1" value=' + OutSoreceID + '></td><td><input type="text" class="out1" id="out1" name="out1" value=' + OutSorece + ' ></td><td style="display:none" ><input type="hidden" name="ServiceType" value="LabBill"><td><a href="#" style="color:red"  aria-hidden="true" id="delrow" class="delrow"><span>Remove</span></a></td></tr>');
                           }
                       }
                    }

                   
                    else {
                        alert("Please select ConsultantDoctor")
                    }

                }
                   
                var TestName = $("#Test").val('');
                var Rate = $("#rate").val('');
                var Qty = 1;
            
                var rowCount = $('#example tr:last').index();
                var GrossAmt = 0;
                var TotalAmt1 = 0;
                var row = $('#example tbody tr').length;
                for (var a = 0; a < row; a++) {

                    GrossAmt = parseFloat(GrossAmt) + parseFloat(document.getElementById('example').tBodies[0].rows[a].cells[6].innerHTML);
                    $("#GrossTotal").val(GrossAmt);
                   
                }
                Calculate();
            }



            $("#example ").on('click', '#delrow1', function () {
                debugger;
                $(this).closest('tr').remove();
                GrossAmt = 0;
                var row = $("#example td").closest("tr").length;
                for (var a = 0; a < row; a++) {
                    // if (document.getElementById('datatable-responsive').tBodies[0].rows[0].cells[4].innerHTML != "Total Amount"  && document.getElementById('datatable-responsive').tBodies[0].rows[0].cells[4].innerHTML !="" ) {
                    var newrow = a + 1;
                    GrossAmt = parseFloat(GrossAmt) + parseFloat(document.getElementById('example').tBodies[0].rows[newrow].cells[4].innerHTML);

                    // }
                }
                $("#GrossTotal").val(GrossAmt);
                Calculate();
            })



        });

     
        $("#example").delegate('td', 'keyup', function () {
         
            var row = $(this).parent().index();
            var rowCount = $('#example tr:last').index();
            GetOutsource();
            if ($("#rate1").val() > 0) {
               debugger
               document.getElementById('example').tBodies[0].rows[row].cells[2].children[0].value = $("#rate1").val();
            }


            var qt = document.getElementById('example').tBodies[0].rows[row].cells[3].children[0].value;
            var rate1 = document.getElementById('example').tBodies[0].rows[row].cells[2].children[0].value;
            var DisAmt = document.getElementById('example').tBodies[0].rows[row].cells[5].children[1].value
            var Total = parseFloat(qt) * parseFloat(rate1).toFixed([2]);
            document.getElementById('example').tBodies[0].rows[row].cells[6].innerHTML = Total;
           // var aaa = document.getElementById('example').tBodies[0].rows[1].cells[4].innerHTML;

            var GrossAmt = 0;
            CaculateDescount();
            var row = $("#example td").closest("tr").length;

            for (var a = 0; a < row; a++) {
                // if (document.getElementById('datatable-responsive').tBodies[0].rows[0].cells[4].innerHTML != "Total Amount"  && document.getElementById('datatable-responsive').tBodies[0].rows[0].cells[4].innerHTML !="" ) {
                // var newrow = a + 1;
                GrossAmt = parseFloat(GrossAmt) + parseFloat(document.getElementById('example').tBodies[0].rows[a].cells[6].innerHTML);
                $("#GrossTotal").val(GrossAmt);
                // }
            }


            Calculate();
            
        });

        $("#example").delegate('td', 'change', function () {
           debugger
            var row = $(this).parent().index();
            var rowCount = $('#example tr:last').index();

            var qt = document.getElementById('example').tBodies[0].rows[row].cells[3].children[0].value;
            var rate1 = document.getElementById('example').tBodies[0].rows[row].cells[2].children[0].value;
            var DisAmt = document.getElementById('example').tBodies[0].rows[row].cells[5].children[1].value
            var Total = parseFloat(qt) * parseFloat(rate1).toFixed([2]);
            document.getElementById('example').tBodies[0].rows[row].cells[6].innerHTML = Total;
           // var aaa = document.getElementById('example').tBodies[0].rows[1].cells[4].innerHTML;

            var GrossAmt = 0;
            CaculateDescount();
            var row = $("#example td").closest("tr").length;

            for (var a = 0; a < row; a++) {
                // if (document.getElementById('datatable-responsive').tBodies[0].rows[0].cells[4].innerHTML != "Total Amount"  && document.getElementById('datatable-responsive').tBodies[0].rows[0].cells[4].innerHTML !="" ) {
                // var newrow = a + 1;
                GrossAmt = parseFloat(GrossAmt) + parseFloat(document.getElementById('example').tBodies[0].rows[a].cells[6].innerHTML);
                $("#GrossTotal").val(GrossAmt);
                // }
            }


            Calculate();
            GetOutsource();
        });
        $("#AmtPaid").keyup(function () {
            Calculate();
        });

        $('#DiscountAmount').keyup(function () {
            debugger;
            var show = $("#DiscReason").val();
            debugger;
            if (show == "0") {
                //alert("Select Proper Discount Reason");
                //$('#DiscountAmount').val('');
                //$('#DiscReason').focus();
            }
            else {
                var show = $('#DiscountAmount').val();
                if (show == '') {
                    Calculate();
                }
                else {
                    DiscountAmt();
                    Calculate();
                }
            }
            Calculate();
        });
        $('#Discount').keyup(function () {
            debugger;
            var show = $("#DiscReason").val();
            var show1 = $("#Discount").val();
            if (show == 0) {
                //alert("Select Proper Discount Reason");
                //$("#Discount").val('');
                //$("#DiscReason").focus();
            }
            else {
                if (show1 == "") {
                    DiscountPer();
                    Calculate();
                }
                else {
                    DiscountPer();
                    Calculate();
                }
            }
        });

    });

    $('#ServiceTax').keyup(function () {
        Calculate();
    })


    function CaculateDescount() {
        var child = $("#example td").closest("tr").length;
        debugger
        var gross = 0;
        var Discount_ServiceTotal = 0;
        var DiscountPercent = 0;
        var TotalPer = 0;
        var rate = 0;
        var qty = 0;
        for (var row = 0; row < child; row++) {
            TotalPer = 0;
            var a = $(this).parent().find('#txt_tbl_rate').val();
            rate = parseFloat(document.getElementById('example').tBodies[0].rows[row].cells[2].children[0].value);
            qty = parseFloat(document.getElementById('example').tBodies[0].rows[row].cells[3].children[0].value);
            DiscountPercent = parseFloat(document.getElementById('example').tBodies[0].rows[row].cells[5].children[0].value);
            document.getElementById('example').tBodies[0].rows[row].cells[5].children[0].value = DiscountPercent;
            if (document.getElementById('example').tBodies[0].rows[row].cells[5].children[0].value == "") {
                document.getElementById('example').tBodies[0].rows[row].cells[5].children[0].value = 0;
                DiscountPercent = 0;
            }
            if (document.getElementById('example').tBodies[0].rows[row].cells[4].children[0].value == "%") {

                if (DiscountPercent <= 100 || DiscountPercent == 0) {

                    var Gross = parseFloat(rate) * parseFloat(qty);
                    TotalPer = TotalPer + ((Gross * DiscountPercent) / 100);
                    // document.getElementById('example').tBodies[0].rows[row].cells[6].innerHTML = Gross - TotalPer;
                    //    $('#disc_amount_id').val(TotalPer.toFixed(2));
                    document.getElementById('example').tBodies[0].rows[row].cells[5].children[1].value = TotalPer.toFixed(2);
                    //$("#sevicedisAmt").val(TotalPer.toFixed(2));
                }
                else {
                    alert("Discount Not Less " + DiscountPercent);
                    return false;
                }
            }
            else {
                var gross = parseFloat(rate) * parseFloat(qty) - parseFloat(DiscountPercent);

                document.getElementById('example').tBodies[0].rows[row].cells[5].children[1].value = DiscountPercent;

                // document.getElementById('example').tBodies[0].rows[row].cells[6].innerHTML = gross.toFixed(2);
            }

        }
        var sevicedisAmt = 0;
        $(".total").each(function () {
            debugger
            sevicedisAmt += parseFloat($(this).parent().find('#sevicedisAmt').val());
        })
        $("#DiscountAmount").val(sevicedisAmt);
        debugger
        DiscountAmt();
        //  DiscountAmount();
        //var disc = $('#disc_amount').val();
        //var tot = $("#gross_total").val();
        //$('#disc_amount_id').val(disc);
        //var discperc = (parseFloat(disc) / (parseFloat(tot) / 100));
        //$('#discount').val(discperc.toFixed(2));
        //$('#disc_perc_id').val(discperc.toFixed(2));
        //var net = parseInt(tot) - parseInt(disc);
        //$("#netpayable").val(net);
        //$("#netpayable_id").val(net);

        Calculate();
        // $(".form-control").val().toFixed(2);
    }


    $(document).ready(function () {
        Restore();
        $("form").submit(function () {
            debugger
            var tbl = $('#example tbody tr').length;

            var row = $("#example td").closest("tr").length;
            if (row == 0) {
                alert("Select Proper ServiceRow");
                return false;
            }
        })
    })

    $(document).on('click', '#example tr', function () {


        var isChecked = $(this).find('input[type=checkbox]:checked').val();
        if (isChecked != null) {
            $(this).find('input[name=samplecollection1]').val('1');
            var valvar = $(this).find('input[name=samplecollection1]').val();

        }
        else {
            $(this).find('input[name=samplecollection1]').val('0');
            var valvar = $(this).find('input[name=samplecollection1]').val();

        }

    });

    function Restore() {
        $("#PatientRegNo").val("");
        $("#Address").text("");
        $("#Address").val("");
        $("#OPDIPDNo").val("");
        $("#PatientName").val("");
        $("#GuardianName").val("");

        $("#MobileNo").val("");
        $("#Year").val("");
        $("#RefferedDoctor").val("");
        $("#ConsultantDoctor").val("");
        $("#WardName").val("");
        $("#RoomNo").val("");
        $("#BedNo").val("");
        $("#GrossTotal").val("0.00");
        $("#TaxAmt").val("0.00");
        $("#Discount").val("0.00");
        $("#NetPay").val("0.00");
        $("#ServiceTax").val("0.00");
        $("#PreBalance").val("0.00");
        $("#DiscountAmount").val("0.00");
        $("#AmtPaid").val("0.00");
        $("#TotalAmt").val("0.00");

        $("#BalAmt").val("0.00");



    }



    function Calculate() {
        debugger

        var tot2 = 0;
        var GrossTotal = $("#GrossTotal").val();
        var show = $("#ServiceTax").val();
        var TaxAmount = 0.00;
      
        if (show > 0) {
            TaxAmount = parseFloat(GrossTotal) * parseFloat(show / 100);
        }
        $("#TaxAmt").val(TaxAmount.toFixed(2));
        var TotalAmount = parseFloat(GrossTotal) + parseFloat(TaxAmount);
        var Prebalance = $("#PreBalance").val();

        if ($("#priBalanceDeposit").text() == "Pre.Balance") {

            TotalAmount = parseFloat(TotalAmount) + parseFloat(Prebalance);
        }
        else {
            TotalAmount = parseFloat(TotalAmount) - parseFloat(Prebalance);
        }

        $("#TotalAmt").val(TotalAmount.toFixed(2));
        var TAmt = $("#TotalAmt").val();
        var DAmt = $("#DiscountAmount").val();
        if (DAmt == '') {
            DAmt = "0";
            $("#Discount").val('');
        }
        var NetAmountPayable = (parseFloat(TAmt) - parseFloat(DAmt));
        $("#NetPay").val(NetAmountPayable.toFixed(2));
        var NetPayAmt = NetAmountPayable;

        var PaidAmount = $("#AmtPaid").val();
        var BalAmount = (NetPayAmt - PaidAmount);
        $("#BalAmt").val(BalAmount.toFixed(2));

    };

    function DiscountAmt() {
        var DiscountAmt = $("#DiscountAmount").val();

        var GrossTotal = $("#GrossTotal").val();
        var DiscountPer = ((DiscountAmt * 100) / (GrossTotal));
        $("#Discount").val(DiscountPer.toFixed(2));
    };



    function DiscountPer() {
        var GrossTotal = $("#GrossTotal").val();
        debugger;
        var DiscountAmt = $("#Discount").val();
        var DiscountPer = ((GrossTotal * DiscountAmt) / 100);
        $("#DiscountAmount").val(DiscountPer);
    };



    $(document).ready(function () {
        Restore();
        $("form").submit(function () {
            debugger
            var tbl = $('#example tbody tr').length;

            var row = $("#example td").closest("tr").length;
            if (row == 0) {
                alert("Select Proper ServiceRow");
                return false;
            }
        })
    })


    </script>
<script>
    $(document).ready(function () {
        $("#CompanyName").autocomplete({

            source:function(request,response){
                $.ajax({

                    url: '@Url.Action("CompanyNameBind", "PatientLabBills")',
                    type: "GET",
                    dataType: "Json",

                    data: { prefix: request.term },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item.OrganizationName, value: item.OrganizationName, id: item.OrganizationID };
                        }));
                    },



                });
            },

            minLength: 1,
            change: function (event, ui) {
                if (!ui.item) {
                    this.value = '';

                }
                $("#CompanyID").val(ui.item.id);
           
               
            }

        });
       
    })
  
    $(document).ready(function () {
        $("#CollectionCentre").autocomplete({

            source:function(request,response){
                $.ajax({

                    url: '@Url.Action("CollectionCentre", "PatientLabBills")',
                    type: "GET",
                    dataType: "Json",

                    data: { prefix: request.term },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item.CollectionCentreName, value: item.CollectionCentreName, id: item.CollectionCentreID };
                        }));
                    },



                });
            },

            minLength: 1,
            change: function (event, ui) {
                if (!ui.item) {
                    this.value = '';

                }
                $("#CollectionCentreID").val(ui.item.id);
            }

        });

    })

    $(document).ready(function(){
       
        $(function () {
          
                 $("#DateOFBirth").date({
                     //changeMonth: true,
                     //changeYear: true,
                     ////showAnim: 'slideDown',
                     dateFormat: 'dd-mm-yyyy'
                 }).on('change', function () {
                     var age = getAge(this);
                     /* $('#age').val(age);*/
                    console.log(age);
                    // alert(age);

                 });
          $("#DateOFBirth").datepicker();

        function getAge(dateVal) {
            debugger;
            var
                birthday = new Date(dateVal.value),
                today = new Date(),
                ageInMilliseconds = new Date(today - birthday),
                years = ageInMilliseconds / (24 * 60 * 60 * 1000 * 365.25),
                months = 12 * (years % 1),
                days = Math.floor(30 * (months % 1));
            // alert(days);
            $("#Day").val(days);
            $("#Month").val(Math.floor(months));
            $("#Year").val(Math.round(years));
            return Math.floor(years) + ' years ' + Math.floor(months) + ' months ' + days + ' days';

        }
        });

    })
   
   
  
    $(document).ready(function () {
        debugger
        $.ajax({
            type: "POST",

            url: '@Url.Action("ShowPatient", "PatientLabBills")',

                   dataType: "json",
                   success: function (data) {
                       debugger
                       for (var i = 0; i < data.length; i++) {

                           var SrNo = i+1;
                           $("#Data1").append('<tr><td ><a href="@Url.Action("PatientWiseResultEntry", "PatientWiseResultEntry")">Result</a></td><td>' + data[i].PatientName + '</td><td>' + data[i].BillNo + '</td><td >' + data[i].BillDate + '</td><td>' + data[i].PatientRegNo + '</td><td>' + data[i].Address + '</td><td>' + data[i].LabNo + '</td></tr>');
                       };
                   },
                   error: function (result) {
                       alert("Error grd bind");
                   }
               });
           });
  


    $(document).ready(function () {

        $("#patientdataclose").hide();
        $("#Data1").delegate('td', 'click', function () {
            debugger
            //  alert("hjk");
            var row_num = parseInt($(this).parent().index());
            //var SrNo = document.getElementById("example3").tBodies[0].rows[row_num].cells[0].innerHTML;
            var PatientRegNo = document.getElementById("Data1").tBodies[0].rows[row_num].cells[4].innerHTML;
            $("#PatientRegNo").val(PatientRegNo);
            $.ajax({
                url: '@Url.Action("FillRegDetails", "PatientLabBills")',
                type: "POST",
                datatype: "Json",
                data: { RegNo: $("#PatientRegNo").val() },
                success: function (data) {
                    debugger
                    var s = data[0].ReferredByDoctorID;
                    $("#PatientName").val(data[0].PatientName);
                    $("#PFPatientName").val(data[0].PrefixName);

                    //$(".PFPatientName").append($("<option/>").val(this.PrefixName).text(this.PrefixName));

                    $("#RefferedDoctor").val(data[0].ReffDoctorName);

                    $("#ConsultantDoctor").val(data[0].DoctorPrintName);

                    $("#ConsultantDoctorID1").val(data[0].ConsultantDrID);
                    $("#RefferedDoctorID").val(data[0].ReferredByDoctorID);
                    $("#Year").val(data[0].Age);
                    $("#DateOFBirth").val(data[0].DateOfBirth);
                    $("#PatientRegNo").val(data[0].PatientRegNo);
                    $("#GuardianName").val(data[0].GuardianName);
                    // alert($("#PrivilegeCard").val());
                    if ($("#PrivilegeCard").val() == "on" && data[0].PrivilegeCard != null) {

                        $("#PrivilegeCard").hide();
                        $("#spanPrivilege").hide();
                        $("#PrivilegeCardName").show();
                        $("#PrivilegeCardName").val(data[0].PrivilegeCard);

                    }
                    else {
                        $("#PrivilegeCard").show();
                        $("#spanPrivilege").show();
                        $("#PrivilegeCardName").hide();

                    }
                    //if ($("#PrivilegeCard").val(data[0].PrivilegeCard))
                    //{
                    //    $("#PrivilegeCard").val(checked);
                    //}

                    // $("").val(data[0].DateOfBirth);
                    $("#PatientType").text(data[0].PatientType);
                    $("#PatientType1").val(data[0].PatientType);
                    $("#CompanyName").val(data[0].OrganizationName);
                    $("#MobileNo").val(data[0].MobileNo);
                    $("#Address").val(data[0].Address);
                    $("#Gender").val(data[0].Gender);
                    //  alert(data[0].Gender);
                    $("#WardName").val(data[0].WardID);
                    $("#RoomNo").val(data[0].RoomID);
                    $("#BedNo").val(data[0].BedID);
                    $("#FinancialYearID").val(data[0].FinancialYearID);

                    // $("#FinancialYear").val(data[0].FinancialYear);
                    //alert(data[0].FinancialYear);
                    if ($("#PatientType1").val() == "IPD") {
                        $("#OPDIPDNo").val(data[0].PatientIPDNO);
                    }
                    else {
                        $("#OPDIPDNo").val(data[0].PatientOPDNO);
                    }

                    debugger

                    PreBalanceAmount = $("#PreBalance").val(data[0].PreBalanceAmount);
                    if (parseFloat(data[0].PreBalanceAmount) < 0) {
                        //alert("Deposit");

                        $("#priBalanceDeposit").text("Deposit")

                        $("#priBalanceDeposit").css("color", "blue");

                        var repalce1 = data[0].PreBalance;

                        var pre_balance = $("#PreBalance").val().replace("-", "");
                        $("#PreBalance").val(pre_balance)

                        $("#Deposit").val(repalce1);
                        // $("#pre_balance").attr('value', Deposit);
                    }
                    else {
                        $("#priBalanceDeposit").text("Pre.Balance");
                        $("#priBalanceDeposit").css("color", "black");
                        $("#Deposit").val("0.00")
                    }
                    $("#PatientNameID").val(data[0].PatientName);
                   // $("#OldBillNo").text('');
                }
            });

            $.ajax({
                url: '@Url.Action("OLDBILLBind", "PatientLabBills")',
                type: "POST",
                datatype: "Json",
                data: { RegNo: $("#PatientRegNo").val() },
                success: function (data) {
                  //  $("#OldBillNo").text("").val();
                    for (var a = 0; a < data.length; a++) {
                        //  alert(data[0].OLDBill);
                        $("#OldBillNo").append('<option value=' + data[a].BillNo + '>' + data[a].OLDBill + '</option>');
                        $("#btndelete").prop('disabled', false);
                    }
                }
            });

            $("#OldBillNo").change(function () {
                $("#example").closest('tr').remove();
                debugger
                $.ajax({
                    url: '@Url.Action("FillOldBillDetails", "PatientLabBills")',
                    type: "POST",
                    datatype: "Json",
                    data: { BillNo: $("#OldBillNo").val() },
                    success: function (data) {
                        debugger
                        $("#billno").val($("#OldBillNo").val());
                        $("#GrossTotal").val(data[0].GrossAmount);
                        // $("#service_tax").val(data[0]);
                        $("#service_tax").val(data[0].TaxPercent);
                        $("#TaxAmt").val(data[0].TaxAmount);
                        $("#PreBalance").val(data[0].PreBalanceAmount);

                        if ($("#PreBalance").val() == "") {
                            $("#PreBalance").val(0.00);
                        }
                        $("#DiscountAmount").val(data[0].Discount);

                        if ($("#DiscountAmount").val() == "") {
                            $("#DiscountAmount").val(0.00);
                        }
                        debugger;
                        $("#SampleCollectionID").val(data[0].SampleCollectionBoyID).toString();
                      
                        $.ajax({
                            url: '@Url.Action("sample", "PatientLabBills")',
                            type: "POST",
                            datatype: "Json",
                            data: { id: $("#SampleCollectionID").val() },
                            success: function (data) {



                                    $("#SampleCollection").val(data[0].FullName);


                            }
                        });
                        $("#CompanyName").val(data[0].OrganizationName).toString();
                        $("#CollectionCentre").val(data[0].CollectionCentreName).toString();
                        $("#BillDate").val(data[0].BillDate).toString("dd-MM-yyyy");
                        $("#Time").val(data[0].BillDatetime).toString("hh:mm:ss");
                        $("#Discount").val(data[0].DiscountPer);
                        $("#TotalAmt").val(data[0].TotalAmount);
                        $("#AmtPaid").val(data[0].PaidAmount);
                        $("#NetPay").val(data[0].NetAmountPayable);
                        $("#DiscReason").val(data[0].DiscountReason);
                        $("#BalAmt").val(data[0].BalanceAmount);

                        if (data[0].PaymentType != "Cash") {
                            $("#Number").val(data[0].Number);
                            $("#Name").val(data[0].Name);
                            $("#paymentDate").val(data[0].PaymentDate);
                            //   alert(data[0].PaymentDate);
                            $("#Remarks").val(data[0].Remark);
                        }
                        debugger;
                        document.getElementById("PaymentType").value = data[0].PaymentType;
                        debugger;
                        switch (data[0].PaymentType) {

                            case 'Cheque':
                                $("#DoctorSaveDivs").show(300);
                                $("#PaymentNo1").text("Cheque No");


                                $("#paymentName1").text("Bank Name");

                                $("#paymentDate1").text("Cheque Date");

                                $("#paymentRemark1").text("Remark");


                                break;


                            case 'Debit Card':
                                $("#DoctorSaveDivs").show(300);
                                $("#PaymentNo1").text("Debit Card No");


                                $("#paymentName1").text("Holder Name");

                                $("#paymentDate1").text("Valid UPTO");

                                $("#paymentRemark1").text("Remark");
                                // document.getElementById("payment_type").selectedIndex = 3;
                                break;



                            case 'Credit Card':
                                $("#DoctorSaveDivs").show(300);
                                $("#PaymentNo1").text("Credit Card No");
                                $("#paymentName1").text("Holder Name");
                                $("#paymentDate1").text("Valid UPTO");
                                $("#paymentRemark1").text("Remark");
                                //  document.getElementById("payment_type").selectedIndex = 2;
                                break;

                            case 'E-Money':
                                $("#DoctorSaveDivs").show(300);
                                $("#PaymentNo1").text("Code");
                                $("#paymentName1").text("Bank Name");
                                $("#paymentDate1").text("Date");
                                $("#paymentRemark1").text("Remark");
                                // document.getElementById("payment_type").selectedIndex = 4;
                                break;

                            case 'EFT':
                                $("#DoctorSaveDivs").show(300);
                                $("#PaymentNo1").text("Code");
                                $("#paymentName1").text("Bank Name");
                                $("#paymentDate1").text("Date");
                                $("#paymentRemark1").text("Remark");
                                // document.getElementById("payment_type").selectedIndex = 5;
                                break;

                            case 'CASH':
                                document.getElementById("payment_type").selectedIndex = 0;
                                $("#DoctorSaveDivs").hide(300);
                                break;
                        }



                        debugger

                        $("#example td").remove();
                        for (var a = 0; a < data.length; a++) {
                            debugger
                           // var TotalAmt = parseFloat(data[a].Qty) * parseFloat(data[a].Rate)

                            if (data[a].samplecollection == "1") {
                                $("#example").append('<tr><td style="display:none"><input type="hidden" name="mode" value="Edit"><input type="hidden" id="samplecollection1" name="samplecollection1" value="' + data[a].samplecollection + '"><input type ="checkbox" id="samplecollection" name="samplecollection" checked="checked"></td><td><input type="hidden" value=' + data[a].TestID + ' name="TesttableID"><input type="hidden" value=' + data[a].TestName + ' name="TestNamerow">' + data[a].TestName + '</td><td><input type="text" class="form-control" name="rate1" value=' + data[a].Rate + ' ></td><td><input type="text" value=' + data[a].Qty + ' class="form-control" id="qty1" name="qty"></td><td><select name="DiscountServiceType" id="DiscountServiceType" class="nr form-control"> <option value="Rs">Rs</option><option value="Rs">Rs</option><option value="%">%</option></select></td><td><input value=' + data[a].Discount_Service + ' class="nr form-control" type="number" id="Discount_Service" name="Discount_Service"><input value="0" type="hidden" id="sevicedisAmt" name="sevicedisAmt"></td><td class="total">' + data[a].ServiceTotal + '</td><td><input type="hidden" name="ReportDate" value=' + (data[a].ReportingDate).toString("dd-MM-yyyy") + '>' + (data[a].ReportingDate).toString("dd-MM-yyyy") + '</td><td style="display:none" ><input type="hidden" id="outid1" name="outid1" value=' + data[a].OutSourceID + '></td><td><input type="text" class="out1" id="out1" name="out1" value=' + data[a].LabName + ' ></td><td style="display:none" ><input type="hidden" name="ServiceType" value=' + data[a].ServiceType + '></td><td><a href="#" style="color:red" aria-hidden="true" id="delrow" class="delrow"><span>Remove</span></a></td></tr>');
                            }
                            else {
                                $("#example").append('<tr><td style="display:none"><input type="hidden" name="mode" value="Edit"><input type="hidden" id="samplecollection1" name="samplecollection1" value="' + data[a].samplecollection + '"><input type ="checkbox" id="samplecollection" name="samplecollection"></td><td><input type="hidden" value=' + data[a].TestID + ' name="TesttableID"><input type="hidden" value=' + data[a].TestName + ' name="TestNamerow">' + data[a].TestName + '</td><td><input type="text" class="form-control" name="rate1" value=' + data[a].Rate + ' ></td><td><input type="text" value=' + data[a].Qty + ' class="form-control" id="qty1" name="qty"></td><td><select name="DiscountServiceType" id="DiscountServiceType" class="nr form-control"> <option value="Rs">Rs</option><option value="Rs">Rs</option><option value="%">%</option></select></td><td><input value=' + data[a].Discount_Service + ' class="nr form-control" type="number" id="Discount_Service" name="Discount_Service"><input value="0" type="hidden" id="sevicedisAmt" name="sevicedisAmt"></td><td class="total">' + data[a].ServiceTotal + '</td><td><input type="hidden" name="ReportDate" value=' + (data[a].ReportingDate).toString("dd-MM-yyyy") + '>' + (data[a].ReportingDate).toString("dd-MM-yyyy") + '</td><td style="display:none" ><input type="hidden" id="outid1" name="outid1" value=' + data[a].OutSourceID + '></td><td><input type="text" class="out1" id="out1" name="out1" value=' + data[a].LabName + ' ></td><td style="display:none"><input type="hidden" name="ServiceType" value=' + data[a].ServiceType + '></td><td><a href="#" style="color:red"  aria-hidden="true" id="delrow" class="delrow"><span>Remove</span></a></td></tr>');

                            }
                        }
                        debugger

                        CaculateDescount();
                        $("#example").on('click', '#delrow1', function () {
                            debugger;
                            $(this).closest('tr').remove();
                            GrossAmt = 0;
                            var row = $("#example td").closest("tr").length;
                            for (var a = 0; a < row; a++) {
                                // if (document.getElementById('datatable-responsive').tBodies[0].rows[0].cells[4].innerHTML != "Total Amount"  && document.getElementById('datatable-responsive').tBodies[0].rows[0].cells[4].innerHTML !="" ) {
                                var newrow = a + 1;
                                GrossAmt = parseFloat(GrossAmt) + parseFloat(document.getElementById('example').tBodies[0].rows[newrow].cells[4].innerHTML);

                                // }
                            }
                            $("#GrossTotal").val(GrossAmt);
                         
                           
                            Calculate();
                        })
                    }
                });

            })

           
        });
    })
    </script>
<script>
    $(document).ready(function () {
        debugger
        $.ajax({
            url: '@Url.Action("BindPatientPrefix", "PatientLabBills")',
            type: "GET",
            dataType: "json",
            data: { prefix: "" },
            success: function (data) {
                $("#PFPatientName").val("");
                $("#PFPatientName").text("");
                debugger
                for (var i = 0 ; i < data.length; i++) {
                    debugger
                    $("#PFPatientName").append('<option value=' + data[i].PrefixName + '> ' + data[i].PrefixName + '</option>')

                }



            }

        })

    })
</script>
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script>
    $(document).ready(function () {

        $("#AppointmentTable").hide();

        $("#PAtientAppdetail").click(function () {
            debugger
            $("#AppointmentTable").show();
        });
        $("#AppPatient").autocomplete({

            source: function (request, response) {

                debugger
                $.ajax({
                    url: '@Url.Action("Fill", "PatientLabBills")',
                    type: "POST",
                    data: { prefix: request.term },
                    success: function (data) {
                       
                        response($.map(data, function (item) {
                            return { label: item.PatientLabName, value: item.PatientLabName, id: item.PatientLabAppointmentID };
                        }));
                    }
                });
            },

            minLength: 1,
            select: function (event, ui) {
                if (!ui.item) {
                    this.value = '';

                }
                debugger
                $("#AppointmentID").val(ui.item.id);
              
               $("#AppPatient").val(ui.item.value);
               $.ajax({
                    url: '@Url.Action("AppointDetails", "PatientLabBills")',
                    type: "POST",
                    datatype: "Json",
                    data: { appID: $("#AppointmentID").val() },
                    success: function (data) {
                        debugger
                        for (var a = 0; a < data.searchList.length; a++) {
                            alert($("#AppointmentID").val());
                            debugger
                            $("#PatientName").val(data.searchList[a].PatientName);
                            $("#RefferedDoctor").val(data.searchList[a].RefferedDr);
                            $("#PFPatientName").val(data.searchList[a].PrefixName);
                            $("#GuardianName").val(data.searchList[a].GuardianName);
                            $("#ConsultantDoctor").val(data.searchList[a].ConsultantDr);

                            $("#ConsultantDoctorID1").val(data.searchList[a].ConsultantDrID);
                            $("#RefferedDoctorID").val(data.searchList[a].ReferredByDoctorID);
                            $("#Year").val(data.searchList[a].Years);
                            $("#DateOFBirth").val(data.searchList[a].DateOfBirth);
                            $("#SampleCollection").val(data.searchList[a].SampleCollectionBy);
                            $("#MobileNo").val(data.searchList[a].MobileNo);
                            $("#Address").val(data.searchList[a].Address);
                            $("#Gender").val(data.searchList[a].Gender);

                        }
                        $("#example td").remove();
                        for (var b = 0; b < data.GetsearchList.length; b++) {
                            debugger
                            $("#CompanyName").val(data.GetsearchList[b].OrganizationName);
                            var outsource = "Self";
                            var ServiceType = "";
                            if (data.GetsearchList[b].ServiceType == "Test") {
                                var ServiceType = "LabBill";
                            }
                            else {
                                ServiceType = "ProfileBillTest";
                            }
                            $("#example").append('<tr><td style="display:none"><input type="hidden" name="mode" value="Edit"><input type="hidden" id="samplecollection1" name="samplecollection1" value="0"><input type ="checkbox" id="samplecollection" name="samplecollection" ></td><td><input type="hidden" value=' + data.GetsearchList[b].TestID + ' name="TesttableID"><input type="hidden" value=' + data.GetsearchList[b].TestName + ' name="TestNamerow">' + data.GetsearchList[b].TestName + '</td><td><input type="text" class="form-control" name="rate1" value=' + data.GetsearchList[b].Rate + ' ></td><td><input type="text" value=' + data.GetsearchList[b].Qty + ' class="form-control" id="qty1" name="qty"></td><td><select name="DiscountServiceType" id="DiscountServiceType" class="nr form-control"> <option value="Rs">Rs</option><option value="Rs">Rs</option><option value="%">%</option></select></td><td><input value="0.00" class="nr form-control" type="number" id="Discount_Service" name="Discount_Service"><input value="0" type="hidden" id="sevicedisAmt" name="sevicedisAmt"></td><td class="total">' + data.GetsearchList[b].TotalAmount + '</td><td><input type="hidden" name="ReportDate" value= @DateTime.Now.ToString("dd-MM-yyyy")> @DateTime.Now.ToString("dd-MM-yyyy")</td><td style="display:none" ><input type="hidden" id="outid1"  name="outid1" value="0"></td><td><input type="text" class="out1" id="out1" name="out1" value=' + outsource + ' ></td><td style="display:none" ><input type="hidden" name="ServiceType" value=' + ServiceType + '></td><td><a href="#" style="color:red"  aria-hidden="true" id="delrow" class="delrow"><span>Remove</span></a></td></tr>');


                        }
                        var row = $("#example td").closest("tr").length;
                        var GrossAmt = 0;
                        for (var a = 0; a < row; a++) {
                            debugger
                            GrossAmt = parseFloat(GrossAmt) + parseFloat(document.getElementById('example').tBodies[0].rows[a].cells[6].innerHTML);
                            $("#GrossTotal").val(GrossAmt);

                        }
                        Calculate();

                        $("#example").on('click', '#delrow1', function () {
                            debugger;
                            $(this).closest('tr').remove();
                            GrossAmt = 0;
                            var row = $("#example td").closest("tr").length;
                            for (var a = 0; a < row; a++) {
                                // if (document.getElementById('datatable-responsive').tBodies[0].rows[0].cells[4].innerHTML != "Total Amount"  && document.getElementById('datatable-responsive').tBodies[0].rows[0].cells[4].innerHTML !="" ) {
                                var newrow = a + 1;
                                GrossAmt = parseFloat(GrossAmt) + parseFloat(document.getElementById('example').tBodies[0].rows[newrow].cells[4].innerHTML);

                                // }
                            }
                            $("#GrossTotal").val(GrossAmt);
                            Calculate();
                        })
                    }
                });
               //// $("#AppPatient").val(ui.item.value);
               // alert($("#AppPatient").val());
            }

        });

               
        $("#AppointmentID").change(function () {

              $("#AppointmentTable").hide();
                debugger
                $.ajax({
                    url: '@Url.Action("AppointDetails", "PatientLabBills")',
                    type: "POST",
                    datatype: "Json",
                    data: { appID: $("#AppointmentID").val() },
                    success: function (data) {
                        debugger
                        for (var a = 0; a < data.searchList.length; a++) {
                            debugger
                            $("#PatientName").val(data.searchList[a].PatientName);
                            $("#AppPatient").val(data.searchList[a].PatientName);
                            $("#RefferedDoctor").val(data.searchList[a].RefferedDr);
                            $("#PFPatientName").val(data.searchList[a].PrefixName);
                            $("#GuardianName").val(data.searchList[a].GuardianName);
                            $("#ConsultantDoctor").val(data.searchList[a].ConsultantDr);

                            $("#ConsultantDoctorID1").val(data.searchList[a].ConsultantDrID);
                            $("#RefferedDoctorID").val(data.searchList[a].ReferredByDoctorID);
                            $("#Year").val(data.searchList[a].Years);
                            $("#DateOFBirth").val(data.searchList[a].DateOfBirth);
                            $("#SampleCollection").val(data.searchList[a].SampleCollectionBy);
                            $("#MobileNo").val(data.searchList[a].MobileNo);
                            $("#Address").val(data.searchList[a].Address);
                            $("#Gender").val(data.searchList[a].Gender);
                            
                        }
                        $("#example td").remove();
                        for (var b = 0; b < data.GetsearchList.length; b++) {
                            debugger
                            $("#CompanyName").val(data.GetsearchList[b].OrganizationName);
                            var outsource = "Self";
                            var ServiceType="";
                            if (data.GetsearchList[b].ServiceType == "Test")
                            {
                                var ServiceType = "LabBill";
                            }
                            else
                            {
                                ServiceType = "ProfileBillTest";
                            }
                            $("#example").append('<tr><td style="display:none"><input type="hidden" name="mode" value="Edit"><input type="hidden" id="samplecollection1" name="samplecollection1" value="0"><input type ="checkbox" id="samplecollection" name="samplecollection" ></td><td><input type="hidden" value=' + data.GetsearchList[b].TestID + ' name="TesttableID"><input type="hidden" value=' + data.GetsearchList[b].TestName + ' name="TestNamerow">' + data.GetsearchList[b].TestName + '</td><td><input type="text" class="form-control" name="rate1" value=' + data.GetsearchList[b].Rate + ' ></td><td><input type="text" value=' + data.GetsearchList[b].Qty + ' class="form-control" id="qty1" name="qty"></td><td><select name="DiscountServiceType" id="DiscountServiceType" class="nr form-control"> <option value="Rs">Rs</option><option value="Rs">Rs</option><option value="%">%</option></select></td><td><input value="0.00" class="nr form-control" type="number" id="Discount_Service" name="Discount_Service"><input value="0" type="hidden" id="sevicedisAmt" name="sevicedisAmt"></td><td class="total">' + data.GetsearchList[b].TotalAmount + '</td><td><input type="hidden" name="ReportDate" value= @DateTime.Now.ToString("dd-MM-yyyy")> @DateTime.Now.ToString("dd-MM-yyyy")</td><td style="display:none" ><input type="hidden" id="outid1"  name="outid1" value="0"></td><td><input type="text" class="out1" id="out1" name="out1" value=' + outsource + ' ></td><td style="display:none" ><input type="hidden" name="ServiceType" value=' + ServiceType + '></td><td><a href="#" style="color:red"  aria-hidden="true" id="delrow" class="delrow"><span>Remove</span></a></td></tr>');
                        

                        }
                        var row = $("#example td").closest("tr").length;
                        var GrossAmt = 0;
                        for (var a = 0; a < row; a++) {
                            debugger
                            GrossAmt = parseFloat(GrossAmt) + parseFloat(document.getElementById('example').tBodies[0].rows[a].cells[6].innerHTML);
                            $("#GrossTotal").val(GrossAmt);

                        }
                        Calculate();

                        $("#example").on('click', '#delrow1', function () {
                            debugger;
                            $(this).closest('tr').remove();
                            GrossAmt = 0;
                            var row = $("#example td").closest("tr").length;
                            for (var a = 0; a < row; a++) {
                                // if (document.getElementById('datatable-responsive').tBodies[0].rows[0].cells[4].innerHTML != "Total Amount"  && document.getElementById('datatable-responsive').tBodies[0].rows[0].cells[4].innerHTML !="" ) {
                                var newrow = a + 1;
                                GrossAmt = parseFloat(GrossAmt) + parseFloat(document.getElementById('example').tBodies[0].rows[newrow].cells[4].innerHTML);

                                // }
                            }
                            $("#GrossTotal").val(GrossAmt);
                            Calculate();
                        })
                    }
                });
          
        })
        $("#AddAppointment").click(function () {
            $("#AppointmentTable").hide();
        });
        $("#FORMSUBMIT").submit(function () {
   debugger
            var show = $("#DiscReason").val();
            var show1 = $("#Discount").val();
            if (show1 > 0) {
                if (show == 0) {
                    alert("Select Proper Discount Reason");
                    $("#Discount").val('');
                    $("#DiscReason").focus();
                    return false;
                }
            }
        })

        $("#PatientName").on("keyup", function () {
            debugger
            var value = $(this).val().toLowerCase();
            $("#patientNameTable tbody tr").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });

        $.ajax({
            url: '@Url.Action("GetAllPatient", "PatientLabBills")',
            contentType: "application/json; charset=utf-8",
            type: "GET",
            dataType: "json",
            data: { prefix: "%" },
            success: function (result) {
                debugger
                $.each(result, function (i, obj) {
                    $("#patientNameTable").append('<tr><td>' + obj.PrintRegNO + '</td><td style="display:none">' + obj.patientregNo + '</td><td>' + obj.patientname + '</td><td>' + obj.address + '</td><td>' + obj.contactno + '</td></tr>')

                });
                debugger
            }
        });

        $("#PatientName").click(function () {
            debugger
            $('#patientNameTable').slideDown();
            $("#patientdataclose").show();
        })

        $("#patientNameTable").delegate('td', 'click', function () {
            debugger;
            $("#patientdataclose").hide();
            var row = $(this).parent().index();
            var Print = document.getElementById('patientNameTable').tBodies[0].rows[row].cells[0].innerHTML;
            $("#PatientRegNoprint").val(Print);
            $("#PatientRegNoprint").change();
            $('#patientNameTable').slideUp();

        });


        $("#patientdataclose").click(function () {
            $("#patientNameTable").hide();
            $("#patientdataclose").hide();
        })
    })
</script>
<!-- ico font -->
@*</head>*@

<script type="text/javascript">
    $(function () {
        var d = new Date(),
            h = d.getHours(),
            m = d.getMinutes();
        if (h < 10) h = '0' + h;
        if (m < 10) m = '0' + m;
        $('input[type="time"][value="now"]').each(function () {
            $(this).attr({ 'value': h + ':' + m });

        });
    });
</script>
<body class="hold-transition skin-blue sidebar-mini">
    <div class="wrapper">
        <form action="" id="FORMSUBMIT" method="post">
            <div class="content-wrapper">
                <section class="content-header">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-sm-6">
                                <h1>Patient Lab Bills</h1>
                            </div>
                            <div class="col-sm-6">
                                <ol class="breadcrumb float-sm-right">
                                    <li class="breadcrumb-item"><a href="@Url.Action("Dashboard","Home")">Home</a></li>
                                    <li class="breadcrumb-item active">Patient Lab Bills</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="content">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                <div class="card card-primary panel-primary">
                                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 padding0" style="background: #bddff7;">
                                        <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                            <h2 class="panelheading">Patient Information</h2>
                                        </div>
                                        <div class="form-group col-lg-6 col-md-6 col-sm-12 col-xs-12 ">
                                            @*<input type="checkbox" id="OutsidePatient" name="OutsidePatient" hidden>Outside patient*@
                                            @*<button type="button" class="btndivcss" id="PAtientAppdetail" name="PAtientAppdetail" style="height: 26px;width:170px">Appoinment Patient</button>*@
                                        </div>
                                    </div>
                                    <div class="card-body pane-body">
                                        <div class="row">
                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 padding0">
                                                <!--UHID Number-->
                                                <div class="form-group col-lg-4 col-md-12 col-sm-12 col-xs-12 padding0">
                                                    <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
                                                        <label>UHID No.</label>
                                                    </div>
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12 cpb-10">
                                                        <input type="hidden" id="FinancialYearID" name="FinancialYearID">
                                                        @* <input type="text" class="form-control" id="FinancialYear" name="FinancialYear" disabled>*@
                                                        <select id="FinancialYear" name="FinancialYear" class="form-control" disabled></select>
                                                        @*  <select class="form-control" disabled></select>*@
                                                    </div>
                                                    <div class="col-lg-5 col-md-5 col-sm-12 col-xs-12">
                                                        <input type="number" id="PatientRegNo" name="PatientRegNo" class="hide form-control">
                                                        <input type="number" id="PatientRegNoprint" name="PatientRegNoprint" class="form-control">
                                                    </div>
                                                </div>
                                                <!--OPD/IPD Number-->
                                                <div class="form-group col-lg-4 col-md-12 col-sm-12 col-xs-12 padding0">
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <label>OPD/IPD No.</label>
                                                    </div>
                                                    <div class="col-lg-4 col-md-8 col-sm-12 col-xs-12">
                                                        <input type="number" id="OPDIPDNo" name="OPDIPDNo" class="form-control input-sm"/>
                                                        <div class="suggestions" id="OPDIPDbind">
                                                           
                                                            <table id="tblpatient" class="table table-bordered hover display table-hover" role="grid" style="width: 100%">
                                                                <thead style="background-color: #bddff7;">
                                                                    <tr>
                                                                        <th>Patient Name</th>
                                                                        <th>Reg No</th>
                                                                        <th>PatientType</th>
                                                                        
                                                                    </tr>
                                                                </thead>
                                                                <tbody class="tblpatientbody"></tbody>
                                                            </table>
                                                            

                                                        </div>
                                                        @*<td>
                                                                <input type="text" id="OPDIPDNo" name="OPDIPDNo" class="form-control input-sm" disabled />
                                                            </td>*@
                                                    </div>

                                                    <div class="col-lg-4 col-md-8 col-sm-12 col-xs-12">
                                                        <input type="number" id="OPDIPDNoprint" name="OPDIPDNoprint" class="form-control input-sm" />
                                                        
                                                        @*<td>
                <input type="text" id="OPDIPDNo" name="OPDIPDNo" class="form-control input-sm" disabled />
            </td>*@
                                                    </div>

                                                </div>
                                                <!--Patinet Type-->
                                                <div class="form-group col-lg-4 col-md-12 col-sm-12 col-xs-12 padding0">
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <label>Patinet Type</label>
                                                    </div>
                                                    <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12 cpb-10">
                                                        <label class="lbl" id="PatientType">OPD</label>
                                                        <input type="hidden" value="OPD" name="PatientType1" id="PatientType1">
                                                        @* <select class="form-control input-sm" id="PatientType" name="PatientType"> </select>*@
                                                    </div>
                                                    <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 cpb-10">
                                                        <span>Old Bill No.</span>
                                                    </div>
                                                    <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
                                                        <select id="OldBillNo" name="OldBillNo" class="form-control input-sm">
                                                            <option value="--New--">--New--</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 padding0">
                                                <!--Patient Name-->
                                                <div class="form-group col-lg-4 col-md-12 col-sm-12 col-xs-12 padding0">
                                                    <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
                                                        <label>Pt. Name</label>
                                                    </div>
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12 cpb-10">
                                                        <select class="form-control" id="PFPatientName" name="PFPatientName">
                                                            <option id="Select" value="Select">Select</option>
                                                        </select>
                                                    </div>
                                                    <div class="col-lg-5 col-md-5 col-sm-12 col-xs-12">
                                                        <input type="text" id="PatientName" name="PatientName" class="form-control">
                                                        <div class="patientTableDiv table-responsive" style="position: absolute;z-index: 100;max-height: 250px;overflow: scroll;background-color: #ffffff;border: 0;box-shadow: 10px 10px 10px -6px #797979;">
                                                            <button type="button" id="patientdataclose" name="patientdataclose" value="X" class="">X</button>
                                                             <table id="patientNameTable" class="table table-bordered display table-hover table-head-fixed" style="width: 100%; display:none;">
                                                                <thead>
                                                                    <tr>
                                                                        <th style="background-color: #bddff7;">UHID No.</th>
                                                                        <th style="display:none">Print Reg No.</th>
                                                                        <th style="background-color: #bddff7;">Pt.Name</th>
                                                                        <th style="background-color: #bddff7;">Address</th>
                                                                        <th style="background-color: #bddff7;">Mobile No.</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>

                                                        <div id="tblbind" class="suggestions">
                                                            @*<table class="table table-condensed table-striped suggest-grid  table table-bordered table-striped">
                                                                 <thead>
                                                                     <tr><th>Patient Name</th>
                                                                         <th>Reg No</th></tr>
                                                                 </thead>
                                                                       <tbody id="tblpatient1">
                                                                    </tbody>
                                                                </table>*@
                                                        </div>
                                                    </div>
                                                </div>
                                                <!--Guardian Name-->
                                                <div class="form-group col-lg-4 col-md-12 col-sm-12 col-xs-12 padding0">
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <label>Gdn. Name</label>
                                                    </div>
                                                    <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                        <input type="text" id="GuardianName" name="GuardianName" class="form-control" readonly>
                                                    </div>
                                                </div>
                                                <!--Bill Date-->
                                                <div class="form-group col-lg-4 col-md-12 col-sm-12 col-xs-12 padding0">
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <label>Bill D/T</label>
                                                    </div>
                                                    <div class="col-lg-5 col-md-5 col-sm-12 col-xs-12 cpb-10">
                                                        <input type="date" id="BillDate" name="BillDate" value="@DateTime.Now.ToString("yyyy-MM-dd")" max="9999-12-31" class="form-control">
                                                    </div>
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        @*<input type="datetime" id="Time" name="Time" value="@DateTime.Now.ToString("hh:mm:ss")" class="form-control">*@

                                                        <input type="time" id="Time" name="Time" value="now" class="form-control">

                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 padding0">
                                                <!--Age-->
                                                <div class="form-group col-lg-4 col-md-12 col-sm-12 col-xs-12 padding0">
                                                    <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
                                                        <label>Age</label>
                                                    </div>
                                                    <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
                                                        <div class="input-group">
                                                            <div class="input-group-addon padding0">
                                                                <span>Y</span>
                                                            </div>
                                                            <input type="number" id="Year" name="Year" class="form-control" placeholder="Year" readonly />
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 cpb-10">
                                                        <div class="input-group">
                                                            <div class="input-group-addon">
                                                                <span>M</span>
                                                            </div>
                                                            <input type="number" id="Month" name="Month" class="form-control" placeholder="Month" readonly />
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 cpb-10">
                                                        <div class="input-group">
                                                            <div class="input-group-addon">
                                                                <span>D</span>
                                                            </div>
                                                            <input type="number" id="age_day" name="Day" class="form-control" placeholder="Day" readonly/>
                                                        </div>
                                                    </div>
                                                   
                                                   
                                                </div>
                                                <!--Gender and Date of Birth-->
                                                <div class="form-group col-lg-4 col-md-12 col-sm-12 col-xs-12 padding0">
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <label>Gender</label>
                                                    </div>
                                                    <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12 cpb-10 cpb-10" style="padding-right: 0;">
                                                        <select id="Gender" name="Gender" class="form-control" style="padding: 0;">
                                                            <option value="Male">Male</option>
                                                            <option value="Female">Female</option>
                                                        </select>
                                                    </div>
                                                    <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12">
                                                        <label>DOB.</label>
                                                    </div>
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12" style="padding-left: 0;">
                                                        <input type="date" id="DateOFBirth" name="DateOFBirth" value="@DateTime.Now.ToString("yyyy-MM-dd")" max="9999-12-31" class="form-control" style="font-size: 12px;">
                                                    </div>
                                                </div>
                                                <!--Mobile Number-->
                                                <div class="form-group col-lg-4 col-md-12 col-sm-12 col-xs-12 padding0">
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <label>Mobile No.</label>
                                                    </div>
                                                    <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                        <input type="number" id="MobileNo" name="MobileNo" maxlength="10" class="form-control" readonly
                                                               style="border-left-color: red;border-left-width: thick;"
                                                               oninvalid="this.setCustomValidity('Please Enter Mobile Number')"
                                                               oninput="this.setCustomValidity('')">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 padding0">
                                                <!--Address-->
                                                <div class="form-group col-lg-4 col-md-12 col-sm-12 col-xs-12 padding0">
                                                    <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
                                                        <label>Address</label>
                                                    </div>
                                                    <div class="col-lg-9 col-md-9 col-sm-12 col-xs-12">
                                                        <textarea id="Address" name="Address" class="form-control" readonly></textarea>
                                                    </div>
                                                </div>
                                                <!--Consultant Doctor-->
                                                <div class="form-group col-lg-4 col-md-12 col-sm-12 col-xs-12 padding0">
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <label>Cons. Dr.</label>
                                                    </div>
                                                    <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                        <input type="text" id="ConsultantDoctor" name="ConsultantDoctor" class="form-control" readonly>
                                                        <input type="hidden" id="ConsultantDoctorID1" name="ConsultantDoctorID1" class="form-control">
                                                    </div>
                                                </div>
                                                <!--Reffered By-->
                                                <div class="form-group col-lg-4 col-md-12 col-sm-12 col-xs-12 padding0">
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <label>Reffered By</label>
                                                    </div>
                                                    <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                        <input type="text" id="RefferedDoctor" name="RefferedBy" class="form-control" readonly>
                                                        <input type="hidden" id="RefferedDoctorID" name="RefferedDoctorID" class="form-control">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 padding0">
                                                <!--Ward Name-->
                                                <div class="form-group col-lg-4 col-md-12 col-sm-12 col-xs-12 padding0">
                                                    <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12" style="padding-right: 0;">
                                                        <label>Ward Name</label>
                                                    </div>
                                                    <div class="col-lg-9 col-md-9 col-sm-12 col-xs-12">
                                                        <input type="text" id="WardName" name="WardName" class="form-control" disabled />
                                                        <input type="hidden" id="WardID" name="WardID" class="form-control">
                                                    </div>
                                                </div>
                                                <!--Room Number-->
                                                <div class="form-group col-lg-4 col-md-12 col-sm-12 col-xs-12 padding0">
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <label>Room No.</label>
                                                    </div>
                                                    <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                        <input type="text" id="RoomNo" name="RoomNo" class="form-control" disabled />
                                                        <input type="hidden" id="RoomID" name="RoomID" class="form-control">
                                                    </div>
                                                </div>
                                                <!--Bed Number-->
                                                <div class="form-group col-lg-4 col-md-12 col-sm-12 col-xs-12 padding0">
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <label>Bed No.</label>
                                                    </div>
                                                    <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                        <input type="text" id="BedNo" name="BedNo" class="form-control" disabled />
                                                        <input type="hidden" id="BedID" name="BedID" class="form-control">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="card card-primary panel-primary">
                                    <h2 class="panelheading">Charge Based On</h2>
                                    <div class="card-body pane-body">
                                        <div class="row">
                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <!--General / Emergency and Privilege Card-->
                                                <div class="form-group col-lg-4 col-md-12 col-sm-12 col-xs-12">
                                                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 padding0">
                                                        <div class="form-check-inline">
                                                            <label class="form-check-label">
                                                                <input type="radio" class="form-check-input" id="General" name="RadioCharge" value="General" checked>General
                                                            </label>
                                                        </div>
                                                        <div class="form-check-inline">
                                                            <label class="form-check-label">
                                                                <input type="radio" class="form-check-input" id="Emergency" name="RadioCharge" value="Emergency">Emergency
                                                            </label>
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                        <input type="checkbox" id="PrivilegeCard" name="PrivilegeCard" disabled /> <label id="spanPrivilege"> Privilege Card</label>&nbsp;&nbsp;&nbsp;
                                                        <input type="text" id="PrivilegeCardName" name="PrivilegeCardName" style="display:none">
                                                    </div>
                                                </div>
                                                <!--TPA Wise-->
                                                <div class="form-group col-lg-4 col-md-12 col-sm-12 col-xs-12">
                                                    <div class="col-lg-5 col-md-5 col-sm-12 col-xs-12">
                                                        <label>TPA Name</label>
                                                    </div>
                                                    <div class="col-lg-7 col-md-7 col-sm-12 col-xs-12">
                                                        <input type="text" id="CompanyName" name="CompanyName" class="form-control" readonly>
                                                        <input type="hidden" id="CompanyID" name="CompanyID">
                                                    </div>
                                                </div>
                                                <!--Appointment ID-->
                                                <div class="form-group col-lg-4 col-md-12 col-sm-12 col-xs-12">
                                                    <div class="col-lg-5 col-md-5 col-sm-12 col-xs-12">
                                                        <label>Appt. ID</label>
                                                    </div>
                                                    <div class="col-md-7 col-sm-7 col-xs-12">
                                                        <input type="number" id="AppointmentID" name="AppointmentID" class="form-control">
                                                        @*// <input type="text" id="SampleCollection" name="SampleCollection" class="form-control">*@
                                                    </div>

                                                    <!-- Appointment Id Modal -->
                                                    <div class="modal" id="AppointmentTable">
                                                        <div class="modal-dialog">
                                                            <div class="modal-content">
                                                                <div class="modal-body">
                                                                    <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                        <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                                            <label>AppointmentID</label>
                                                                        </div>
                                                                        <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                                            <input type="text" id="AppointmentID" name="AppointmentID" class="form-control">
                                                                            @*// <input type="text" id="SampleCollection" name="SampleCollection" class="form-control">*@
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                        <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                                            <label>Patient Name</label>
                                                                        </div>
                                                                        <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                                            <input type="text" id="AppPatient" name="AppPatient" class="form-control">
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                        <button type="button" id="AddAppointment" name="AddAppointment" class="btn btndivcss" data-dismiss="modal">
                                                                            Add
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <!--Sample Collection Boy-->
                                                <div class="form-group col-lg-4 col-md-4 col-sm-12 col-xs-12 padding0">
                                                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                        <label>Sample Collection Boy</label>
                                                    </div>
                                                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                        <input type="hidden" id="SampleCollectionID" name="SampleCollectionID">
                                                        <input type="text" id="SampleCollection" name="SampleCollection" class="form-control">
                                                    </div>
                                                </div>
                                                @*<div class="item form-group">
                                                        <div class="control-label col-md-3 col-sm-3 col-xs-12">
                                                            <span class="required">Payment Collected By</span>
                                                        </div>
                                                        <div class="col-md-6 col-sm-6 col-xs-12">
                                                            <input type="text" class="form-control" id="PaymentType" name="BankName">
                                                        </div>
                                                    </div>*@
                                                @*<div class="col-lg-2">
                                                        <button type="button" id="ExtraInfo" name="ExtraInfo"  class="btndivcss" style="height: 26px;width:120px">Extra Info</button>
                                                    </div>*@
                                                <!--Collection Centre-->
                                                <div class="form-group col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <div class="col-lg-5 col-md-5 col-sm-12 col-xs-12">
                                                        <label>Collection Centre</label>
                                                    </div>
                                                    <div class="col-lg-7 col-md-7 col-sm-12 col-xs-12">
                                                        <input type="text" id="CollectionCentre" name="CollectionCentre" class="form-control">
                                                        <input type="hidden" id="CollectionCentreID" name="CollectionCentreID">
                                                    </div>
                                                </div>
                                                <!--Appointment Patient Name-->
                                                <div class="form-group col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <div class="col-lg-5 col-md-5 col-sm-12 col-xs-12">
                                                        <label>Appt. Pt. Name</label>
                                                    </div>
                                                    <div class="col-lg-7 col-md-7 col-sm-12 col-xs-12">
                                                        <input type="text" id="AppPatient" name="AppPatient" class="form-control">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-9 col-md-9 col-sm-12 col-xs-12">
                                <div class="card card-primary panel-primary">
                                    <h2 class="panelheading">Lab Info</h2>
                                    <div class="card-body pane-body">
                                        <div class="row">
                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <!--Test and Packages-->
                                                <div class="form-group col-lg-6 col-md-12 col-sm-12 col-xs-12 text-center">
                                                    <div class="form-check-inline">
                                                        <label class="form-check-label">
                                                            <input type="radio" class="form-check-input" id="RTest" name="Charge" value="Test" checked>Test
                                                        </label>
                                                    </div>
                                                    <div class="form-check-inline">
                                                        <label class="form-check-label">
                                                            <input type="radio" class="form-check-input" id="RPackage" name="Charge" value="Package">Package
                                                        </label>
                                                    </div>
                                                </div>
                                                <!--Test Name-->
                                                <div class="form-group col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <label>Test Name</label>
                                                    </div>
                                                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                        <input type="text" id="Test" name="Test" class="form-control">
                                                        <input type="hidden" id="TestID" name="TestID">
                                                    </div>
                                                    <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12">
                                                        <button type="button" onclick="window.location.href='@Url.Action("TestMaster", "TestMaster")'" class="btndivcss">
                                                            Add
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <!--Rate-->
                                                <div class="form-group col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                    <div class="col-lg-4 col-md-12 col-sm-12 col-xs-12">
                                                        <label>Rate</label>
                                                    </div>
                                                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                        <input type="number" id="rate" name="rate" value="0.00" class="form-control">
                                                    </div>
                                                    <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12">
                                                        <button type="button" onclick="window.location.href='@Url.Action("OutSourceLab", "OutSourceLab")'" class="btndivcss">
                                                            Add
                                                        </button>
                                                    </div>
                                                </div>
                                                <!--Out Source-->
                                                <div class="form-group col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                    <div class="col-lg-4 col-md-12 col-sm-12 col-xs-12">
                                                        <label>Out Src.</label>
                                                    </div>
                                                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                        <input type="text" id="OutSource" name="OutSource" class="form-control">
                                                        <input type="hidden" id="OutSourceID" name="OutSourceID">
                                                    </div>
                                                    <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12">
                                                        <button type="button" id="Add" name="Add" class="btndivcss">
                                                            Add
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <div class="table-responsive">
                                                    <table id="example" class="table table-bordered hover display table-hover" role="grid" style="width: 100%">
                                                        <thead style="background-color: #bddff7;">
                                                            <tr>
                                                               
                                                                <th>Service Name</th>
                                                                <th>Rate</th>
                                                                <th>Qty.</th>
                                                                <th>Discount Type</th>
                                                                <th>Discount Amount</th>
                                                                <th>Total Amount</th>
                                                                <th>Reporting Date</th>
                                                                <th>Lab Name</th>
                                                                <th>Action</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody></tbody>
                                                    </table>
                                                </div>
                                            </div>
                                            <input type="hidden" value="" name="txtinput" id="txtinput" />
                                            <input type="hidden" value="0" name="ForAuthorization" id="ForAuthorization" />

                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 table-responsive">
                                                <table id="Data1" class="table table-bordered hover display table-hover" role="grid" style="width: 100%">
                                                    <thead style="background-color: #bddff7;">
                                                        <tr>
                                                            <th>Result</th>
                                                            <th>Patient Name</th>
                                                            <th>Bill No</th>
                                                            <th>Bill Date</th>
                                                            <th>Patient Reg. No.</th>
                                                            <th>Address</th>
                                                            <th>Lab No.</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="scrollbar"></tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
                                <div class="card card-primary panel-primary">
                                    <h2 class="panelheading">Bills Details</h2>
                                    <div class="card-body panel-body">
                                        <!--Gross Total-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <label>Gross Total</label>
                                            </div>
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <input type="text" id="GrossTotal" name="GrossTotal" class="form-control" placeholder="0.00">
                                            </div>
                                        </div>
                                        <!--Service Tax %-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <label>Serv. Tax %</label>
                                            </div>
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <input type="text" id="ServiceTax" name="TaxPercent" class="form-control" placeholder="0.00">
                                            </div>
                                        </div>
                                        <!--Tax Amtount-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <label>Tax Amt.</label>
                                            </div>
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <input type="text" id="TaxAmt" name="TaxAmt" class="form-control" placeholder="0.00">
                                            </div>
                                        </div>
                                        <!--Pre Balance-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <a href="#" id="priBalanceDeposit">Pre. Bal.</a>
                                            </div>
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <input type="text" id="PreBalance" name="PreBalance" class="form-control" placeholder="0.00" disabled>
                                            </div>
                                        </div>
                                        <!--Total Amtount-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <label>Total Amt.</label>
                                            </div>
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <input type="text" id="TotalAmt" name="TotalAmt" class="form-control" placeholder="0.00">
                                            </div>
                                        </div>
                                        <!--Discount %-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <label>Disc. %</label>
                                            </div>
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <input type="text" value="0.00" id="Discount" name="Discount" class="form-control" placeholder="0.00">
                                            </div>
                                        </div>
                                        <!--Discount Amtount-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <label>Disc. Amt.</label>
                                            </div>
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <input type="text" id="DiscountAmount" name="DiscountAmount" class="form-control" placeholder="0.00">
                                            </div>
                                        </div>
                                        <!--Discount Reason-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <span style="font-weight: 700;">Disc. Reason</span>
                                            </div>
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <select id="DiscReason" name="DiscReason" class="form-control"></select>
                                                <input type="hidden" id="DiscReasonID" name="DiscReasonID">
                                            </div>
                                        </div>
                                        <!--Net Pay-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <label>Net Pay</label>
                                            </div>
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <input type="text" id="NetPay" name="NetPay" class="form-control" placeholder="0.00">
                                            </div>
                                        </div>
                                        <!--Amtount Paid-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <label>Amt. Paid</label>
                                            </div>
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <input type="text" id="AmtPaid" name="AmtPaid" class="form-control" placeholder="0.00">
                                            </div>
                                        </div>
                                        <!--Balance Amtount-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <label>Bal Amt.</label>
                                            </div>
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <input type="text" id="BalAmt" name="BalAmt" class="form-control" placeholder="0.00">
                                            </div>
                                        </div>
                                        <!--Pay Type-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <label>Pay Type</label>
                                            </div>
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <select id="PaymentType" name="PaymentType" class="form-control">
                                                    <option value="Cash">Cash</option>
                                                    <option value="Cheque">Cheque</option>
                                                    <option value="Credit Card">Credit Card</option>
                                                    <option value="Debit Card">Debit Card</option>
                                                    <option value="E-Money">E-Money</option>
                                                    <option value="EFT">EFT</option>
                                                </select>
                                            </div>

                                            <!-- Pay Type Modal -->
                                            <div class="modal" id="DoctorSaveDivs">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-body">
                                                            <div class="form-group col-lg-12 col-md124 col-sm-12 col-xs-12">
                                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                                    <label id="PaymentNo1">Cheque No</label>
                                                                </div>
                                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                                    <input type="number" class="form-control" id="Number" name="Number">
                                                                </div>
                                                            </div>
                                                            <div class="form-group col-lg-12 col-md124 col-sm-12 col-xs-12">
                                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                                    <label id="paymentName1">Bank Name</label>
                                                                </div>
                                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                                    <input type="text" class="form-control" id="Name" name="Name">
                                                                </div>
                                                            </div>
                                                            <div class="form-group col-lg-12 col-md124 col-sm-12 col-xs-12">
                                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                                    <label id="paymentDate1">Cheque Date</label>
                                                                </div>
                                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                                    <input type="date" id="paymentDate" name="paymentDate" value="@DateTime.Now.ToString("yyyy-MM-dd")" max="9999-12-31" class="form-control">
                                                                </div>
                                                            </div>
                                                            <div class="form-group col-lg-12 col-md124 col-sm-12 col-xs-12">
                                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                                    <label id="paymentRemark1">Remark</label>
                                                                </div>
                                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                                    <input type="text" class="form-control" id="Remarks" name="Remarks">
                                                                </div>
                                                            </div>
                                                            <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                <button type="button" id="close" name="close" class="btn btn-danger pull-right" data-dismiss="modal" style="font-size: 15px;">
                                                                    Close
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Extra Information Modal -->
                                        <div class="modal" id="ExtraInformation">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <!-- Modal body -->
                                                    <div class="modal-body">
                                                        <!-- Modal footer -->
                                                        <div class="modal-footer">
                                                            <button type="button" id="close1" name="close1" class="btn btndivcss" data-dismiss="modal"> Add </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-12" style="text-align: center;">
                            <div class="btn-group dropdown-split-warning">
                                <button type="submit" class="btn btn-app">
                                    <i class="fa fa-save"></i>Save
                                </button>
                            </div>
                            <div class="btn-group dropdown-split-warning">
                                <a class="btn btn-app" id="btndelete">
                                    <i class="fa fa-trash"></i>Delete
                                </a>
                            </div>
                            <div class="btn-group dropdown-split-warning">
                                <a class="btn btn-app" onclick="location.reload();">
                                    <i class="fa fa-refresh"></i>Clear
                                </a>
                            </div>
                            <div class="btn-group dropdown-split-warning">
                                <a class="btn btn-app" onclick="window.location.href='@Url.Action("Dashboard", "Home")'">
                                    <i class="fa fa-sign-out"></i>Exit
                                </a>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </form>
    </div>
</body>


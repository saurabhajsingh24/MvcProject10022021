@{
    ViewBag.Title = "Purchase Return";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<!--This file is Created by Mohammed-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<style>
    @@media only screen and (max-width: 425px) {
        .cpb-10 {
            padding-bottom: 10px;
        }
    }
</style>

@*<script type="text/javascript">
        $(document).ready(function () {
            $('#purchaseReturnTable').DataTable({
                "fixedHeader": true,
                "paging": true,
                "lengthChange": true,
                "searching": true,
                "ordering": true,
                "info": true,
                "autoWidth": true,
                "responsive": false,
            });
            var buttons = new $.fn.dataTable.Buttons($('#purchaseReturnTable').DataTable(), {
                buttons: [
                    {
                        extend: 'excel',
                        text: '<li class="fa fa-file-excel-o fa-lg" style="font-weight: 600;"></li><br>Excel'
                    }
                ]
            }).container().appendTo($('#purchaseReturnTableExcelExport'));
        });
    </script>*@

<body class="hold-transition skin-blue sidebar-mini">
    <div class="wrapper">
        <form action="" method="post">
            <div class="content-wrapper">
                <section class="content-header">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-sm-6">
                                <h1>Purchase Order</h1>
                            </div>
                            <div class="col-sm-6">
                                <ol class="breadcrumb float-sm-right">
                                    <li class="breadcrumb-item"><a href="@Url.Action("Dashboard","Home")">Home</a></li>
                                    <li class="breadcrumb-item"><a href="@Url.Action("Pharmacy","Application")">Pharmacy</a></li>
                                    <li class="breadcrumb-item active">Purchase Return</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="content">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-lg-4 col-md-12 col-sm-12 col-xs-12">
                                <div class="card card-primary panel-primary">
                                    <h2 class="panelheading">Supplier Information</h2>
                                    <div class="card-body pane-body">
                                        <div class="row">
                                            <!--Supplier Name-->
                                            <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <label>Supplier</label>
                                                </div>
                                                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                    <input type="text" id="supplierName" name="supplierName" class="form-control" required
                                                           style="border-left-color: red;border-left-width: thick;"
                                                           oninvalid="this.setCustomValidity('Please Enter Supplier Name')"
                                                           oninput="this.setCustomValidity('')">
                                                    <input type="hidden" name="SupplierID" id="SupplierID" />
                                                </div>
                                                <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12">
                                                    <button type="button" id="addSupplierName" name="addSupplierName" onclick="window.location.href='@Url.Action("ProductSupplier", "ProductSupplier")'" class="btndivcss" style="height: 25px;">
                                                        <span class="fa fa-plus"></span>
                                                    </button>
                                                </div>
                                            </div>
                                            <!--Address-->
                                            <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <label>Address</label>
                                                </div>
                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                    <textarea id="address" name="address" class="form-control"></textarea>
                                                </div>
                                            </div>
                                            <!--Remark-->
                                            <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <label>Remark</label>
                                                </div>
                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                    <textarea id="remark" name="remark" class="form-control"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-5 col-md-12 col-sm-12 col-xs-12">
                                <div class="card card-primary panel-primary">
                                    <h2 class="panelheading">Bill Information</h2>
                                    <div class="card-body pane-body">
                                        <div class="row">
                                            <!--Old Bill Number-->
                                            <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12 padding0">
                                                    <label>Old Bill</label>
                                                </div>
                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12 padding0">
                                                    <select id="oldBillNumber" name="oldBillNumber" class="form-control"></select>
                                                </div>
                                            </div>
                                            <!--Refered Bill Number-->
                                            <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12 padding0">
                                                    <label>Ref. Bill No.</label>
                                                </div>
                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12 padding0">
                                                    <input type="text" id="refBillNumber" name="refBillNumber" class="form-control">
                                                </div>
                                            </div>
                                            <!--Posting In Accounts / Adjustment In Invoice / Rate Inclusive Tax-->
                                            <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <div class="form-check-inline">
                                                    <label class="form-check-label">
                                                        <input type="radio" class="form-check-input" value="postingInAccounts" id="postingInAccounts" name="taxType">Posting In Accounts
                                                    </label>
                                                </div>
                                                <div class="form-check-inline">
                                                    <label class="form-check-label">
                                                        <input type="radio" class="form-check-input" value="adjustmentInInvoice" id="adjustmentInInvoice" name="taxType">Adjustment In Invoice
                                                    </label>
                                                </div>
                                                <div class="form-check-inline">
                                                    <label class="form-check-label">
                                                        <input type="radio" class="form-check-input" value="rateInclusiveTax" id="rateInclusiveTax" name="taxType">Rate Inclusive Tax
                                                    </label>
                                                </div>
                                            </div>
                                            <!--Return Date-->
                                            <div class="form-group col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-5 col-md-5 col-sm-12 col-xs-12 padding0">
                                                    <label>Return Date</label>
                                                </div>
                                                <div class="col-lg-7 col-md-7 col-sm-12 col-xs-12 padding0">
                                                    <input type="date" id="returnDate" name="returnDate" value="@DateTime.Now.ToString("yyyy-MM-dd")" max="9999-12-31" class="form-control">
                                                </div>
                                            </div>
                                            <!--Refered Bill Date-->
                                            <div class="form-group col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-5 col-md-5 col-sm-12 col-xs-12 padding0">
                                                    <label>Ref. Bill Date</label>
                                                </div>
                                                <div class="col-lg-7 col-md-7 col-sm-12 col-xs-12 padding0">
                                                    <input type="date" id="refBillDate" name="refBillDate" value="@DateTime.Now.ToString("yyyy-MM-dd")" max="9999-12-31" class="form-control">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-12 col-sm-12 col-xs-12">
                                <div class="card card-primary panel-primary">
                                    <h2 class="panelheading">Amount Information</h2>
                                    <div class="card-body pane-body">
                                        <div class="row">
                                            <!--Gross Total-->
                                            <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                    <label>Gross Total</label>
                                                </div>
                                                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                    <input type="number" id="grossTotal" name="grossTotal" value="0" class="form-control">
                                                </div>
                                            </div>
                                            <!--Other Adj.-->
                                            <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                    <label>Other Adj.</label>
                                                </div>
                                                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                    <input type="number" id="otherAdj" name="otherAdj" value="0" class="form-control">
                                                </div>
                                            </div>
                                            <!--Net Amount-->
                                            <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                    <label>Net Amt.</label>
                                                </div>
                                                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                    <input type="number" id="netAmount" name="netAmount" value="0" class="form-control">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                <div class="card card-primary panel-primary">
                                    <h2 class="panelheading">Product Information</h2>
                                    <div class="card-body pane-body">
                                        <div class="row">
                                            <!--Use Rate-->
                                            <div class="form-group col-lg-3 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <label>Use Rate</label>
                                                </div>
                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                    <select id="useRate" name="useRate" class="form-control">
                                                        <option value="M.R.P">M.R.P</option>
                                                        <option value="Defualt">Defualt</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <!--Category-->
                                            <div class="form-group col-lg-3 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <label>Category</label>
                                                </div>
                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                    <select id="category" name="category" class="form-control">
                                                        <option value="breakage">Breakage</option>
                                                        <option value="expiry">Expiry</option>
                                                        <option value="purchaseReturn">Purchase Return</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <!--Bar Code-->
                                            <div class="form-group col-lg-3 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <label>Bar Code</label>
                                                </div>
                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                    <input type="text" id="barCode" name="barCode" class="form-control">
                                                </div>
                                            </div>
                                            <!--Product Name-->
                                            <div class="form-group col-lg-3 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <label>Prd. Name</label>
                                                </div>
                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                    <input type="text" id="productName" name="productName" class="form-control">
                                                </div>
                                            </div>
                                            <!--Batch Number-->
                                            <div class="form-group col-lg-3 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <label>Batch No.</label>
                                                </div>
                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                    <input type="text" id="batchNumber" name="batchNumber" class="form-control">
                                                </div>
                                            </div>
                                            <!--Expiry-->
                                            <div class="form-group col-lg-3 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <label>Expiry</label>
                                                </div>
                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                    <input type="text" id="expiry" name="expiry" value="" readonly class="form-control">
                                                </div>
                                            </div>
                                            <!--Quantity U and L-->
                                            <div class="form-group col-lg-3 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <label>Qty</label>
                                                </div>
                                                <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 cpb-10">
                                                    <input type="number" id="quantity" value="1" name="quantity" class="form-control">
                                                </div>
                                                @*<div class="col-lg-2 col-md-2 col-sm-12 col-xs-12 padding0 cpb-10">
                                                        <label>Qty. L</label>
                                                    </div>
                                                    <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 cpb-10">
                                                        <input type="number" id="quantity" name="quantity" class="form-control" disabled>
                                                    </div>*@
                                            </div>
                                            <!--Scheme-->
                                            <div class="form-group col-lg-3 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <label>Scheme</label>
                                                </div>
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12 cpb-10">
                                                    <input type="number" id="schemeFirst" value="0" name="schemeFirst" class="form-control">
                                                </div>
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12 cpb-10">
                                                    <input type="number" id="schemeSecond" value="0" name="schemeSecond" class="form-control">
                                                </div>
                                            </div>
                                            <!--Discount Percentage-->
                                            <div class="form-group col-lg-3 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <label>Disc. %</label>
                                                </div>
                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                    <input type="number" id="discountPercentage" value="0" name="discountPercentage" class="form-control">
                                                </div>
                                            </div>
                                            <!--Less Percentage-->
                                            <div class="form-group col-lg-3 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <label>Less %</label>
                                                </div>
                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                    <input type="number" id="lessPercentage" value="0" name="lessPercentage" class="form-control">
                                                </div>
                                            </div>
                                            <!--Discount Rupees-->
                                            <div class="form-group col-lg-3 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <label>Disc. Rs.</label>
                                                </div>
                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                    <input type="number" id="discountRupees" value="0" name="discountRupees" class="form-control" disabled>
                                                </div>
                                            </div>
                                            <!--Scheme Discount Percentage-->
                                            <div class="form-group col-lg-3 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <label>Sch. Disc. %</label>
                                                </div>
                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                    <input type="number" id="schemeDiscountPercentage" value="0" name="schemeDiscountPercentage" class="form-control">
                                                </div>
                                            </div>
                                            <!--Lot Discount-->
                                            <div class="form-group col-lg-3 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <label>Lot Disc.</label>
                                                </div>
                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                    <input type="number" id="lotDiscount" value="0" name="lotDiscount" class="form-control" disabled>
                                                </div>
                                            </div>
                                            <!--Purchase Rate-->
                                            <div class="form-group col-lg-3 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <label>Pur. Rate</label>
                                                </div>
                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                    <input type="number" id="purchaseRate" value="0" name="purchaseRate" class="form-control">
                                                </div>
                                            </div>
                                            <!--Posting Account-->
                                            <div class="form-group col-lg-3 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <label>Post.g A/c.</label>
                                                </div>
                                                <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                    <input type="text" id="postingAccount" name="postingAccount" class="form-control">
                                                    <input type="hidden" id="postingAccountID" name="postingAccountID" class="form-control">
                                                </div>
                                            </div>
                                            <!--Button-->
                                            <div class="form-group col-lg-3 col-md-2 col-sm-12 col-xs-12">
                                                <button type="button" id="addProductInformation" name="addProductInformation" class="btndivcss pull-right" style="height: 25px;">
                                                    Add
                                                </button>
                                            </div>
                                        </div>
                                        <div class="vol-lg-12 col-md-12 col-sm-12 col-xs-12 table-responsive">
                                            <table id="purchaseReturnTable" class="table table-bordered hover display table-hover" role="grid" style="width: 100%">
                                                <thead style="background-color: #bddff7;">
                                                    <tr>
                                                        <th>Sr. No.</th>
                                                        <th>Use Rate</th>
                                                        <th>Category</th>
                                                        <th>Product Name</th>
                                                        <th>Batch</th>
                                                        <th>Expiry Date</th>
                                                        <th>Quantity</th>
                                                        <th>Scheme</th>
                                                        <th>Discount %</th>

                                                        <th>Less By %</th>
                                                        <th>Rate</th>
                                                        <th>Total Amount</th>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="text-align: center;">
                                <div class="btn-group dropdown-split-warning">
                                    <button type="submit" class="btn btn-app" id="save">
                                        <i class="fa fa-save"></i>Save
                                    </button>
                                </div>
                                <div class="btn-group dropdown-split-warning">
                                    <a class="btn btn-app" id="delete">
                                        <i class="fa fa-trash"></i>Delete
                                    </a>
                                </div>
                                <div class="btn-group dropdown-split-warning">
                                    <a class="btn btn-app" onclick="location.reload();">
                                        <i class="fa fa-refresh"></i>Clear
                                    </a>
                                </div>
                                <div class="btn-group dropdown-split-warning">
                                    <a class="btn btn-app" onclick="window.location.href='@Url.Action("Pharmacy", "Application")'">
                                        <i class="fa fa-sign-out"></i>Exit
                                    </a>
                                </div>
                                @*<div class="btn-group dropdown-split-warning">
                                        <a class="btn btn-app" id="purchaseReturnTableExcelExport"></a>
                                    </div>*@
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </form>
    </div>
</body>
<script>
    $(document).ready(function () {
        debugger;
        $("#supplierName").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: '@Url.Action("BindSuplName", "PurchaseReturn")',
                    type: "GET",
                    dataType: "Json",
                    data: { Name: request.term +"%"},
                    success: function (data) {
                        response($.map(data, function (item) {
                            return {
                                label: item.ProductSupplierName, value: item.ProductSupplierName, id: item.ProductSupplierID
                            };
                        }))
                    }
                })
            },
            minlength: 1,
            select: function (event, i) {
                debugger;
                var show = i.item.id;
                $("#SupplierID").val(show);
                $.ajax({
                    url: '@Url.Action("FillData", "PurchaseReturn")',
                    type: "POST",
                    dataType: "Json",
                    data: { SupplierID: i.item.id },
                    success: function (data) {
                        debugger
                        $("#address").text(data[0].Address)
                        $("#oldBillNumber").append('<option value=' + 0 + '>--Select--</option>');
                        for(var i=1;i<data.length;i++)
                        {
                            $("#oldBillNumber").append('<option value=' + data[i].BillNo + '>' + data[i].BillNoAndDate + '</option>');
                        }
                    }
                })
            },
        });
        var ProductID = 0;
        $("#productName").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: '@Url.Action("BindProductName", "PurchaseReturn")',
                    type: "GET",
                    dataType: "Json",
                    data: { Name: request.term },
                    success: function (data) {
                        debugger
                        response($.map(data, function (item) {
                            return {
                                label: item.ProductName, value: item.ProductName, id: item.ProductID
                            };
                        }))
                    }
                })
            },
            minlength: 1,
            select: function (event, i) {
                ProductID = i.item.id;
            }
        })
        $("#batchNumber").autocomplete({
        source: function (request, response) {
        $.ajax({
            url: '@Url.Action("BindBatchNoOfProduct", "PurchaseReturn")',
            type: "GET",
            dataType: "Json",
            data: { ProductID: ProductID },
            success: function (data) {
                response($.map(data, function (item) {
                    return {
                        label: item.BatchNo + "ExpiryDate-" + item.ExpiryDate, value: item.BatchNo, id: item.ProductDetailsID
                    };
                }))
            }
        })
        },
            minlength: 1,
            select: function (event, i) {
                $.ajax({
                    url: '@Url.Action("FillDataByProduct", "PurchaseReturn")',
                    type: "POST",
                    dataType: "Json",
                    data: { ProductDetailsID: i.item.id},
                    success: function (data) {
                        debugger
                        $("#expiry").val(data.ExpiryDate);
                        $("#purchaseRate").val(data.Rate);
                    }

                })
            }
        })
        $("#oldBillNumber").change(function () {
            debugger
            if($(this).val()>0)
            {
                $.ajax({
                    url: '@Url.Action("FillOldBillDetails", "PurchaseReturn")',
                    type: "GET",
                    dataType: "Json",
                    data: { BillNo: $(this).val() },
                    success: function (data) {
                        debugger
                        $("#grossTotal").val(data.obj.grossTotal);
                        $("#otherAdj").val(data.obj.otherAdj);
                        $("#netAmount").val(data.obj.netAmount);
                        if (data.obj.taxType == "IsPostingAccount") {
                            $("#postingInAccounts").attr('checked', true);
                        }
                        if (data.obj.taxType == "AdjustmentInInvoice") {
                            $("#adjustmentInInvoice").attr('checked', true);
                        }
                        if (data.obj.taxType == "RateInclusiveTax") {
                            $("#rateInclusiveTax").attr('checked', true);
                        }
                        var count = 1;
                        $("#purchaseReturnTable tbody tr").remove();
                        for(var i=0;i<data.obj1.length;i++)
                        {
                            $("#purchaseReturnTable tbody").append('<tr><td>' + count + '</td><td><input type="hidden" name="UserRate"> ' + data.obj1[i].UserRate + '</td><td><input type="hidden" name="Category">' + data.obj1[i].Category + '</td><td><input type="hidden" value="" name="ProductName">' + data.obj1[i].ProductName + '</td><td><input type="hidden" name="BatchNo">' + data.obj1[i].BatchNo + '</td><td><input type="hidden" name="ExpiryDate">' + data.obj1[i].ExpiryDate + '</td><td><input type="hidden" name="Qty">' + data.obj1[i].Qty + '</td><td><input type="hidden" name="Scheme">' + data.obj1[i].Scheme + '</td><td><input type="hidden" name="DisCountPer">' + data.obj1[i].DisCountPer + '</td><td><input type="hidden" name="LessByPer">' + data.obj1[i].LessByPer + '</td><td><input type="hidden" name="Rate">' + data.obj1[i].Rate + '</td><td><input type="hidden" name="TotalAmount">' + data.obj1[i].TotalAmount + '</td></tr>')
                            count++;
                        }
                    }
                })
            }
        })

        $("#addProductInformation").click(function () {
            debugger
            if ($("#quantity").val() != "" || $("#productName").val() != "") {
                var schemeD = 0;
                var QuantityD = 0;
                 
                var schemeD = parseFloat($("#schemeFirst").val());
                var QuantityD = parseFloat($("#quantity").val());
                var count = 1;

                var amount = parseFloat($("#purchaseRate").val()) * parseFloat($("#quantity").val());
                var disPer = parseFloat($("#discountPercentage").val());
                var Discount = ((amount) * (disPer)) / (100);
                var amt = ((amount) - (Discount));
                var lessby = parseFloat($("#lessPercentage").val());
                var lessbyValue = parseFloat(Discount) * parseFloat(lessby) / (100);
                totalAmount = (amt) + (lessbyValue);

                $("#purchaseReturnTable tbody").append('<tr><td>' + count + '</td><td><input type="hidden" value=' + $("#barCode").val() + ' name="Barcode"><input type="hidden" value=' + $("#useRate").val() + ' name="UserRate"> ' + $("#useRate").val() + '</td><td><input type="hidden" value=' + $("#category").val() + ' name="Category">' + $("#category").val() + '</td><td><input type="hidden" value=' + ProductID + ' name="ProductID"><input type="hidden" value=' + $("#productName").val() + ' name="ProductName">' + $("#productName").val() + '</td><td><input type="hidden" value=' + $("#batchNumber").val() + ' name="BatchNo">' + $("#batchNumber").val() + '</td><td><input type="hidden" value=' + $("#expiry").val() + ' name="ExpiryDate">' + $("#expiry").val() + '</td><td><input type="hidden" value=' + $("#quantity").val() + ' name="Qty">' + $("#quantity").val() + '</td><td><input type="hidden" value=' + $("#schemeDiscountPercentage").val() + ' name="SchemeDiscountInPer"><input type="hidden" value=' + $("#schemeFirst").val() + ' name="Scheme">' + $("#schemeFirst").val() + '</td><td><input type="hidden" value=' + $("#discountPercentage").val() + '   name="DisCountPer">' + $("#discountPercentage").val() + '</td><td><input type="hidden" value=' + $("#lessPercentage").val() + ' name="LessByPer">' + $("#lessPercentage").val() + '</td><td><input type="hidden" value=' + $("#purchaseRate").val() + ' name="Rate">' + $("#purchaseRate").val() + '</td><td><input type="hidden" class="total" value=' + totalAmount + ' name="TotalAmount">' + totalAmount + '</td></tr>')
                count++;
                var Gross = 0;
                $(".total").each(function () {
                    debugger
                    Gross += parseFloat($(this).parent().find('input[name=TotalAmount]').val())
                })
                $("#grossTotal").val(Gross);
                var txtNetAmt = Gross - parseFloat($("#otherAdj").val());
                $("#netAmount").val(txtNetAmt);
            }
        })
        $("#otherAdj").keyup(function () {
            var txtNetAmt = parseFloat($("#grossTotal").val()) - parseFloat($("#otherAdj").val());
            $("#netAmount").val(txtNetAmt);
        })
        $("#postingAccount").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: '@Url.Action("BindPostingAccount", "PurchaseReturn")',
                    type: "GET",
                    dataType: "Json",
                    data: { ProductID: 0 },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return {
                                label: item.AccountName, value: item.AccountName, id: item.AccountsID
                            };
                        }))
                    }
                })
            },
            minlength: 1,
            select: function (event, i) {
                $("#postingAccountID").val(i.item.id);
            }
        })
    });
</script>
@model KeystoneProject.Models.Patient.PreBalanceAmount

@{
    ViewBag.Title = "Patient";
    Layout = "~/Views/Shared/_Layout.cshtml";

}


@*<!DOCTYPE html>
    <html>
    <head>*@
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<script>
    $(document).ready(function () {
        $("#TpaDetailsCheck").hide();
    });


</script>

@if (TempData["Msg"] != null)
{
    <script type="text/javascript">
        alert(@Html.Raw(Json.Encode(TempData["Msg"])));
       // window.onload(true);
    </script>
}



<script>
    var chk = false;
    function myFunction() {
        debugger

        debugger
        if (chk == "True") {
            var con = confirm("Send For Authorization Confirmation");
            if (con) {
                var person = prompt("Reason For Authorization");
                if (person) {
                    //govind
                    $("#txtinput").val(person);
                    $("#ForAuthorization").val(1);
                    return true;
                }
                else {
                    $("#ForAuthorization").val(0);
                    $("#txtinput").val('');
                    return false;
                }
            }
            else {
                return false;
            }
        }
        else {
            return true;
        }

    }
    function aurthorise() {
        $.ajax({
            //url: "/OPDBill/GetServiceGrp",
            url: '@Url.Action("chkAurthorise", "OPDBill")',
            type: "POST",
            dataType: "json",
            data: { prefix: "" },
            success: function (data) {
                debugger
                // alert(data[0]);
                chk = data[0];
                if (data[1] == "True") {
                    chk = false;
                }
                myFunction();

            }
        })
    }
   
    function del(PatientAccountRowID, BillType) {
        debugger;
        //$("#DeleteSave").val("");
      // $("#deletepassword").val("");
        if (BillType == "IPD PreBalanceBills" || BillType == "OPD PreBalanceBills" || BillType == "IPD RefundBills" || BillType == "OPD RefundBills" || BillType == "OPD PreBalanceBillsTPA" || BillType == "IPD PreBalanceBillsTPA" || BillType == "IPD SecurityDeposit PreBalanceBills" || BillType == "IPD SecurityDeposit RefundBills" || BillType == "IPD SecurityDeposit PreBalanceBillsTPA") {



            var ans = confirm("Are you sure you want to delete this Record?");
           // alert(ans);
           
         
            
            var Reason = $("#ReasonToDelete").val();
            debugger
            if (ans) {
                $("#delModal").modal('show');
                debugger
                $("#DeleteSave").click(function () {
                    debugger
                    var pass = $("#deletepassword").val();
                    var value = $("#DeleteSave").val();
                  
                    $("#delModal").modal('hide');
                    if ($("#ReasonToDelete").val()=="")
                    {
                        alert("Reason Cann't Be Empty");
                        //   $("#ReasonToDelete").val("");
                        $("#deletepassword").val("");
                        return false;
                    }
               
              
                if (value == "okk") {
                      $.ajax({
                        type: "POST",
                        url: '@Url.Action("MasterSetting", "PreBalanceAmount")',
                        data: { Password: pass },
                        dataType: "json",
                        success: function (data) {
                            debugger
                          //  alert(data);
                            if (pass == data) {
                                debugger
                                aurthorise();
                                $.ajax({
                                    type: "POST",
                                    url: '@Url.Action("DeletePreBalance", "PreBalanceAmount")',
                                    data: { PatientAccountRowID: PatientAccountRowID, DeleteReason: $("#ReasonToDelete").val(), BillType: BillType, Reg: $("#PatientRegNO").val(), SecurityDeposityID: $("#SecurityDeposityID").val() },
                                    dataType: "json",
                                    success: function (data) {
                                        if (data == "Deleted Successfully") {
                                            alert("Deleted Successfully");
                                          //  $("#ReasonToDelete").val("");
                                            $("#deletepassword").val("");
                                            debugger
                                            var PatientRegNo = $("#PatientRegNO").val();
                                            $.ajax({
                                                type: "POST",
                                                url: '@Url.Action("AjaxMethodDgv", "PreBalanceAmount")',
                                                data: '{PatientRegNo: ' + PatientRegNo + '}',
                                                contentType: "application/json; charset=utf-8",
                                                success: function (search) {
                                                    // alert(search);
                                                    var a;
                                                    debugger
                                                    if (search != null) {
                                                        debugger;
                                                        $("#presentor tr").remove();
                                                        $("#OPDIPDNO option:selected").remove();
                                                        $("#OPDIPDNO").val("");
                                                        for (var i = 0; i < search.length; i++) {

                                                            $("#presentor").append('<tr><td><a href="#" <i class="fa fa-print"></i></a></td><td> ' + search[i].OPDIPDNO + '</td><td>' + search[i].BillType + '</td><td >' + search[i].P_BillNo + '</td><td>' + search[i].DrAmount + '</td><td>' + search[i].CrAmount + '</td><td class="tparate" >' + search[i].TDSAmount + '</td><td class="tparate">' + search[i].TPAOtherDeduction + '</td><td>' + search[i].BillDate + '</td><td style="display:none">' + search[i].BillNo + '</td><td style="display:none"><input type="text" value="' + search[i].P_RegNo + '"></td><td>' + search[i].PaymentType + '</td><td>' + search[i].PatientAccountRowID + '</td><td  style="display:none">' + search[i].PrintRegNo + '</td><td><button type="button" id="EditID" class="ss btndivcss openDeleteModal" value="Edit"><span class="buttoniconcss"></span>Edit</button></td><td><button type="button" id="tbltd" class="ss btndivcss" onclick="del(\'' + search[i].PatientAccountRowID + '\',\'' + search[i].BillType + '\')" value="Delete"><span class="buttoniconcss"></span>Delete</button></td><td style="display:none">' + search[i].PatinetType + '</td><td style="display:none">' + search[i].OPDIPDID + '</td></tr>');

                                                            //a += search[i].CrAmount;
                                                            //alert(a);

                                                        }
                                                        var chk = document.getElementById('chkTPA');
                                                        if (chk.checked) {

                                                            $("#TPAAmt").show();
                                                            $("#TDsAmt").show();
                                                            $(".tparate").show();

                                                        }
                                                        else {
                                                            $("#TPAAmt").hide();
                                                            $("#TDsAmt").hide();
                                                            $(".tparate").hide();

                                                            //  $("#presentor").append('<tr><td><a href="#" <i class="fa fa-print"></i></a></td><td> ' + search[i].OPDIPDNO + '</td><td>' + search[i].BillType + '</td><td>' + search[i].DrAmount + '</td><td  style="display:none">' + search[i].P_BillNo + '</td><td>' + search[i].CrAmount + '</td><td id="tpaamt" name="tpaamt">' + search[i].TDSAmount + '</td><td id="tpadsc" name="tpadsc">' + search[i].TPAOtherDeduction + '</td><td>' + search[i].BillDate + '</td><td>' + search[i].BillNo + '</td><td style="display:none"><input type="text" value="' + search[i].P_RegNo + '"></td><td>' + search[i].PaymentType + '</td><td>' + search[i].PatientAccountRowID + '</td><td  style="display:none">' + search[i].PrintRegNo + '</td><td><button type="button" id="EditID" class="ss btndivcss openDeleteModal" value="Edit"><span class="buttoniconcss"></span>Edit</button></td><td><button type="button" id="tbltd" class="ss btndivcss" onclick="del(\'' + search[i].PatientAccountRowID + '\',\'' + search[i].BillType + '\')" value="Delete"><span class="buttoniconcss"></span>Delete</button></td></tr>');

                                                        }
                                                        TableBind();
                                                        //    alert(search[0].PreBalance);
                                                        if (search[0].PreBalance != 0.00) {
                                                            $("#PreBalanceAmount").val(search[0].PreBalance);
                                                        }
                                                        else {
                                                            $("#presentor tr").remove();
                                                            $("#PreBalanceAmount").val(0.00);
                                                        }

                                                        // alert(search.CrAmount);
                                                    }
                                                    else {
                                                        debugger
                                                        $("#PreBalanceAmount").val(0.00);
                                                    }

                                                },
                                            });
                                            //--------

                                            $("#OPDIPDNO option:selected").remove();
                                            $("#OPDIPDNO").val("");
                                            $.ajax({
                                                type: "POST",
                                                url: '@Url.Action("GetRefoundIPDOPDID1", "PreBalanceAmount")',
                                                data: '{PatientRegNo: ' + PatientRegNo + '}',
                                                contentType: "application/json; charset=utf-8",
                                                success: function (SearchList2) {
                                                    debugger
                                                    for (var i = 0; i < SearchList2.length; i++) {
                                                        $("#OPDIPDNO").append('<option value="' + SearchList2[i].OPDIPDNO + "-" + SearchList2[i].PatinetType + '">' + SearchList2[i].PrintOPDIPDNo + '</option>');
                                                    }
                                                    //   TablePrint();
                                                    TableBind();
                                                },
                                            });
                                            //----------------
                                        }
                                        else {
                                            alert(data);
                                        }
                                    },
                                    error: function (errormessage) {
                                        alert(errormessage.responseText);
                                    }
                                });
                            }
                            else {
                              
                                alert("Wrong Password");
                              //  $("#DeleteSave").val("");
                               $("#deletepassword").val("");
                            }
                        }

                    })
                }
                })
            }
            return false;
               
        }
    }

    $(document).ready(function () {
      
        // window.onload(true);
        $("input[type=text],input[type=number],hidden,input[type=textarea]").val("");
        $("#PaymentType").val("Cash");
        $("#PatientName").autocomplete({

            source: function (request, response) {
                debugger
                $.ajax({
                    url: '@Url.Action("GetPatientName", "PreBalanceAmount")',
                    type: "POST",
                    dataType: "json",
                    data: { prefix: request.term },
                    success: function (data) {
                        response($.map(data, function (item) {
                            debugger
                            return {
                                label: item.PatientName, value: item.PatientName, id: item.PatientRegNo, PrintRegNo: item.PrintRegNo
                            };
                        }))
                    }
                })
            },
            minLength: 1,
            select: function (event, ui) {
                var d = ui.item.id;
                //  alert(d);
                $("#presentor tr").remove();
                if (d > 0) {
                    $("#PatientRegNO").val(d);
                    $("#PrintRegNO").val(ui.item.PrintRegNo);
                    FillRegNo();
                }
              
                //   TablePrint();
                TableBind();
            },
        });

        $("#PrintRegNO").change(function () {
            var printReg = $(this).val();
            $("input[type=text],input[type=number] ,hidden").val("");
            $('#PrintRegNO').val(printReg);
            $.ajax({
                url: '@Url.Action("GetPrintNo_ToRegNo", "PreBalanceAmount")',
                dataType: "json",
                type: 'GET',
                data: { PrintRegNo: printReg},

                success: function (data) {
                    debugger
                  
                    //  $('#fin_year_id').val(fin_year_id);
                    if (data == "") {
                        alert("Patient RegNo Does Not Exists");
                        return false;
                    }
                    else
                    {
                        $("#PatientRegNO").val(data)
                        //  var d = "";

                        FillRegNo();
                    }
                  

                   // d = $("#PatientRegNO").val();
                }
            })



        })
    })
    $(function () {
        $("#PatientRegNO").change(function () {
            debugger
            FillRegNo();
            debugger


        });
        $("#SecurityDepoRefundTPA").change(function () {
            debugger
            var chk = $('input[name=SecurityDepoRefundTPA]:checked').val();

            if (chk == "on")
            {

                $("#PaidAmount").val(SecurityDeposityAmt);
                var IPDNo = $("#OPDIPDNO").val().trim().replace("-", ",");
                window.open('@Url.Action("PaymentAndDeposit", "PaymentAndDeposit")?IPDNo=' + IPDNo);
               // PaidAmount();
            }
            else
            {
                $("#PaidAmount").val(0);
              //  PaidAmount();
            }
        })
        $("#SecurityDepositeTPA").change(function () {
            debugger
            var chk = $('input[name=SecurityDepositeTPA]:checked').val();

            if (chk == "on")
            {

                $("#PaidAmount").val(SecurityDeposityAmt);
                $("#PaidAmount").attr("readonly", "readonly");
                PaidAmount();
            }
            else
            {
                $("#PaidAmount").val(0);
                $("#PaidAmount").attr("readonly", false);
                PaidAmount();
            }
        })

        var IPDOPDRegNo = localStorage.getItem('IPDOPDRegNo');

        if (IPDOPDRegNo > 0)
        {
            $("#PatientRegNO").val(IPDOPDRegNo)
            FillRegNo();
            localStorage.setItem('IPDOPDRegNo', "0");
        }
    })

    var SecurityDeposityAmt = 0;
    debugger
    function FillRegNo() {
        $("#pre").text("Pre Bal. Amt.");
        $("#presentor tr").remove();
        var PregNo = { PatientRegNO: $("#PatientRegNO").val() }

        $.ajax({
            type: "POST",
            url: '@Url.Action("GetPatientRegNo", "PreBalanceAmount")',
            data: JSON.stringify(PregNo),
            contentType: "application/json; charset=utf-8",
            success: function (searchList) {
                debugger
                if (searchList == "Record Not Found") {
                    alert("Record Not Found");
                    $("#PatientName").val("");
                    window.relaod(true);
                }
                else
                {

                    $("#PatientName").val(searchList[0]);

                }

            },
        });
        var PregNo = { PatientRegNO: $("#PatientRegNO").val() }
        $("#presentor tr").remove();
        $.ajax({
            type: "POST",
            url: '@Url.Action("AjaxMethod", "PreBalanceAmount")',
            data: JSON.stringify(PregNo),
            contentType: "application/json; charset=utf-8",
            success: function (searchList) {
                $("#PreBalanceAmount").val(searchList[0].PreBalance);
                $("#PaidAmount").val("");
                if (searchList[0].chkTPA == "True") {
                    $("#chkTPA").prop("checked", true);
                }
                PaidAmount();
                debugger
                if (parseFloat($("#PreBalanceAmount").val()) < 0) {
                    //alert("Deposit");
                    $("#btnpaid").addClass("hide");
                    $("#pre").text("Deposit Amt");
                    $("#pre").css("color", "blue");
                }
                else {

                    $("#btnpaid").removeClass("hide");
                    $("#pre").text("Pre Bal. Amt.");
                    $("#pre").css("color", "black");
                }
                debugger
              
                debugger
                if(searchList[0].PatinetType=="OPD")
                {

               
                if (searchList[0].chkTPA == "True") {
                    debugger
                    $("#chkTPA").prop("checked", true);
                    $("#TpaDetailsCheck").show();
                    if (searchList[0].SecurityDeposityAmt>0)
                    {
                        $("#Secdep").show();
                        $("#SecurityDepositeTPA").show();
                        // $("#SecurityDepositeTPA").prop("checked", true);
                       

                        SecurityDeposityAmt = searchList[0].SecurityDeposityAmt;

                        $("#SecurityDeposityID").val(searchList[0].SecurityDeposityID);
                    }
                  
                    $("#TPAAmt").show();
                    $("#TDsAmt").show();
                    $(".tparate").show();
                }
            }
                debugger
                if (searchList[0].PatinetType == "IPD")
        {
                    if (searchList[0].chkTPA == "True") {
                        debugger
                        $("#chkTPA").prop("checked", true);
                        $("#TpaDetailsCheck").show();
                        //$("#TPAAmt").show();
                        //$("#TDsAmt").show();
                        //$(".tparate").show();
                    }
       
            if (searchList[0].SecurityDeposityID > 0) {
             //   $("#chkTPA").prop("checked", true);
              
                if (searchList[0].SecurityDeposityAmt > 0) {
                    $("#Secdep").show();
                    $("#SecurityDepositeTPA").show();
                    $("#TpaDetailsCheck").show();
                    // $("#SecurityDepositeTPA").prop("checked", true);


                    SecurityDeposityAmt = searchList[0].SecurityDeposityAmt;
                    $("#SecurityDeposityID").val(searchList[0].SecurityDeposityID);
                }


            }
            else
            {
                SecurityDeposityAmt = 0;
                $("#chkTPA").prop("checked", false);
                $("#SecurityDepositeTPA").hide();
                $("#SecurityDepositeTPA").prop("checked", false);
                $("#TpaDetailsCheck").hide();
                $("#Secdep").hide();
                //$("#TPAAmt").hide();
                //$("#TDsAmt").hide();
                //$(".tparate").hide();
            }
        }
              //  TablePrint();
                TableBind();

            },
        });
     
        var PatientRegNo = $("#PatientRegNO").val();
        var BillDate;
        $.ajax({
            type: "POST",
            url: '@Url.Action("AjaxMethodDgv", "PreBalanceAmount")',
            data: '{PatientRegNO: ' + JSON.stringify(PatientRegNo) + '}',
            contentType: "application/json; charset=utf-8",
            success: function (search)
            {
                debugger;

                $('#presentor').show();
                //$("#TPAAmt").show();
                //$("#TDsAmt").show();
                //$(".tparate").show();
                for (var i = 0; i < search.length; i++)
                {
                    if (search[i].OPDIPDNO!=null)
                    {
                        var BillType = search[i].BillType
                        var hidden = "";
                        if (BillType == "IPDLabBills" || BillType == "IPDFinalBill" || BillType == "IPDBill" || BillType == "OPDBill") {
                            hidden = "hidden";
                            //  $(this).parent().find('#tbltd').remove();

                        }
                       
                       //  $("#presentor").append('<tr><td  id="PatientRegNO" value="' + search[i][0] + '">' + search[i][0] + '</td><td>' + search[i][1] + '</td><td>' + search[i][2] + '</td><td>' + search[i][3] + '</td><td>' + search[i][4] + '</td><td>' + search[i][5] + '</td><td id="tbltd">' + search[i][6] + '</td><td>' + search[i][7] + '</td><td>' + search[i][8] + '</td><td>' + search[i][9] + '</td><td>' + search[i][10] + '</td><td>' + search[i][11] + '</td><td><button type="button" class="btndivcss" id="tbltd" onclick="del(' + PatientRegNo + ')" value="Delete"><span class="fa fa-sign-out buttoniconcss"></span>Delete</button></td></tr>');
                        $("#presentor").append('<tr><td><i id="print" class="fa fa-print"></i></td><td> ' + search[i].OPDIPDNO + '</td><td>' + search[i].BillType + '</td><td>' + search[i].P_BillNo + '</td><td>' + search[i].DrAmount + '</td><td>' + search[i].CrAmount + '</td><td class="tparate" >' + search[i].TDSAmount + '</td><td class="tparate">' + search[i].TPAOtherDeduction + '</td><td>' + search[i].BillDate + '</td><td style="display:none">' + search[i].BillNo + '</td><td style="display:none"><input type="text" value="' + search[i].P_RegNo + '"></td><td>' + search[i].PaymentType + '</td><td>' + search[i].PatientAccountRowID + '</td><td  style="display:none">' + search[i].PrintRegNo + '</td><td><button type="button" id="EditID" class="ss btndivcss openDeleteModal" value="Edit"><span class="buttoniconcss"></span>Edit</button></td><td><button type="button" id="tbltd" class="ss btndivcss" onclick="del(\'' + search[i].PatientAccountRowID + '\',\'' + search[i].BillType + '\')" value="Delete"><span class="buttoniconcss"></span>Delete</button></td><td style="display:none">' + search[i].PatinetType + '</td><td style="display:none">' + search[i].OPDIPDID + '</td></tr>');
                        // alert($("#chkTPA").val());
                        var chk = document.getElementById('chkTPA');
                        if (chk.checked) 
                        {
                            debugger
                            $("#TPAAmt").show();
                            $("#TDsAmt").show();
                            $(".tparate").show();
                           

                            // $("#presentor").append('<tr><td><i id="print" class="fa fa-print"></i></td><td> ' + search[i].OPDIPDNO + '</td><td>' + search[i].BillType + '</td><td>' + search[i].DrAmount + '</td><td  style="display:none">' + search[i].P_BillNo + '</td><td>' + search[i].CrAmount + '</td><td id="tpaamt" name="tpaamt">' + search[i].TDSAmount + '</td><td id="tpadsc" name="tpadsc">' + search[i].TPAOtherDeduction + '</td><td>' + search[i].BillDate + '</td><td>' + search[i].BillNo + '</td><td style="display:none"><input type="text" value="' + search[i].P_RegNo + '"></td><td>' + search[i].PaymentType + '</td><td>' + search[i].PatientAccountRowID + '</td><td  style="display:none">' + search[i].PrintRegNo + '</td><td><button type="button" id="EditID" class="ss btndivcss openDeleteModal" value="Edit"><span class="buttoniconcss"></span>Edit</button></td><td><button type="button" id="tbltd" class="ss btndivcss" onclick="del(\'' + search[i].PatientAccountRowID + '\',\'' + search[i].BillType + '\')" value="Delete"><span class="buttoniconcss"></span>Delete</button></td></tr>');

                        }
                        else
                        {
                            $("#TPAAmt").hide();
                            $("#TDsAmt").hide();
                            $(".tparate").hide();
                           

                        }
                    }
                    if (BillType == "Admission") {
                        BillDate = search[i].BillDate.split('-');
                        
                      //  alert(BillDate);
                      
                        //var dtToday = new Date();
                        var month = BillDate[1];
                        
                       // alert(month);
                        var day = BillDate[0];
                       // alert(day);
                        var year = BillDate[2];
                       // alert(year);
                        if (month < 10)
                            month =  month.toString();
                        if (day < 10)
                            day = '0' + day.toString();

                        var maxDate = year + '-' + month + '-' + day;
                        // alert(maxDate);
                        debugger
                        $('#datepicker').attr('min', maxDate);
                        $("#editModalDate").attr('min', maxDate);
                    }
                    
                }
                debugger
              
              
           //    TablePrint();
               TableBind();
            },
        });
     
        var PregNo = { PatientRegNO: $("#PatientRegNO").val() }
        $.ajax({
            type: "POST",
            url: '@Url.Action("GetRefoundIPDOPDID1", "PreBalanceAmount")',
            data: JSON.stringify(PregNo),
            contentType: "application/json; charset=utf-8",
            success: function (SearchList2) {
                var value = "";
                $("#OPDIPDNO").text("");
                $("#OPDIPDNO").val("");
                debugger
                $("#OPDIPDNO").append('<option value="' + $("#PatientRegNO").val() + '">---All---</option>');
                for (var i = 0; i < SearchList2.length; i++)
                {

                    //$("#OPDIPDNO").val(optionhtml);

                    $("#OPDIPDNO").append('<option value="' + SearchList2[i].OPDIPDNO + '">' + SearchList2[i].PrintOPDIPDNo + '</option>');


                }
             //   TablePrint();
                TableBind();
                //var len = document.getElementById('OPDIPDNO').length - 1;
                //document.getElementById('OPDIPDNO').selectedIndex = len;
            },
        });

    }

   


    $(function () {
        $(".openDeleteModal").on('click', function () {
            debugger;
            $("#deleteModal").modal('show');
           
        })
        $("#PaidAmount").keyup(function () {
            debugger
            if ($(this).val() == "") {
                $(this).val();
            }
            PaidAmount();
        })
        //$("#PaidAmount").change(function ()
        //{
        //    if ($("#PaymentType").val() == "Cash") {
        //        $("#paymentAdd tbody").append('<tr><td><input type="hidden" value="Cash" class="tblPaymentType" name="tblPaymentType"/>Cash</td><td><input type="hidden" value="Cash" name="tblNumber"/>Cash</td><td><input type="text"  name="tblName" readonly class="form-control input-sm" value="Cash"></td><td><input type="date" name="tblpaymentDate" class="form-control input-sm" value=' + $("#paymentDate").val() + '></td><td><input type="text" name="tblRemarks" readonly class="form-control input-sm" value=' + $("#Remarks").val() + '></td><td><input type="number" class=".total"  id="tblPaymentTotal" name="tblPaymentTotal"  class="form-control input-sm" value=' + $("#PaidAmount").val() + '></td><td><a href="#" class="fa fa-trash-o" aria-hidden="true" id="delrow" class="delrow"></td></tr>');

        //    }
        //})
    });
    debugger
    function PaidAmount() {
        debugger
        var PaidAmount = $("#PaidAmount").val().replace("-", "");

        $("#PaidAmount").val(PaidAmount);
        var PreBalance = $("#PreBalanceAmount").val();
        debugger
        $.ajax({
            type: "POST",
            url: '@Url.Action("Calculate", "PreBalanceAmount")',
            data: '{PaidAmount: ' + JSON.stringify(PaidAmount) + ',PreBalance:' + JSON.stringify(PreBalance) + '}',
            contentType: "application/json; charset=utf-8",
            success: function (search1)
            {
                debugger
                $("#BalanceAmount").val(search1[0]);
            },

        });

    }



    $(document).ready(function () {
        $("#btnadd").click(function () {
            debugger
            $("#paymentAdd").show()

            
            if ($("#PaymentType").val() == "Cash")
            {
                // $("#paymentAdd tbody").append('<tr><td><input type="hidden" value="Cash" class="tblPaymentType" name="tblPaymentType"/>Cash</td><td><input type="hidden" value="Cash" name="tblNumber"/>Cash</td><td><input type="text"  name="tblName" readonly class="form-control input-sm" value="Cash"></td><td><input type="date" name="tblpaymentDate" class="form-control input-sm" value=' + $("#paymentDate").val() + '></td><td><input type="text" name="tblRemarks" readonly class="form-control input-sm" value=' + $("#Remarks").val() + '></td><td><input type="number" class=".total"  id="tblPaymentTotal" name="tblPaymentTotal"  class="form-control input-sm" value=' + $("#PaidAmount").val() + '></td><td><a href="#" class="fa fa-trash-o" aria-hidden="true" id="delrow" class="delrow"></td></tr>');
                $("#paymentAdd tbody").append('<tr><td><input type="hidden" class="tblPaymentType" value="Cash" name="tblPaymentType"/>Cash</td><td><input type="hidden"  value="Cash" name="tblNumber"/>Cash</td><td><input type="text"   name="tblName" readonly class="form-control input-sm" value="Cash"></td><td><input type="date" name="tblpaymentDate" class="form-control input-sm" value=' + $("#paymentDate").val() + '></td><td><input type="text" readonly name="tblRemarks" class="form-control input-sm" value="Cash"></td><td><input type="number" class=".total"  id="tblPaymentTotal" name="tblPaymentTotal"  class="form-control input-sm" value=' + $("#PaidAmt").val() + '></td><td><a href="#" class="fa fa-trash-o" aria-hidden="true" id="delrow" class="delrow"></td></tr>');

            }
            else
            {

                $("#paymentAdd tbody").append('<tr><td><input type="hidden" class="tblPaymentType" value="' + $("#PaymentType").val() + '" name="tblPaymentType"/>  ' + $("#PaymentType").val() + '</td><td><input type="hidden" value=' + $("#Number").val() + ' name="tblNumber"/>' + $("#Number").val() + '</td><td><input type="text"  name="tblName" readonly class="form-control input-sm" value=' + $("#Name").val() + '></td><td><input type="date" name="tblpaymentDate" class="form-control input-sm" value=' + $("#paymentDate").val() + '></td><td><input type="text" name="tblRemarks" class="form-control input-sm" value=' + $("#Remarks").val() + '></td><td><input type="number" class=".total"  id="tblPaymentTotal" name="tblPaymentTotal"  class="form-control input-sm" value=' + $("#PaidAmt").val() + '></td><td><a href="#" class="fa fa-trash-o" aria-hidden="true" id="delrow" class="delrow"></td></tr>');

            }

            var Total ;

            var len = $("#tablepaymentAdd td").closest("tr").length;

            for (var row = 0; row < len; row++)
            {
                debugger
                Total += parseFloat(document.getElementById('paymentAdd').tBodies[0].rows[row].cells[5].children[0].value);

                $("#PaidAmount").val(Total)
            }

        })
       
        $("#btnEdit").click(function () {
            debugger
            $("#payAdd").show()
            //alert($("#Paytype").val());

            if ($("#Paytype").val() == "Cash")
            {
                // $("#paymentAdd tbody").append('<tr><td><input type="hidden" value="Cash" class="tblPaymentType" name="tblPaymentType"/>Cash</td><td><input type="hidden" value="Cash" name="tblNumber"/>Cash</td><td><input type="text"  name="tblName" readonly class="form-control input-sm" value="Cash"></td><td><input type="date" name="tblpaymentDate" class="form-control input-sm" value=' + $("#paymentDate").val() + '></td><td><input type="text" name="tblRemarks" readonly class="form-control input-sm" value=' + $("#Remarks").val() + '></td><td><input type="number" class=".total"  id="tblPaymentTotal" name="tblPaymentTotal"  class="form-control input-sm" value=' + $("#PaidAmount").val() + '></td><td><a href="#" class="fa fa-trash-o" aria-hidden="true" id="delrow" class="delrow"></td></tr>');
                $("#payAdd tbody").append('<tr><td><input type="hidden" class="tblPayEditType" value="Cash" name="tblPayEditType"/>CASH</td><td><input type="hidden"  value="Cash" name="tblEditNumber"/>Cash</td><td><input type="text"   name="tblEditName" readonly class="form-control input-sm" value="Cash"></td><td><input type="date" name="tblpayDateEdit" class="form-control input-sm" value=' + $("#payDate").val() + '></td><td><input type="text" readonly name="tblEditRemarks" class="form-control input-sm" value="Cash"></td><td><input type="number" class=".total"  id="tblPayEditTotal" name="tblPayEditTotal"  class="form-control input-sm" value=' + $("#PaidAmtpay").val() + '></td><td><a href="#" class="fa fa-trash-o" aria-hidden="true" id="delEdit" class="delEdit"></td></tr>');

            }
            else
            {
                $("#payAdd tbody").append('<tr><td><input type="hidden" class="tblPayEditType" value="' + $("#Paytype").val() + '" name="tblPayEditType"/>' + $("#Paytype").val() + '</td><td><input type="hidden" value="' + $("#No").val() + '" name="tblEditNumber"/>' + $("#No").val() + '</td><td><input type="text" name="tblEditName" readonly class="form-control input-sm" value="' + $("#Namepay").val() + '"></td><td><input type="date" name="tblpayDateEdit" class="form-control input-sm" value="' + $("#payDate").val() + '"></td><td><input type="text" name="tblEditRemarks" class="form-control input-sm" value="' + $("#payRemarks").val() + '"></td><td><input type="number" class=".total"  id="tblPayEditTotal" name="tblPayEditTotal"  class="form-control input-sm" value="' + $("#PaidAmtpay").val() + '"></td><td><a href="#" class="fa fa-trash-o" aria-hidden="true" id="delEdit" class="delEdit"></td></tr>');

            }

            $("#No").val("");
            $("#Namepay").val("");
            $("#payRemarks").val("");
            $("#PaidAmtpay").val("");
            $(".btn-group").hide();
          //  $("#chkTPA").attr("disabled", false);

            var Total = 0;

            var len = $("#tablepayAdd td").closest("tr").length;

            for (var row = 0; row < len; row++)
            {
                debugger
                Total += parseFloat(document.getElementById('payAdd').tBodies[0].rows[row].cells[5].children[0].value);

                $("#PaidAmtedit").val(Total)
            }

        })

        $("#paymentAdd").delegate('td', 'keyup', function () {
            debugger;
            var Total ;
            var len = $("#paymentAdd td").closest("tr").length;
            for (var row = 0; row < len; row++) {
                debugger
                Total += parseFloat(document.getElementById('paymentAdd').tBodies[0].rows[row].cells[5].children[0].value);

                $("#PaidAmount").val(Total)
            }
            var PaidAmount = $("#PaidAmount").val().replace("-", "");

            $("#PaidAmount").val(PaidAmount);
            var PreBalance = $("#PreBalanceAmount").val();
            $.ajax({
                type: "POST",
                url: '@Url.Action("Calculate", "PreBalanceAmount")',
                data: '{PaidAmount: ' + JSON.stringify(PaidAmount) + ',PreBalance:' + JSON.stringify(PreBalance) + '}',
                contentType: "application/json; charset=utf-8",
                success: function (search1) {
                    $("#BalanceAmount").val(search1[0]);
                },

            });

        });

        $("#paymentAdd").on('click', '#delrow', function () {
            debugger;
            $(this).closest('tr').remove();
            var Total = 0;

            var len = $("#paymentAdd td").closest("tr").length;
            if (len == 0) {
                $("#PaidAmount").val(0);
            }

            for (var row = 0; row < len; row++) {
                debugger
                Total += parseFloat(document.getElementById('paymentAdd').tBodies[0].rows[row].cells[5].children[0].value);

                $("#PaidAmount").val(Total)
            }
        })
        $("#payAdd").on('click', '#delEdit', function () {
            debugger;
            $(this).closest('tr').remove();
            $(".btn-group").show();
            var Total = 0;
          
            var len = $("#payAdd td").closest("tr").length;
            if (len == 0) {
                $("#PaidAmtedit").val(0);
            }

            for (var row = 0; row < len; row++) {
                debugger
                Total += parseFloat(document.getElementById('payAdd').tBodies[0].rows[row].cells[5].children[0].value);

                $("#PaidAmtedit").val(Total)
            }
        })
    })

    $(function () {
        var prebalance;
        var count = 0;
        $("#TdsAmount").keyup(function () {

            debugger
            if (count == 0) {
                prebalance = $("#PreBalanceAmount").val();
                count++;
            }

            var tdsamt = $("#TdsAmount").val();

            var result = prebalance - tdsamt;

            $("#PreBalanceAmount").val(result);

            PaidAmount();
        });
    });
    $(function () {
        var prebalance;
        var count = 0;
        $("#TDSAmtedit").keyup(function () {

            debugger
            if (count == 0) {
                prebalance = $("#PreBalanceAmount").val();
                count++;
            }

            var tdsamt = $("#TDSAmtedit").val();

            var result = prebalance - tdsamt;

            $("#PreBalanceAmount").val(result);

            PaidAmount();
        });
    });

    $(function () {
        var prebalance;
        var count = 0;
        $("#TPAOtherDeduction").keyup(function () {

            debugger
            if (count == 0) {
                prebalance = $("#PreBalanceAmount").val();
                count++;
            }

            var tdsamt = $("#TPAOtherDeduction").val();

            var result = prebalance - tdsamt;

            $("#PreBalanceAmount").val(result);

            PaidAmount();
        });
    });



    $(document).ready(function () {

        var paytype = document.getElementById("PaymentType1").value;
        var paymentType, numer, bankname, date, remark = "";
        $("#paymentbutton").click(function () {

            var select = document.getElementById("PaymentType1").value;
            paymentType += select + ",";
            numer += $("#Number").val() + ",";
            bankname += $("#Name").val() + ",";
            date += $("#paymentDate").val() + ",";
            remark += $("#Remarks").val() + ",";

            $("#Number1").val(numer);
            $("#Name1").val(bankname);
            $("#paymentDate1").val(date);
            $("#Remarks1").val(remark);
            $("#PaymentType1").val(paymentType);

            //alert($("#PaymentType1").val());

            $("#Number").val("");
            $("#Name").val("");
            // $("#paymentDate").val("");
            $("#Remarks").val("");
            $("#DoctorSaveDiv").hide(300);
        })
    })

    //$(document).ready(function () {

    //    var paytype = document.getElementById("PaymentType1").value;
    //    var paymentType, numer, bankname, date, remark = "";
    //    $("#paymentbutton").click(function () {

    //        var select = document.getElementById("PaymentType1").value;
    //        paymentType += select + ",";
    //        numer += $("#No").val() + ",";
    //        bankname += $("#Namepay").val() + ",";
    //        date += $("#payDate").val() + ",";
    //        remark += $("#payRemarks").val() + ",";

    //        $("#Number2").val("");
    //     $("#Name2").val("");
    //     $("#paymentDate2").val("");
    //     $("#Remarks2").val("");
    //     $("#PaymentType2").val("");

    //        //alert($("#PaymentType1").val());

    //     $("#No").val("");
    //     $("#Namepay").val("");
    //        // $("#paymentDate").val("");
    //     $("#payRemarks").val("");
    //        $("#PayMode").hide(300);
    //    })
    //})


    $(document).ready(function () {
        $("#PaidAmount").keyup(function () {
            var amt = $(this).val();
            $("#PaidAmt").val(amt)
        })
        $("#PaidAmt").keyup(function () {
            var amt = $(this).val();
            $("#PaidAmount").val(amt)
        })
        $("#DoctorSaveDiv").hide();
        $("#presentor tr").remove();
        $("#PaymentType").change(function () {
            debugger
          //  $("#PaidAmt").val($("#PaidAmount").val());
            $("#Number1").val("");
            $("#Name1").val("");
            $("#paymentDate1").val("");
            $("#Remarks1").val("");
            $("#PaymentType1").val("");
            $("#paymentAdd").show()

            var len = $("#tablepaymentAdd td").closest("tr").length;
            if (len > 0) {
                $("#paymentAdd").show()

                $(".tblPaymentType").each(function () {
                    if ($(this).val() == $("#PaymentType").val()) {
                        alert("Already Exits");
                        if ($("#PaymentType").val() == "Cash") {
                            $("#DoctorSaveDiv").show();
                        }
                        return false;
                    }

                })
            }
            var Total = 0;



            PaymentValueChange();
        })

        $('input[name=RadioCharge]').change(function () {

            document.getElementById("PaymentType").value = $(this).val();
            $("#Number1").val("");
            $("#Name1").val("");
            $("#paymentDate1").val("");
            $("#Remarks1").val("");
            $("#PaymentType1").val("");
            PaymentValueChange();
        })

    });





    $(document).ready(function () {
        $("#PayMode").hide();
       // $("#presentor tr").remove();
        $("#Paytype").change(function () {
            debugger
            $("#Number2").val("");
            $("#Name2").val("");
            $("#paymentDate2").val("");
            $("#Remarks2").val("");
            $("#PaymentType2").val("");
            $("#payAdd").show();
           
            var len = $("#tablepayAdd td").closest("tr").length;
            if (len > 0) {
                $("#payAdd").show()

                $(".tblPaymentType").each(function () {
                    if ($(this).val() == $("#Paytype").val()) {
                        alert("Already Exits");
                        if ($("#Paytype").val() == "CASH") {
                            $("#PayMode").show();
                        }
                        return false;
                    }

                })
            }
            var Total = 0;



            PaymentValueChange1();
        })

        $('input[name=Radio]').change(function () {
            debugger
        //    alert($(this).val());
            document.getElementById("Paytype").value = $(this).val();
            $("#Number2").val("");
            $("#Name2").val("");
            $("#paymentDate2").val("");
            $("#Remarks2").val("");
            $("#PaymentType2").val("");
          //  $("#payAdd").show()
            PaymentValueChange1();
        })

    });
    // $("#Number").val("") ;
    //$("#Name").val("") ;
    //$("#paymentDate").val("");
    //$("#Remarks").val("") ;

    function PaymentValueChange() {
        var select = document.getElementById("PaymentType").value;
        debugger
        switch (select) {
            case 'Cheque':
                $("#DoctorSaveDiv").show();
                $("#DoctorSaveDiv").show();
                $("#PaymentNo1").show();
                $("#paymentName1").show();
                $("#paymentDate1").show("Date");
                $("#Number").show();
                $("#Number").val("");
                $("#Name").val("");
                $("#Remarks").val("");
                $("#Name").show();
                $("#Remarks").show();
                $("#paymentDate1").show();
                $(".remk").show();
                $("#paymentRemark1").show();
                $("#paymentDate").show();
                //  $("#Cheque").prop('Checked', true);
                document.getElementById("Cheque").checked = true;
                $("#PaymentNo1").text("Cheque No");

                $("#paymentName1").text("Bank Name");

                $("#paymentDate1").text("Cheque Date");

                $("#paymentRemark1").text("Remark");
                break;


            case 'Debit Card':
                $("#DoctorSaveDiv").show();
           //     $("#DoctorSaveDiv").show();
                $("#PaymentNo1").show();
                $("#paymentName1").show();
                $("#paymentDate1").show("Date");
                $("#Number").show();
                $("#Name").show();
                $("#Number").val("");
                $("#Name").val("");
                $("#Remarks").val("");
                $(".remk").show();
                $("#Remarks").show();
                $("#paymentDate1").show();
                $("#paymentRemark1").show();
                $("#paymentDate").show();
                document.getElementById("Debit Card").checked = true;
                //  $("#Debit Card").prop('checked', 'checked');

                $("#PaymentNo1").text("Debit Card No");

                $("#paymentName1").text("Holder Name");

                $("#paymentDate1").text("Valid UPTO");

                $("#paymentRemark1").text("Remark");
                break;



            case 'Credit Card':
                $("#DoctorSaveDiv").show();
                $("#DoctorSaveDiv").show();
                $("#PaymentNo1").show();
                $("#paymentName1").show();
                $("#paymentDate1").show("Date");
                $("#Number").show();
                $("#Name").show();
                $("#Remarks").show();
                $("#Number").val("");
                $("#Name").val("");
                $("#Remarks").val("");
                $("#paymentDate1").show();
                $("#paymentRemark1").show();
                $("#paymentDate").show();
                $(".remk").show();
                // $("#Credit Card").prop('checked', true);
                document.getElementById("Credit Card").checked = true;
                $("#PaymentNo1").text("Credit Card No");

                $("#paymentName1").text("Holder Name");

                $("#paymentDate1").text("Valid UPTO");

                $("#paymentRemark1").text("Remark");
                break;
                debugger
            case 'E-Money':
                debugger
                $("#DoctorSaveDiv").show();
                $("#DoctorSaveDiv").show();
                $("#PaymentNo1").show();
                $("#paymentName1").show();
                $("#paymentDate1").show("Date");
                $("#Number").show();
                $("#Number").val("");
                $("#Name").val("");
                $("#Remarks").val("");
                $("#Name").show();
                $("#Remarks").show();
                $("#paymentDate1").show();
                $("#paymentRemark1").show();
                $("#paymentDate").show();
                // $("#E-money").prop('checked', true);
                document.getElementById("E-Money").checked = true;
                $("#PaymentNo1").text("Code");
                $("#paymentName1").text("Bank Name");
                $(".remk").show();
                $("#paymentDate1").text("Date");
                $("#paymentRemark1").text("Remark");
                break;

            case 'EFT':
                $("#DoctorSaveDiv").show();
                $("#PaymentNo1").show();
                $("#paymentName1").show();
                $("#paymentDate1").show("Date");
                $("#Number").show();
                $("#Name").show();
                $("#Remarks").show();
                $("#paymentDate1").show();
                $("#paymentRemark1").show();
                $("#paymentDate").show();
                $(".remk").show();
                //$("#EFT").prop('checked', true);
                document.getElementById("EFT").checked = true;

                $("#PaymentNo1").text("Code");

                $("#paymentName1").text("Bank Name");

                $("#paymentDate1").text("Date");

                $("#paymentRemark1").text("Remark");
                break;

            case 'CASH':

              //  $("#DoctorSaveDiv").show();
                document.getElementById("Cash").checked = true;

                //  $("#PaymentNo1").text("Code");
                //
                //  $("#paymentName1").text("Bank Name");
                $("#PaymentNo1").hide();
                $("#paymentName1").hide();
                $("#paymentDate1").text("Date");
                $("#Number").hide();
                $("#Name").hide();
                $("#Remarks").hide();
                $("#paymentDate1").hide();
                $("#paymentRemark1").hide();
                $(".remk").hide();
                $("#paymentDate").hide();
                
                // $("#paymentRemark1").text("Remark");
                break;
        }

    }
    function PaymentValueChange1() {
        var select = document.getElementById("Paytype").value;
        debugger
        switch (select) {
            case 'Cheque':
                $("#PayMode").show();
              
                $("#Pay1").show();
                $("#payName1").show();
                $("#payDate11").show("Date");
                $("#No").show();
                $("#No").val("");
                $("#Namepay").val("");
                $("#payRemarks").val("");
                $("#Namepay").show();
                $("#payRemarks").show();
                $("#payDate11").show();
                $("#payRemark1").show();
                $("#payDate").show();
                $("#ChequeEdit").prop('Checked', true);
                document.getElementById("ChequeEdit").checked = true;
                $("#Pay1").text("Cheque No");

                $("#payName1").text("Bank Name");

                $("#payDate11").text("Cheque Date");

                $("#payRemark1").text("Remark");
              //  $("#payAdd tbody tr").remove();
                break;


            case 'Debit Card':
                $("#PayMode").show();
                //     $("#DoctorSaveDiv").show();
                $("#Pay1").show();
                $("#payName1").show();
                $("#payDate11").show("Date");
                $("#No").show();
                $("#Namepay").show();
                $("#No").val("");
                $("#Namepay").val("");
                $("#payRemarks").val("");
                $("#payRemarks").show();
                $("#payDate11").show();
                $("#payRemark1").show();
                $("#payDate").show();
                document.getElementById("DebitCardEdit").checked = true;
                $("#DebitCardEdit").prop('checked', 'checked');

                $("#Pay1").text("Debit Card No");

                $("#payName1").text("Holder Name");

                $("#payDate11").text("Valid UPTO");

                $("#payRemark1").text("Remark");
              //  $("#payAdd tbody tr").remove();
                break;



            case 'Credit Card':
                $("#PayMode").show();

                $("#Pay1").show();
                $("#payName1").show();
                $("#payDate11").show("Date");
                $("#No").show();
                $("#Namepay").show();
                $("#payRemarks").show();
                $("#No").val("");
                $("#Namepay").val("");
                $("#payRemarks").val("");
                $("#payDate11").show();
                $("#payRemark1").show();
                $("#payDate").show();
                $("#CreditCardEdit").prop('checked', true);
                document.getElementById("CreditCardEdit").checked = true;
                $("#Pay1").text("Credit Card No");

                $("#payName1").text("Holder Name");

                $("#payDate11").text("Valid UPTO");

                $("#payRemark1").text("Remark");
             //   $("#payAdd tbody tr").remove();
                break;
                debugger
            case 'E-Money':
                debugger
                $("#PayMode").show();

                $("#Pay1").show();
                $("#payName1").show();
                $("#payDate11").show("Date");
                $("#No").show();
                $("#No").val("");
                $("#Namepay").val("");
                $("#payRemarks").val("");
                $("#Namepay").show();
                $("#payRemarks").show();
                $("#payDate11").show();
                $("#payRemark1").show();
                $("#payDate").show();
                $("#E-MoneyEdit").prop('checked', true);
                document.getElementById("E-MoneyEdit").checked = true;
                $("#Pay1").text("Code");
                $("#payName1").text("Bank Name");
                $("#payDate11").text("Date");
                $("#payRemark1").text("Remark");
            //    $("#payAdd tbody tr").remove();
                break;

            case 'EFT':
                $("#PayMode").show();
                $("#Pay1").show();
                $("#payName1").show();
                $("#payDate11").show("Date");
                $("#No").show();
                $("#Namepay").show();
                $("#payRemarks").show();
                $("#payDate11").show();
                $("#payRemark1").show();
                $("#payDate").show();
                $("#EFTEdit").prop('checked', true);
                document.getElementById("EFTEdit").checked = true;

                $("#Pay1").text("Code");

                $("#paymentName1").text("Bank Name");

                $("#payDate11").text("Date");

                $("#payRemark1").text("Remark");
              //  $("#payAdd tbody tr").remove();
                break;

            case 'CASH':

             //   $("#PayMode").show();
                document.getElementById("CashEdit").checked = true;

                $("#Pay1").hide();
                $("#payName1").hide();
                $("#payDate11").text("Date");
                $("#No").hide();
                $("#Namepay").hide();
                $("#payRemarks").hide();
                $("#payDate11").hide();
                $("#payRemark1").hide();
                $("#payDate").hide();
                 $("#paymentRemark1").text("Remark");
                break;
        }

    }
    var BillType = "";
    $(document).ready(function () {
        $("#delModalClose").click(function () {
            $("#delModal").modal('hide');
        })
        $("#DoctorSaveDiv").on('click', '#ClosePaymentMode', function () {
          
        //$("#ClosePaymentMode").click(function () {
            debugger
            $("#payAdd tbody tr").remove();
        })
        $("#presentor").on('click', '#EditID', function () {
            debugger;
            $("#deleteModal").modal('show');
            $('#deleteModalClose').click(function () {
                $("#deleteModal").modal('hide');
            })

            var row = $(this).closest('tr').index();
            var PaidAmt = 0;
           
            var RegNo = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[10].innerHTML;
            var BillNo = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[4].innerHTML;
            var PatientaccountRowID = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[12].innerHTML;
            var PrintRegNo = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[13].innerHTML;
            var BillDate = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[8].innerHTML;
            var OPDIPDNO = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[1].innerHTML;
                BillType = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[2].innerHTML;
            var PayType = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[11].innerHTML;
            var TDSAt = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[6].innerHTML;
            var TDSOther = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[7].innerHTML;
            var Patienttype = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[16].innerHTML;
            var OPDIPDReal = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[17].innerHTML;
           // alert(Patienttype);
            var PatientName = $("#PatientName").val();
            $("#PatientaccRowID").val(PatientaccountRowID);
            $("#PatName").text(PatientName);
            $("#Bill").val(BillType);
            //alert($("#Bill").val());
            // alert(PatientaccountRowID);
            $("#IDOPD").text(PrintRegNo);
            $("#OPDIPDID").text(OPDIPDNO);
            debugger
            var a = OPDIPDNO.split(" ");
           var t= OPDIPDReal + '-' + Patienttype;
            //var i = OPDIPDNO.selectedIndex;
           //alert(OPDIPDReal);
            //var selected_text = sel.options[i].text;
           $("#OPDIPDNO").val(OPDIPDReal+ '-' +Patienttype);
           // '<option  value =' + BillType_OPDIPDNo + '>' + BillType_OPDIPDNo + '</option>'
            if (document.getElementById('chkTPA').checked==true)
            {
                $("#TDS").show();
                $("#TDSdec").show();
                $("#TDSAmtedit").show();
                $("#TDSOtherdecdit").show();
                $("#TDSAmtedit").val(TDSAt);
                $("#TDSOtherdecdit").val(TDSOther);
                $("#TDSAmtType").show();
            }
            else
                
            {
                $("#TDS").hide();
                $("#TDSdec").hide();
                $("#TDSAmtedit").hide();
                $("#TDSOtherdecdit").hide();
                $("#TDSAmtType").hide();
            }
           
           debugger
            var date = BillDate.split("-");
            //alert(date);
            var t = date[2].toString() + "-" + date[1].toString() + "-" + date[0].toString();
           // alert(t);
            $("#editModalDate").val(t);
        //    alert(PayType);
          debugger
            if (BillType == "IPD SecurityDeposit RefundBills")
            {
                 PaidAmt = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[4].innerHTML;
            }
            else
            {
                PaidAmt = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[5].innerHTML;
               
            }
            debugger
            if (BillType == "IPD RefundBills" || BillType == "OPD RefundBills")
            {
                PaidAmt = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[4].innerHTML;
            }
            else
            {
                PaidAmt = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[5].innerHTML;

            }

            $("#PaidAmtedit").val(PaidAmt);
           // alert(PayType);
            $("#Paytype").val(PayType);

            $("#PaidAmtpay").val(PaidAmt);
           // alert($("#OPDIPDID").val());


            @*if (BillType == "IPDFinalBill" || BillType == "IPDBill") {
                var ans = confirm("Are you sure you want to delete this Record?");

                if (ans) {
                    //  window. = '@Url.Action("PaymentAndDeposit", "PaymentAndDeposit")?Reg=' + RegNo
                    localStorage.setItem('BillNo', BillNo);
                    localStorage.setItem('BillType', BillType);
                    window.open('@Url.Action("IPDBill", "IPDBill")?BillNo=' + BillNo);
                }

            }
            if (BillType == "OPDBill") {
                var ans = confirm("Are you sure you want to delete this Record?");
                if (ans) {
                    localStorage.setItem('BillNo', BillNo);
                    localStorage.setItem('BillType', BillType);
                    window.open('@Url.Action("OPDBill", "OPDBill")?BillNo=' + BillNo);
                }  
            }*@



        })
        $("#presentor").on('dblclick', '#tbltd', function () {
            debugger;
            var row = $(this).closest('tr').index();

            var BillType = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[2].innerHTML;
            var RegNo = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[10].innerHTML;
            var BillNo = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[4].innerHTML;
          //  $("#deleteModal").modal('show');
            //$('#deleteModalClose').click(function () {
            //    $("#deleteModal").modal('hide');
            //})
            if (BillType == "IPDFinalBill" || BillType == "IPDBill") {
                var ans = confirm("Are you sure you want to delete this Record?");
               
                if (ans) {
                    //  window. = '@Url.Action("PaymentAndDeposit", "PaymentAndDeposit")?Reg=' + RegNo
                    localStorage.setItem('BillNo', BillNo);
                    localStorage.setItem('BillType', BillType);
                    window.open('@Url.Action("IPDBill", "IPDBill")?BillNo=' + BillNo);
                }

            }
            if (BillType == "OPDBill") {
                var ans = confirm("Are you sure you want to delete this Record?");
                if (ans) {
                    localStorage.setItem('BillNo', BillNo);
                    localStorage.setItem('BillType', BillType);
                    window.open('@Url.Action("OPDBill", "OPDBill")?BillNo=' + BillNo);
                }
            }

           @*if (BillType == "OPDLabBills") {
               var ans = confirm("Are you sure you want to delete this Record?");
               if (ans) {
                   localStorage.setItem('BillNo', BillNo);
                   localStorage.setItem('BillType', BillType);
                   window.open('@Url.Action("PatientLabBills", "PatientLabBills")?BillNo=' + BillNo);
               }
           }*@

           })
        $("#presentor").on('click', '#print', function () {
            debugger;
            var row = $(this).closest('tr').index();
            var BillType = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[2].innerHTML;
            var OPDIPDNO = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[17].innerHTML;
            //alert(OPDIPDNO);
            var PatientAccountRowID = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[12].innerHTML;
            var RegNo = $("#PatientRegNO").val();
            if (BillType == "OPD PreBalanceBills" || BillType == "IPD PreBalanceBillsTPA" || BillType == "IPD PreBalanceBills" || BillType == "IPD SecurityDeposit PreBalanceBills")
            {

                window.open('@Url.Action("RptbtnPreBalanceAmount", "PreBalanceAmount")?PatientAccountRowID=' + PatientAccountRowID + '&BillType=' + BillType + '&RegNo=' + RegNo + '&OPDIPDNO=' + OPDIPDNO);
            }
            debugger
            if (BillType == "OPD RefundBills" || BillType == "IPD RefundBills")
            {
                debugger

                window.open('@Url.Action("RptRefundAmount1", "PaymentAndDeposit")?PatientAccountRowID=' + PatientAccountRowID + '&BillType=' + BillType + '&RegNo=' + RegNo + '&OPDIPDNO=' + OPDIPDNO);
            }
            if (BillType == 'Admission')
            {
                window.open('@Url.Action("RptPatientIPDAdvanceAmount", "PreBalanceAmount")?PatientAccountRowID=' + PatientAccountRowID + '&BillType=' + BillType + '&RegNo=' + RegNo + '&OPDIPDNO=' + OPDIPDNO);
            }
            if (BillType == "IPDFinalBill" || BillType == "IPDBill")
            {
                var BillNo = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[9].innerHTML;
                var UserData = { IPDNo: OPDIPDNO, BillType: BillType, BillNo: BillNo, RegNo: RegNo }
                $.ajax({
                    url: '@Url.Action("OldBillReport", "IPDBill")',
                    dataType: "json",
                    type: 'POST',
                    data: JSON.stringify(UserData),
                    traditional: true,
                    contentType: 'application/json',
                    success: function (data)
                    {
                        debugger
                        if (BillType == "IPDBill")
                        {
                            window.open('@Url.Action("RptPatientIPDBill", "IPDBill")');
                        }
                        if (BillType == "IPDFinalBill")
                        {
                            window.open('@Url.Action("RptPatientIPDFinalBillsSummaryNew", "PatientReport")');
                        }

                        if (BillType == "Provisional")
                        {
                            window.open('@Url.Action("RptPatientIPDProvisionalBills", "PatientReport")');
                        }
                    }
                });

            }

            if (BillType == "OPDBill")
            {
                var BillNo = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[9].innerHTML;
                var UserData = { BillNo: BillNo }
                $.ajax({
                    url: '@Url.Action("OldBillReport", "OPDBill")',
                    dataType: "json",
                    type: 'POST',
                    data: JSON.stringify(UserData),
                    traditional: true,
                    contentType: 'application/json',
                    success: function (data)
                    {
                        debugger
                        window.open('@Url.Action("RptPatientOPDBills", "PatientReport")');

                    }
                });

            }
        })



        @*var BillType_OPDIPDNo = localStorage.getItem('BillType_OPDIPDNo');

        if (BillType_OPDIPDNo != null) {
            if (BillType_OPDIPDNo.length > 3) {
                debugger
                var UserData = { OPDIPDNo: BillType_OPDIPDNo }
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetRefoundAmountOPDIPD", "PreBalanceAmount")',
                    data: JSON.stringify(UserData),
                    contentType: "application/json; charset=utf-8",
                    success: function (search) {
                        debugger;

                        $("#PatientRegNO").val(search[0].P_RegNo);
                        $("#PatientName").val(search[0].PatientName);
                        $("#presentor tr").remove();
                        $("#PreBalanceAmount").val(search[0].BalanceAmount);
                        $("#OPDIPDNO").val(BillType_OPDIPDNo);
                        $("#OPDIPDNO").text(BillType_OPDIPDNo);

                        $("#OPDIPDNO").append('<option  value =' + BillType_OPDIPDNo + '>' + BillType_OPDIPDNo + '</option>');

                        for (var i = 0; i < search.length; i++) {
                            $("#presentor").append('<tr><td> <i id="print" class="fa fa-print"></i></td><td> ' + search[i].OPDIPDNO + '</td><td>' + search[i].BillType + '</td><td>' + search[i].DrAmount + '</td><td>' + search[i].P_BillNo + '</td><td>' + search[i].CrAmount + '</td><td>' + search[i].TDSAmount + '</td><td>' + search[i].TPAOtherDeduction + '</td><td>' + search[i].BillDate + '</td><td>' + search[i].BillNo + '</td><td>' + search[i].P_RegNo + '</td><td>' + search[i].PaymentType + '</td><td>' + search[i].OPDIPDID + '</td><td>' + search[i].PatientAccountRowID + '</td><td><button type="button" id="tbltd" class="ss btndivcss openDeleteModal" onclick="del(' + search[i].PatientAccountRowID + ')" value="Delete"><span class="buttoniconcss"></span>Delete</button></td></tr>');
                        }
                        localStorage.setItem('BillType_OPDIPDNo', "");

                        TableBind();
                    },
                });

            }
        }*@
        $("#OPDIPDNO").change(function () {
            debugger
            var OPDIPDNo = $(this).val();

            var sel = document.getElementById("OPDIPDNO");

            var i = sel.selectedIndex;
            var selected_text = sel.options[i].text;

            if (selected_text == "---All---") {
                FillRegNo();
                return false;
            }
            var UserData = { OPDIPDNo: OPDIPDNo }
            debugger
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetRefoundAmountOPDIPD", "PreBalanceAmount")',
                data: JSON.stringify(UserData),
                contentType: "application/json; charset=utf-8",
                success: function (search) {
                    debugger;
                    //if (search!=[])
                    //{
                    //    debugger
                    //    return false;
                    //}
                    //else

                    //{
                        
                        debugger
                        $("#presentor tr").remove();
                        debugger
                       
                        if (search.length>0) {
                            debugger
                            $("#PreBalanceAmount").val(search[0].BalanceAmount);
                            if (parseFloat(search[0].BalanceAmount) < 0) {
                              
                                debugger
                                //alert("Deposit");
                                $("#btnpaid").hide();
                                $("#pre").text("Deposit Amt")

                                $("#pre").css("color", "blue");

                                //var pre_balance = $("#pre_balance").val().replace("-", "");
                                // $("#pre_balance").val(pre_balance)

                                // $("#Deposit").val(pre_balance);
                                // $("#pre_balance").attr('value', Deposit);
                            }
                            else {
                                debugger
                                $("#pre").text("Pre Bal. Amt.");
                                $("#pre").css("color", "black");
                                $("#btnpaid").show();

                            }
                        }
                        else
                        {
                            $("#PreBalanceAmount").val(0.00);
                            $("#pre").text("Pre Bal. Amt.");
                            $("#pre").css("color", "black");
                            $("#btnpaid").show();
                        }
                    debugger
                        for (var i = 0; i < search.length; i++)
                        {
                            debugger
                            var BillType = search[i].BillType
                            var hidden = "";
                            if (BillType == "IPDLabBills" || BillType == "IPDFinalBill" || BillType == "IPDBill" || BillType == "OPDBill")
                            {
                                hidden = "hidden";
                                //  $(this).parent().find('#tbltd').remove();

                            }
                           
                            $("#presentor").append('<tr><td> <i id="print" class="fa fa-print"></i></td><td> ' + search[i].OPDIPDNO + '</td><td>' + search[i].BillType + '</td><td>' + search[i].P_BillNo + '</td><td>' + search[i].DrAmount + '</td><td>' + search[i].CrAmount + '</td><td class="tparate">' + search[i].TDSAmount + '</td><td class="tparate">' + search[i].TPAOtherDeduction + '</td><td>' + search[i].BillDate + '</td><td style="display:none">' + search[i].BillNo + '</td><td style="display:none"><input type="text" value="' + search[i].PatientRegNo + '"></td><td>' + search[i].PaymentType + '</td><td>' + search[i].PatientAccountRowID + '</td><td  style="display:none">' + search[i].P_RegNo + '</td><td><button type="button" id="EditID" class="ss btndivcss openDeleteModal" value="Edit"><span class="buttoniconcss"></span>Edit</button></td><td><button type="button" id="tbltd" class=" ' + hidden + ' ss btndivcss" onclick = "del(\'' + search[i].PatientAccountRowID + '\',\'' + search[i].BillType + '\')" value="Delete"><span class="hidden buttoniconcss"></span>Delete</button></td><td style="display:none">' + search[i].PatinetType + '</td><td style="display:none">' + search[i].OPDIPDID + '</td></tr>');

                        }
                        debugger
                        var chk = document.getElementById('chkTPA');
                        if (chk.checked) {

                        $("#tpadsc").show();
                        $("#tpaamt").show();
                        $(".tparate").show();

                    }
                    else {

                        $("#TPAAmt").hide();
                        $("#TDsAmt").hide();
                        $(".tparate").hide();
                        // $("#presentor").append('<tr><td> <i id="print" class="fa fa-print"></i></td><td> ' + search[i].OPDIPDNO + '</td><td>' + search[i].BillType + '</td><td>' + search[i].DrAmount + '</td><td style="display:none">' + search[i].P_BillNo + '</td><td>' + search[i].CrAmount + '</td><td id="tpaamt" name="tpaamt">' + search[i].TDSAmount + '</td><td id="tpadsc" name="tpadsc">' + search[i].TPAOtherDeduction + '</td><td>' + search[i].BillDate + '</td><td>' + search[i].BillNo + '</td><td style="display:none"><input type="text" value="' + search[i].PatientRegNo + '"></td><td>' + search[i].PaymentType + '</td><td>' + search[i].PatientAccountRowID + '</td><td  style="display:none">' + search[i].P_RegNo + '</td><td><button type="button" id="EditID" class="ss btndivcss openDeleteModal" value="Edit"><span class="buttoniconcss"></span>Edit</button></td><td><button type="button" id="tbltd" class=" ' + hidden + ' ss btndivcss" onclick = "del(\'' + search[i].PatientAccountRowID + '\',\'' + search[i].BillType + '\')" value="Delete"><span class="hidden buttoniconcss"></span>Delete</button></td></tr>');

                    }
                    //
              //      TablePrint();
                    TableBind();
                },
            });
           
        })

        //$("#chkAllpaidAmt").change(function () {

        //    if ($(this).prop("checked") == true) {
        //        $("#PaidAmount").val($("#PreBalanceAmount").val());
        //        PaidAmount();
        //    }
        //    else {
        //        $("#PaidAmount").val(0);
        //        PaidAmount();
        //    }
        //})
        $("#PatientName").click(function () {
            $('#patientNameTable').slideDown();
        })
        $.ajax({
            url: '@Url.Action("GetIPDPatient", "PreBalanceAmount")',
            contentType: "application/json; charset=utf-8",
            type: "GET",
            dataType: "json",
            data: { prefix: "%", outside: false },
            success: function (result) {
                debugger
                $.each(result, function (i, obj) {
                    $("#patientNameTable").append('<tr><td>' + obj.PrintRegNO + '</td><td style="display:none">' + obj.patientregNo + '</td><td>' + obj.patientname + '</td><td>' + obj.address + '</td><td>' + obj.contactno + '</td></tr>')

                });
                debugger
            }
        });
        $("#patientNameTable").delegate('td', 'click', function () {
            debugger;
            var row = $(this).parent().index();
            var Print = document.getElementById('patientNameTable').tBodies[0].rows[row].cells[0].innerHTML;
            //alert(Print);
            $("#PrintRegNO").val(Print);
            $("#PrintRegNO").change();
            $('#patientNameTable').slideUp();

        });
        $("#PatientName").on("keyup", function () {
            debugger
            var value = $(this).val().toLowerCase();
            $("#patientNameTable tbody tr").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
        $("#pre").text("Pre Bal. Amt.");
        $("form").submit(function () {
            debugger
            //var name = $(this).prop("id");
            //return false;
            var sel = document.getElementById("OPDIPDNO");
            var i = sel.selectedIndex;
            var selected_text = sel.options[i].text;
            if (selected_text == "---All---")
            {

                //var chkAll = $("#chkAllpaidAmt").prop("checked")
                //if (chkAll == true)
                //{
                //    return true;
                //}
                alert("Select OPD/IPD No")
                return false;
            }
            //$("#Mode").attr("disabled", true);
            $("#chkTPA").attr("disabled", false);
          //  $("#Mode").val("Add");
          

        });
       // $("#Mode").val("Add");
        $("#EditSave").click(function () {
            debugger
          
            $("form").submit();
            $("#Mode").val("Edit");
            $("#PatientaccRowID").val();
           
           
           // alert($("#Bill").val());
         //   alert($("#PatientaccRowID").val());
          //  $("#EditSave").attr("type", "submit");
          
            //{
            //    $("#Mode").val("Add");
            //}
            //else
            //{
             
            //}

        });

        
        $("#pre").click(function () {
            debugger

            var a = $("#priPalanceDeposit").text().trim();
            if ($(this).text().trim() != "Pre Bal. Amt." && $(this).text().trim() != "Pre Bal. Amt.") {
                var sel = document.getElementById("OPDIPDNO");
                var i = sel.selectedIndex;
                var selected_text = sel.options[i].text;
                if (selected_text == "---All---") {

                    alert("Select OPD/IPD No")
                    return false;
                }
                else {
                    var IPDNo = $("#OPDIPDNO").val().trim().replace("-", ",");
                    window.open('@Url.Action("PaymentAndDeposit", "PaymentAndDeposit")?IPDNo=' + IPDNo);
                }
                @*if ('@TempData["Reg"]' != "") {


                    window.location.href = '@Url.Action("PaymentAndDeposit", "PaymentAndDeposit",new{Reg=TempData["Reg"]})'
                }*@
            }

        })
    })
    //function TablePrint() {
    //    debugger
    //    var row = 0;
    //    $("#print").each(function () {
    //        debugger

    //        var BillType = document.getElementById('datatableAccountDetail').tBodies[0].rows[row].cells[2].innerHTML;
    //        if (BillType == "Admission")
    //        {

    //            //  $(this).parent().find('#tbltd').remove();
    //            $(this).css('display','none');
    //        }
    //        row++;
    //    }
    //    )
    //}
    function TableBind() {
        debugger
        var row = $("#datatableAccountDetail tbody tr").length;
        for(var i=0; i<row;i++)
        {
            BillType = document.getElementById('presentor').rows[i].cells[2].innerHTML;
           // alert(BillType); //IPDLabBills
            
            if (BillType == "Admission" || BillType == "IPDFinalBill" || BillType == "IPDBill" || BillType == "OPDBill" || BillType == "OPDLabBills" || BillType =="IPDLabBills") {
                document.getElementById('presentor').rows[i].cells[14].children[0].style = "display:none;"
                document.getElementById('presentor').rows[i].cells[15].children[0].style = "display:none;"
               // document.getElementById('presentor').rows[i].cells[13].
                //  $(this).parent().find('#tbltd').remove();
                //$(this).css('display', 'none');
            }
        }


        //var row = 0;
      
    }
</script>
<script>
    $(document).ready(function () {
        $("#ClosePaymentType").click(function () {
            debugger
            $("#DoctorSaveDiv").hide();
        })
        $("#ClosePaymentMode").click(function () {
            debugger
            $("#PayMode").hide();
        })

    });
</script>

<script>

    $(document).ready(function () {
        debugger
        $("#tdsamtsel").change(function () {
            if ($("#tdsamtsel").val() == "%") {
                $("#TdsAmCal").show();
            }
            else {
                $("#TdsAmCal").hide();
            }


            

        })
        $('#TdsAmCal').keyup(function () {
            debugger
            if ($(this).val() == "" || $(this).val() > 100) {
                if ($(this).val() > 100) {
                    alert("Discount Percent Can not Be Greater Than 100")
                    $(this).val("");
                }
                $(this).val("");

            }
            debugger

            var discperc = $('#TdsAmCal').val();
            var tot = $("#PreBalanceAmount").val();
            var oneperc = (parseFloat(tot));
            var disamt = (parseFloat(oneperc) * (parseFloat(discperc)).toFixed(2))/100;
      //    alert(disamt);
           // $("#TdsAmount").val(dis);
           // var net = parseFloat(tot) - parseFloat(disamt);
            var dis = Math.round(disamt);
            $("#TdsAmount").val(dis);
           
           

        });
        $('#TDSAmtcaledit').keyup(function () {
            debugger
            if ($(this).val() == "" || $(this).val() > 100) {
                if ($(this).val() > 100) {
                    alert("Discount Percent Can not Be Greater Than 100")
                    $(this).val("");
                }
                $(this).val("");

            }
            debugger

            var discperc = $("#TDSAmtcaledit").val();
            var tot = $("#PreBalanceAmount").val();
            var oneperc = parseFloat(tot);
            var disamt = (parseFloat(oneperc) * (parseFloat(discperc)).toFixed(2)) / 100;
            var dis = Math.round(disamt);
            $("#TDSAmtedit").val(dis);




        });

        $("#TDSAmtType").change(function ()
        {
            if ($("#TDSAmtType").val() == "%")
            {
                $("#TDSAmtcaledit").show();
            }
            else
            {
                $("#TDSAmtcaledit").hide();
            }

        })
        $.ajax({
            //url: "/PatientOPDBill/GetAllFinancialYear",
            url: '@Url.Action("GetAllFinancialYear", "PatientLabBills")',
            type: "GET",
            data: {},
            dataType: "json",
            success: function (data) {
                debugger;
                $(data).each(function (index, d) {
                    $("#FinancialYear").append($("<option value=" + d.FinancialYear + ">" + d.FinancialYear + "</option>"));
                    $("#FinancialYearID").val(data[0].FinancialYearID);
                });
            },
            error: function (data) {
            }
        });
    });
</script>

<body class="hold-transition skin-blue sidebar-mini">
    <div class="wrapper">
        <div>
            <input type="hidden" id="SecurityDeposityID" name="SecurityDeposityID" />
            <input type="hidden" id="Number1" name="Number1" />
            <input type="hidden" id="Name1" name="Name1" />
            <input type="hidden" id="Date1" name="Date1" class="form-control" />
            <input type="hidden" id="Remarks1" name="Remarks1" />
            <input type="hidden" id="PaymentType1" name="PaymentType1" />
        </div>
        <div>
            <input type="hidden" id="SecurityDeposityID2" name="SecurityDeposityID2" />
            <input type="hidden" id="Number2" name="Number2" />
            <input type="hidden" id="Name2" name="Name2" />
            <input type="hidden" id="Date2" name="Date2" class="form-control" />
            <input type="hidden" id="Remarks2" name="Remarks2" />
            <input type="hidden" id="PaymentType2" name="PaymentType2" />
        </div>
       
        <form id="form"  action="" method="post">
            <input type="hidden" id="PatientAccountRowID" name="PatientAccountRowID">
            <div class="content-wrapper">
                <section class="content-header">
                    <div class="container-fluid">
                        <div class="row mb-2">
                            <div class="col-sm-6">
                                <h1>Payment & Deposit</h1>
                            </div>
                            <div class="col-sm-6">
                                <ol class="breadcrumb float-sm-right">
                                    <li class="breadcrumb-item"><a href="@Url.Action("Dashboard","Home")">Home</a></li>
                                    <li class="breadcrumb-item"><a href="@Url.Action("Patient", "Application")">Patient Module</a></li>
                                    <li class="breadcrumb-item active">Payment & Deposit</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                    <input type="hidden" id="Bill" name="Bill" />
                </section>
                <section class="content">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                <div class="card card-primary panel-primary">
                                    <h2 class="panelheading">Patient Information</h2>
                                    <div class="card-body panel-body">
                                        <div class="row">
                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <!--UHID Number-->
                                                <div class="form-group col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <label>UHID No.</label>
                                                    </div>
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <input type="hidden" id="FinancialYearID" name="FinancialYearID">
                                                        <select id="FinancialYear" name="FinancialYear" class="form-control" disabled></select>
                                                    </div>
                                                        <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                            <input type="number" id="PrintRegNO" name="PrintRegNO" class="form-control">
                                                            <input type="hidden" id="PatientRegNO" name="PatientRegNO" class="form-control">
                                                            
                                                        </div>
                                                    </div>
                                                <!--Patient Name-->
                                                <div class="form-group col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <label>Patient Name</label>
                                                    </div>
                                                    <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                        <input type="text" id="PatientName" name="PatientName" class="form-control">
                                                        <div class="patientTableDiv table-responsive" style="position: absolute;z-index: 100;max-height: 250px;overflow: scroll;background-color: #ffffff;border: 0;box-shadow: 10px 10px 10px -6px #797979;">
                                                            <table id="patientNameTable" class="table table-bordered display table-hover table-head-fixed" style="width: 100%; display:none;">
                                                                <thead>
                                                                    <tr>
                                                                        <th style="background-color: #bddff7;">UHID No.</th>
                                                                        <th style="display:none">Print Reg No.</th>
                                                                        <th style="background-color: #bddff7;">Pt.Name</th>
                                                                        <th style="background-color: #bddff7;">Address</th>
                                                                        <th style="background-color: #bddff7;">Mobile No.</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <!--Date /Time-->
                                                <div class="form-group col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <label>Date /Time</label>
                                                    </div>
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <input type="date" name="BillDate" id="datepicker" required value="@DateTime.Now.ToString("yyyy-MM-dd")" max="9999-12-31" class="form-control">
                                                    </div>
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <input type="time" name="time" id="datepicker" value="@DateTime.Now.ToString("hh:mm")" class="form-control">
                                                    </div>
                                                </div>
                                                <!--TPA-->
                                                <div class="form-group col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <label>TPA</label>
                                                    </div>
                                                    <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12">
                                                        <div class="form-check-inline">
                                                            <label class="form-check-label">
                                                                <input type="checkbox" id="chkTPA" name="chkTPA" class="form-check-input" value="true" disabled>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <!--OPD IPD Number-->
                                                <div class="form-group col-lg-6 col-md-12 col-sm-12 col-xs-12" style="display:none">
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <label>OPD IPD No</label>
                                                    </div>
                                                    <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                        <input type="text" name="BillDate" id="datepicker" class="form-control">
                                                    </div>
                                                </div>
                                                <!--Security Deposite TPA-->
                                                <div id="Secdep" class="form-group col-lg-6 col-md-12 col-sm-12 col-xs-12" style="display:none">
                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                        <label>Security Deposite TPA</label>
                                                    </div>
                                                    <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12">
                                                        <div class="form-check-inline">
                                                            <label class="form-check-label">
                                                                <input type="checkbox" id="SecurityDepositeTPA" name="SecurityDepositeTPA" class="form-check-input">Security Deposite TPA
                                                            </label>
                                                            @*<label class="form-check-label">
                                                                <input type="checkbox" id="SecurityDepoRefundTPA" name="SecurityDepoRefundTPA" class="form-check-input">Security Deposite TPA Refund
                                                            </label>*@
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row ">
                            <div class="col-lg-9 col-md-12 col-sm-12 col-xs-12">
                                <div class="table-responsive">
                                    <table id="datatableAccountDetail" class="table table-bordered hover display table-hover" role="grid" style="width: 100%">
                                        <thead style="background-color: #bddff7;">
                                            <tr>
                                                <th>Print<i class="print"></i></th>
                                                <th>OPD/IPD NO.</th>
                                                <th>Bill Type</th>
                                                <th>Bill No.</th>
                                                <th>Debit Amt.</th>
                                               
                                                <th>Credit Amt.</th>
                                                <th id="TDsAmt" name="TDsAmt">TDS Amt.</th>
                                                <th id="TPAAmt" name="TPAAmt">TPA Other Deduction</th>
                                                <th>Date</th>
                                                <th style="display:none">Bill No.</th>
                                                <th style="display:none">UHID. No.</th>
                                                <th>Payment Type</th>
                                                @*<th>OPD/IPD ID</th>*@
                                                <th>Receipt No.</th>
                                                <th style="display:none">UHID. No.</th>
                                                <th>Edit</th>
                                                <th>Delete</th>
                                                <th style="display:none">Patient Type</th>
                                            </tr>
                                        </thead>
                                        <tbody id="presentor" class="scrollbar"></tbody>
                                    </table>

                                    <!-- Modal -->
                                    <div class="modal" id="deleteModal" role="dialog">
                                        <div class="modal-dialog modal-lg">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h4 class="modal-title">Action</h4>
                                                    <button type="button" class="close" id="deleteModalClose">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <div class="row">
                                                        <!-- Details -->
                                                        <div class="form-group col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                            <label>Patine Name</label>
                                                            <label id="PatName" name="PatName"></label>
                                                        </div>
                                                        <div class="form-group col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                            <label>UHID No.</label>
                                                            <label id="IDOPD" name="IDOPD"></label>
                                                            <input type="hidden" id="PatientaccRowID" name="PatientaccRowID" />
                                                        </div>
                                                        <div class="form-group col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                            <label>OPDIPDNo.</label>
                                                            <label id="OPDIPDID" name="OPDIPDID"></label>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <!-- Date -->
                                                        <div class="form-group col-lg-4 col-md-6 col-sm-12 col-xs-12">
                                                            <label>Date</label>
                                                            <input type="date" id="editModalDate" name="editModalDate" value="@DateTime.Now.ToString("yyyy-MM-dd")"  max="9999-12-31" class="form-control">
                                                        </div>
                                                        <!-- Time -->
                                                        <div class="form-group col-lg-4 col-md-6 col-sm-12 col-xs-12">
                                                            <label id="PaidAedit">Paid Amt.</label>
                                                            <input value="" type="number" id="PaidAmtedit" class="form-control" name="PaidAmtedit" placeholder="">
                                                        </div>
                                                        @*<div class="form-group col-lg-4 col-md-6 col-sm-12 col-xs-12">
                                                            <label>Time</label>
                                                            <input type="time" id="editModalTime" name="editModalTime" value="@DateTime.Now.ToString("hh:mm")" class="form-control">
                                                        </div>*@
                                                        <!--Paid Amount-->
                                                        <div class="form-group col-lg-4 col-md-6 col-sm-12 col-xs-12">
                                                            <label id="paymentRemark2">PaymentType</label>
                                                            <select class="form-control" id="Paytype" name="Paytype">
                                                                <option value="Cash">Cash</option>
                                                                <option value="Cheque">Cheque</option>
                                                                <option value="Credit Card">Credit Card</option>
                                                                <option value="Debit Card">Debit Card</option>
                                                                <option value="E-Money">E-Money</option>
                                                                <option value="EFT">EFT</option>
                                                            </select>
                                                            @*<input value="" type="number" id="PaidAmt" class="form-control" name="PaidAmt" placeholder="">*@
                                                        </div>
                                                        <div class="form-group col-lg-4 col-md-6 col-sm-12 col-xs-12">
                                                            <label id="TDS">TDS Amt.</label>
                                                            <select class="form-control" id="TDSAmtType" name="TDSAmtType" >
                                                                <option value="Select">Select</option>
                                                                <option value="%">%</option>
                                                                <option value="Rs">Rs</option>
                                                            </select>
                                                            <input  type="number" id="TDSAmtcaledit" class="form-control" name="TDSAmtcaledit" placeholder="%" style="display:none">
                                                            <input value="" type="number" id="TDSAmtedit" class="form-control" name="TDSAmtedit" placeholder="">
                                                        </div>
                                                        <div class="form-group col-lg-4 col-md-6 col-sm-12 col-xs-12">
                                                            <label id="TDSdec">TDS Other Deduction.</label>
                                                            <input value="" type="number" id="TDSOtherdecdit" class="form-control" name="TDSOtherdecdit" placeholder="">
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <!-- Save Button-->
                                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                            <button type="submit" id="EditSave" name="EditSave" value="Edit" class="btndivcss">
                                                                
                                                                <span class="buttoniconcss"></span>Update
                                                            </button>
                                                            <input type="hidden" id="Mode" name="Mode">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="modal" id="delModal" role="dialog">
                                        <div class="modal-dialog modal-lg">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h4 class="modal-title">Delete Action</h4>
                                                    <button type="button" class="close" id="delModalClose">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <div class="row">
                                                        <!-- Details -->
                                                        <div class="form-group col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                            <label>Password</label>
                                                            <input type="password" id="deletepassword" name="deletepassword" />
                                                        </div>
                                                        <div class="form-group col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                            <label>Reason</label>
                                                           <input type="text" id="ReasonToDelete" name="ReasonToDelete" />
                                                        </div>
                                                       
                                                    </div>
                                                
                                                    <div class="row">
                                                        <!-- Save Button-->
                                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                            <button type="button" id="DeleteSave" name="DeleteSave" value="okk"  placeholder="Enter Reason For Deleting Reciept"  class="btndivcss">

                                                                <span class="buttoniconcss"></span>Save
                                                            </button>
                                                            
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-12 col-sm-12 col-xs-12">
                                <div class="card card-primary panel-primary">
                                    <h2 class="panelheading">Amount Details</h2>
                                    <div class="card-body panel-body">
                                        <!--Pre Balance Amount-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12 padding0">
                                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                <label id="pre"><a href="#">Pre Bal. Amt.</a></label>
                                            </div>
                                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                <input type="number" id="PreBalanceAmount" name="PreBalanceAmount" readonly class="form-control">
                                            </div>
                                        </div>
                                        <!--All Paid and Paid Amount-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12 padding0">
                                            @*<div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                <span style="font-weight: 700;">Paid Amt.</span>
                                                <label id="btnpaid" class="form-check-label hide">
                                                    <input type="checkbox" class="checkbox" name="chkAllpaidAmt" id="chkAllpaidAmt">All
                                                </label>
                                            </div>*@
                                            <div id="SecDeposit" name="SecDeposit" class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                            
                                                <span style="font-weight: 700;">Paid Amt.</span>
                                                @*<label id="Sec">Security Deposit</label>*@
                                            </div>
                                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12 padding0">
                                                <input type="number" id="PaidAmount" name="PaidAmount" placeholder="0.00" class="form-control">
                                            </div>
                                            @*<div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                    <label id="pre">All Paid</label>
                                                </div>
                                                <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                    <input type="checkbox" class="checkbox" name="chkAllpaidAmt" id="chkAllpaidAmt">
                                                </div>*@
                                        </div>
                                        <!--Paid Amount-->
                                        @*<div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                    <label>Paid Amt.</label>
                                                </div>
                                                <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                    <input type="number" id="PaidAmount" name="PaidAmount" class="form-control">
                                                </div>
                                            </div>*@
                                        <!--Payment Type-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12 padding0">
                                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                <label>Payment Type</label>
                                            </div>
                                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                <select class="form-control" id="PaymentType" name="PaymentType">
                                                    <option value="Cash">Cash</option>
                                                    <option value="Cheque">Cheque</option>
                                                    <option value="Credit Card">Credit Card</option>
                                                    <option value="Debit Card">Debit Card</option>
                                                    <option value="E-Money">E-Money</option>
                                                    <option value="EFT">EFT</option>
                                                </select>
                                            </div>

                                            <!-- Modal -->
                                            <div class="modal" id="DoctorSaveDiv" role="dialog">
                                                <div class="modal-dialog modal-lg">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title" id="exampleModalLabel">Payment</h5>
                                                            <button type="button" class="sd close" id="ClosePaymentType" aria-label="Close">
                                                                <span aria-hidden="true">&times;</span>
                                                            </button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="text-align: center;margin-bottom: 10px;">
                                                                <div class="form-check-inline">
                                                                    <label class="form-check-label">
                                                                        <input type="radio" class="form-check-input" value="Cash" id="Cash" name="RadioCharge" checked>Cash
                                                                    </label>
                                                                </div>
                                                                <div class="form-check-inline">
                                                                    <label class="form-check-label">
                                                                        <input type="radio" class="form-check-input" value="Cheque" id="Cheque" name="RadioCharge" checked>Cheque
                                                                    </label>
                                                                </div>
                                                                <div class="form-check-inline">
                                                                    <label class="form-check-label">
                                                                        <input type="radio" class="form-check-input" value="Credit Card" id="Credit Card" name="RadioCharge" checked>Credit Card
                                                                    </label>
                                                                </div>
                                                                <div class="form-check-inline">
                                                                    <label class="form-check-label">
                                                                        <input type="radio" class="form-check-input" value="Debit Card" id="Debit Card" name="RadioCharge" checked>Debit Card
                                                                    </label>
                                                                </div>
                                                                <div class="form-check-inline">
                                                                    <label class="form-check-label">
                                                                        <input type="radio" class="form-check-input" value="E-Money" id="E-Money" name="RadioCharge" checked>E-Money
                                                                    </label>
                                                                </div>
                                                                <div class="form-check-inline">
                                                                    <label class="form-check-label">
                                                                        <input type="radio" class="form-check-input" value="EFT" id="EFT" name="RadioCharge" checked>EFT
                                                                    </label>
                                                                </div>
                                                                <button type="button" onclick="document.getElementById('DoctorSaveDiv').style = 'display:none'" id="close" class="as close" value="Close" data-dismiss="modal">×</button>
                                                            </div>

                                                            <div class="row">
                                                                <!--Payment Number-->
                                                                <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                                        <label id="PaymentNo1"></label>
                                                                    </div>
                                                                    <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                                        <span class="error" id="Doctorfill"></span>
                                                                        <input value="" type="number" id="Number" class="form-control" name="Number" placeholder="">
                                                                    </div>
                                                                </div>
                                                                <!--Payment Name-->
                                                                <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                                        <label id="paymentName1"></label>
                                                                    </div>
                                                                    <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                                        <span class="error" id=""></span>
                                                                        <input value="" type="text" id="Name" class="form-control" name="Name" placeholder="">
                                                                    </div>
                                                                </div>
                                                                <!--Payment Date-->
                                                                <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                                        <label id="paymentDate1"></label>
                                                                    </div>
                                                                    <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                                        <span class="error" id="paymentDate11"></span>
                                                                        <input type="date" id="paymentDate" name="paymentDate" value="@DateTime.Now.ToString("yyyy-MM-dd")" max="9999-12-31" class="form-control">
                                                                    </div>
                                                                </div>
                                                                <!--Payment Remarks-->
                                                                <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                                        <label class="remk" id="paymentRemark1">Remark</label>
                                                                    </div>
                                                                    <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                                        <input value="" type="text" id="Remarks" class="form-control" name="Remarks" placeholder="">
                                                                    </div>
                                                                </div>
                                                                <!--Paid Amount-->
                                                                <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                                        <label id="paymentamt">Paid Amt.</label>
                                                                    </div>
                                                                    <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                                        <input value="" type="number" id="PaidAmt" class="form-control" name="PaidAmt" placeholder="">
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <div class="row">
                                                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="text-align: center;">
                                                                    <div class="btn-group dropdown-split-warning">
                                                                        <a class="btn btn-app" id="btnadd">
                                                                            <i class="fa fa-plus"></i>Add
                                                                        </a>
                                                                    </div>
                                                                    @*<div class="btn-group dropdown-split-warning">
                                                                            <button type="submit" class="btn btn-app" onclick="Chequesave1">
                                                                                <i class="fa fa-save"></i>Save
                                                                            </button>
                                                                        </div>*@
                                                                </div>
                                                            </div>

                                                            <div class="row">
                                                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 table-responsive">
                                                                    <table id="paymentAdd" class="table table-bordered hover display table-hover" role="grid" style="display: none; width: 100%;">
                                                                        <thead style="background-color: #bddff7;">
                                                                            <tr>
                                                                                <th>Payment Type</th>
                                                                                <th>Card No.</th>
                                                                                <th>Bank Name</th>
                                                                                <th>Date</th>
                                                                                <th>Remark</th>
                                                                                <th>Paid Amount</th>
                                                                                <th>Action</th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody id="tablepaymentAdd"></tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="modal" id="PayMode" role="dialog">
                                                <div class="modal-dialog modal-lg">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title" id="ModalLabel">Payment</h5>
                                                            <button type="button" class="asr close" id="ClosePaymentMode" aria-label="Close">
                                                                <span aria-hidden="true">&times;</span>
                                                            </button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="text-align: center;margin-bottom: 10px;">
                                                                <div class="form-check-inline">
                                                                    <label class="form-check-label">
                                                                        <input type="radio" class="form-check-input" value="Cash" id="CashEdit" name="Radio" checked>Cash
                                                                    </label>
                                                                </div>
                                                                <div class="form-check-inline">
                                                                    <label class="form-check-label">
                                                                        <input type="radio" class="form-check-input" value="Cheque" id="ChequeEdit" name="Radio" checked>Cheque
                                                                    </label>
                                                                </div>
                                                                <div class="form-check-inline">
                                                                    <label class="form-check-label">
                                                                        <input type="radio" class="form-check-input" value="Credit Card" id="CreditCardEdit" name="Radio" checked>Credit Card
                                                                    </label>
                                                                </div>
                                                                <div class="form-check-inline">
                                                                    <label class="form-check-label">
                                                                        <input type="radio" class="form-check-input" value="Debit Card" id="DebitCardEdit" name="Radio" checked>Debit Card
                                                                    </label>
                                                                </div>
                                                                <div class="form-check-inline">
                                                                    <label class="form-check-label">
                                                                        <input type="radio" class="form-check-input" value="E-Money" id="E-MoneyEdit" name="Radio" checked>E-Money
                                                                    </label>
                                                                </div>
                                                                <div class="form-check-inline">
                                                                    <label class="form-check-label">
                                                                        <input type="radio" class="form-check-input" value="EFT" id="EFTEdit" name="Radio" checked>EFT
                                                                    </label>
                                                                </div>
                                                                <button type="button" onclick="document.getElementById('PayMode').style = 'display:none'" id="closeEdit" class="close" value="Close" data-dismiss="modal">×</button>
                                                            </div>

                                                            <div class="row">
                                                                <!--Payment Number-->
                                                                <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                                        <label id="Pay1"></label>
                                                                    </div>
                                                                    <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                                        <span class="error" id="Doctorfill"></span>
                                                                        <input value="" type="number" id="No" class="form-control" name="No" placeholder="">
                                                                    </div>
                                                                </div>
                                                                <!--Payment Name-->
                                                                <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                                        <label id="payName1"></label>
                                                                    </div>
                                                                    <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                                        <span class="error" id=""></span>
                                                                        <input value="" type="text" id="Namepay" class="form-control" name="Namepay" placeholder="">
                                                                    </div>
                                                                </div>
                                                                <!--Payment Date-->
                                                                <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                                        <label id="payDate11"></label>
                                                                    </div>
                                                                    <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                                        <span class="error" id=""></span>
                                                                        <input type="date" id="payDate" name="payDate" value="@DateTime.Now.ToString("yyyy-MM-dd")" max="9999-12-31" class="form-control">
                                                                    </div>
                                                                </div>
                                                                <!--Payment Remarks-->
                                                                <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                                        <label id="payRemark1">Remark</label>
                                                                    </div>
                                                                    <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                                        <input value="" type="text" id="payRemarks" class="form-control" name="payRemarks" placeholder="">
                                                                    </div>
                                                                </div>
                                                                <!--Paid Amount-->
                                                                <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                                        <label id="pay1">Paid Amt.</label>
                                                                    </div>
                                                                    <div class="col-lg-8 col-md-8 col-sm-12 col-xs-12">
                                                                        <input value="" type="number" id="PaidAmtpay" class="form-control" name="PaidAmtpay" placeholder="">
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <div class="row">
                                                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="text-align: center;">
                                                                    <div class="btn-group dropdown-split-warning">
                                                                        <a class="btn btn-app" id="btnEdit">
                                                                            <i class="fa fa-plus"></i>Add
                                                                        </a>
                                                                    </div>
                                                                 
                                                                </div>
                                                            </div>

                                                            <div class="row">
                                                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 table-responsive">
                                                                    <table id="payAdd" class="table table-bordered hover display table-hover" role="grid" style="display: none; width: 100%;">
                                                                        <thead style="background-color: #bddff7;">
                                                                            <tr>
                                                                                <th>Payment Type</th>
                                                                                <th>Card No.</th>
                                                                                <th>Bank Name</th>
                                                                                <th>Date</th>
                                                                                <th>Remark</th>
                                                                                <th>Paid Amount</th>
                                                                                <th>Action</th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody id="tablepayAdd"></tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                                                
                                                              
                                        </div>
                                        <!--Balance Amtount-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12 padding0">
                                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                <label>Balance Amt.</label>
                                            </div>
                                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                <input type="number" id="BalanceAmount" name="BalanceAmount" placeholder="0.00" class="form-control">
                                            </div>
                                        </div>
                                        <!--OPD/IPD-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12 padding0">
                                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                <label>OPD/IPD</label>
                                            </div>
                                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                <select class="form-control" id="OPDIPDNO" name="OPDIPDNO"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card card-primary panel-primary" id="TpaDetailsCheck">
                                    <h2 class="panelheading">TPA Details</h2>
                                    <div class="card-bodys panel-body">
                                        <!--TDS Amount-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                <label>TDS Amount</label>
                                            </div>
                                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                <select id="tdsamtsel" class="form-control">
                                                    <option value="Select">Select</option>
                                                    <option value="%">%</option>
                                                    <option value="Rs">Rs</option>
                                                </select>
                                                <input type="number" id="TdsAmCal" name="TdsAmCal" class="col-lg-6 form-control" placeholder="%" style="display:none">
                                                <input type="number" id="TdsAmount" name="TdsAmount" class="col-lg-6 form-control">
                                            </div>
                                        </div>
                                        <!--TPA/Other Deduction-->
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                <label>TPA/Other Deduction</label>
                                            </div>
                                            <div class="col-lg-6 col-md-12 col-sm-12 col-xs-12">
                                                <input type="number" id="TPAOtherDeduction" name="TPAOtherDeduction" class="form-control">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card card-primary panel-primary">
                                    <h2 class="panelheading">Narration</h2>
                                    <div class="card-body panel-body">
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <textarea name="Narrection" class="form-control"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="text-align: center;">
                                <div class="btn-group dropdown-split-warning">
                                    <button type="submit" class="btn btn-app" value="Add" id="save" name="save">
                                        <i class="fa fa-save"></i>Save
                                    </button>
                                </div>
                                @*<div class="btn-group dropdown-split-warning">
                                        <a class="btn btn-app">
                                            <i class="fa fa-trash"></i>Delete
                                        </a>
                                    </div>*@
                                <div class="btn-group dropdown-split-warning">
                                    <a class="btn btn-app" onclick="location.reload();">
                                        <i class="fa fa-refresh"></i>Clear
                                    </a>
                                </div>
                                <div class="btn-group dropdown-split-warning">
                                    <a class="btn btn-app" onclick="window.location.href='@Url.Action("Patient", "Application")'">
                                        <i class="fa fa-sign-out"></i>Exit
                                    </a>
                                </div>
                                @*<div class="btn-group dropdown-split-warning">
                                        <a class="btn btn-app" id="datatableAccountDetailExcelExport"></a>
                                    </div>*@
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            <input type="hidden" value="" name="txtinput" id="txtinput" />
            <input type="hidden" value="0" name="ForAuthorization" id="ForAuthorization" />
        </form>
    </div>
</body>





